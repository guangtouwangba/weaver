# PRD: 学习模式与Canvas结合设计

| Document Info | Details |
| --- | --- |
| **Version** | v1.0 |
| **Status** | Design Phase |
| **Scope** | Studio Assistant Panel + Canvas Integration |
| **Feature Type** | Enhancement to Learning Mode |

---

## 1. 结合的必要性分析

### 1.1 核心价值契合

**苏格拉底式对话的本质**：
- 通过提问引导思考
- 帮助用户自己发现答案
- 建立知识之间的联系
- **过程导向**：关注思考过程，而非结果

**Canvas的本质**：
- 可视化知识结构
- 通过空间和连接表达关系
- 帮助理解复杂概念
- **空间思维**：通过视觉组织知识

**契合点**：
- 两者都关注"理解"和"关系"
- 对话产生的是"思考过程"和"知识片段"
- Canvas可以记录和可视化这个过程
- 形成独特的"对话+可视化"学习体验

### 1.2 用户价值提升

**问题1：思考过程难以回顾**
- **现状**：苏格拉底式对话结束后，用户只能看到文本记录
- **痛点**：难以回顾思考路径，无法看到知识是如何被构建的
- **解决**：Canvas可视化思考过程，用户可以随时回顾

**问题2：知识片段难以重组**
- **现状**：对话中的知识片段散落在文本中
- **痛点**：无法重新组织，难以形成知识体系
- **解决**：Canvas上可以拖拽、连接、重组这些知识片段

**问题3：知识关系难以理解**
- **现状**：对话中建立的关系只存在于文本中
- **痛点**：复杂的关系难以理解
- **解决**：Canvas上直观展示关系，形成知识图谱

### 1.3 产品差异化优势

**当前产品定位**：知识可视化和操作

**结合后的优势**：
1. **独特的学习体验**：对话+可视化，让抽象思维可见
2. **过程可视化**：不仅看到答案，还看到思考过程
3. **知识构建**：用户参与知识构建，而非被动接受
4. **可追溯性**：思考路径可追溯，可回顾，可重组

---

## 2. 结合方式设计

### 2.1 核心设计理念

**"思考路径可视化"**：
- 将苏格拉底式对话的思考过程映射到Canvas
- 每个提问和回答成为节点
- 思考的逻辑关系成为连接
- 形成从问题到结论的"思考路径图"

**设计原则**：
1. **不打断对话流程**：可视化在后台进行，不干扰对话
2. **用户可控制**：用户可以选择是否自动创建节点
3. **有意义才可视化**：只有深度探索模式才需要可视化
4. **可编辑可重组**：节点可以修改、连接、重组

### 2.2 三种结合方式

#### 方式A：实时自动沉淀（推荐）

**工作流程**：
1. 用户在深度探索模式中提问
2. AI提问 → 自动在Canvas创建"提问节点"
3. 用户回答 → 自动在Canvas创建"回答节点"
4. 建立连接：提问节点 → 回答节点 → 下一个提问节点
5. 用户得出结论 → 创建"结论节点"，连接到整个思考路径

**视觉设计**：
```
Canvas上的思考路径图：
┌─────────┐
│ 问题    │  "什么是RAG？"
└────┬────┘
     │
     ▼
┌─────────┐
│ AI提问1 │  "你理解的'检索'是什么意思？"
└────┬────┘
     │
     ▼
┌─────────┐
│ 用户回答│  "检索就是从文档中找到相关内容..."
└────┬────┘
     │
     ▼
┌─────────┐
│ AI提问2 │  "如果AI直接回答，不检索，会有什么问题？"
└────┬────┘
     │
     ▼
┌─────────┐
│ 用户回答│  "可能会回答错误，或者没有依据..."
└────┬────┘
     │
     ▼
┌─────────┐
│ 结论    │  "RAG是检索增强生成..."
└─────────┘
```

**节点设计**：
- **提问节点**：蓝色边框，图标：🤔
- **回答节点**：绿色边框，图标：💭
- **结论节点**：金色边框，图标：✨
- **连接线**：带箭头，表示思考方向

**用户控制**：
- 设置中可以选择"自动创建思考节点"（默认开启）
- 可以随时关闭，只保留对话记录
- 可以手动删除不需要的节点

#### 方式B：对话结束后沉淀

**工作流程**：
1. 深度探索对话正常进行（不自动创建节点）
2. 对话结束后，显示"将思考过程添加到Canvas"按钮
3. 用户点击 → 系统分析对话，生成思考路径图
4. 自动创建节点和连接，布局在Canvas上

**视觉设计**：
```
对话结束后，Assistant Panel底部显示：
┌─────────────────────────────────────────┐
│ ✅ 对话完成                              │
│                                         │
│ 💡 将思考过程添加到Canvas？              │
│    这会创建一个思考路径图，帮助你回顾    │
│                                         │
│ [添加到Canvas] [稍后]                    │
└─────────────────────────────────────────┘
```

**生成逻辑**：
- 分析对话中的提问和回答
- 识别关键概念和关系
- 自动创建节点和连接
- 智能布局（避免重叠）

**优势**：
- 不打断对话流程
- 用户主动选择
- 可以批量处理多个对话

#### 方式C：混合模式（最灵活）

**工作流程**：
1. 默认：实时自动沉淀（方式A）
2. 用户可以随时暂停/恢复自动创建
3. 对话结束后，可以"优化思考路径图"（重新布局、合并节点等）

**用户控制界面**：
```
Assistant Panel顶部，深度探索模式时显示：
┌─────────────────────────────────────────┐
│ 🌱 深度探索                              │
│                                         │
│ 📊 Canvas同步: [自动 ▼]                  │
│    • 自动创建思考节点                    │
│    • 暂停自动创建                        │
│    • 仅对话结束后添加                    │
└─────────────────────────────────────────┘
```

---

## 3. 详细交互设计

### 3.1 实时自动沉淀（方式A）详细设计

#### 3.1.1 节点创建时机

**AI提问时**：
- 立即在Canvas上创建"提问节点"
- 节点位置：当前视口中心偏左
- 节点内容：AI的提问文本
- 节点样式：蓝色边框，🤔图标

**用户回答时**：
- 用户输入回答后，按Enter发送
- 立即在Canvas上创建"回答节点"
- 节点位置：提问节点右侧
- 节点内容：用户的回答文本
- 节点样式：绿色边框，💭图标
- 自动建立连接：提问节点 → 回答节点

**用户得出结论时**：
- AI检测到用户自己得出结论（如："所以RAG是..."）
- 创建"结论节点"
- 节点位置：思考路径的末端
- 节点样式：金色边框，✨图标
- 连接到整个思考路径

#### 3.1.2 视觉反馈

**Canvas上的实时更新**：
- 新节点创建时，有淡入动画
- 连接线创建时，有绘制动画
- 节点创建后，Canvas自动滚动到新节点位置（可选）

**Assistant Panel中的提示**：
- 节点创建时，显示小提示："思考节点已添加到Canvas"
- 可以点击提示，跳转到Canvas查看

#### 3.1.3 节点交互

**节点内容**：
- 可以点击节点，在Assistant Panel中显示完整对话上下文
- 可以编辑节点内容（修改文本）
- 可以删除节点（删除后，连接自动调整）

**节点连接**：
- 可以手动添加连接（连接不同思考路径）
- 可以删除连接
- 可以修改连接类型（如："导致"、"反驳"等）

**节点重组**：
- 可以拖拽节点，重新布局
- 可以框选多个节点，创建"思考组"
- 可以折叠/展开思考组

### 3.2 对话结束后沉淀（方式B）详细设计

#### 3.2.1 触发时机

**对话结束检测**：
- AI判断对话已完成（用户得出结论，或明确表示理解）
- 显示"添加到Canvas"按钮
- 用户可以选择立即添加，或稍后添加

#### 3.2.2 生成逻辑

**对话分析**：
1. 识别对话中的关键概念（实体识别）
2. 识别提问-回答对
3. 识别思考的逻辑关系
4. 识别最终结论

**节点生成**：
- 为每个关键概念创建节点
- 为每个提问-回答对创建节点
- 为结论创建节点

**连接生成**：
- 提问 → 回答
- 回答 → 下一个提问
- 所有节点 → 结论

**布局算法**：
- 使用树状布局（思考路径是树状结构）
- 根节点：原始问题
- 叶子节点：最终结论
- 中间节点：提问和回答

#### 3.2.3 用户确认

**预览模式**：
- 生成后，先显示预览
- 用户可以调整节点内容
- 用户可以删除不需要的节点
- 用户可以修改连接

**确认添加**：
- 点击"确认添加" → 节点添加到Canvas
- 点击"取消" → 不添加，但保留生成结果（可以稍后添加）

### 3.3 Canvas上的思考路径图

#### 3.3.1 视觉设计

**节点类型**：
- **问题节点**：灰色边框，❓图标
- **提问节点**：蓝色边框，🤔图标
- **回答节点**：绿色边框，💭图标
- **结论节点**：金色边框，✨图标

**连接线**：
- 实线：思考的逻辑关系
- 虚线：概念之间的关联
- 箭头：表示思考方向

**布局**：
- 默认：从左到右的树状布局
- 用户可以自由拖拽，重新布局
- 支持自动布局（"整理思考路径"）

#### 3.3.2 交互功能

**查看上下文**：
- 点击节点 → 在Assistant Panel中显示完整对话
- 可以继续对话（从该节点继续）

**编辑节点**：
- 双击节点 → 进入编辑模式
- 可以修改文本内容
- 可以添加标签、备注

**重组思考路径**：
- 拖拽节点，改变位置
- 删除节点（删除后，连接自动调整）
- 合并节点（将多个节点合并为一个）
- 拆分节点（将一个节点拆分为多个）

**导出思考路径**：
- 可以导出为图片
- 可以导出为思维导图格式
- 可以分享给他人

---

## 4. 用户心理曲线

### 4.1 首次使用实时沉淀

**阶段一：发现（0-30秒）**
- **心理状态**：好奇、探索
- **行为**：开始深度探索对话，发现Canvas上自动出现节点
- **情绪**：惊喜、好奇
- **设计要点**：清晰的视觉反馈，让用户知道发生了什么

**阶段二：理解（30秒-2分钟）**
- **心理状态**：理解、适应
- **行为**：观察节点如何创建，理解思考路径
- **情绪**：理解、适应
- **设计要点**：节点创建要有逻辑，让用户能理解

**阶段三：利用（2分钟+）**
- **心理状态**：主动利用
- **行为**：在Canvas上重组思考路径，形成知识图谱
- **情绪**：满足、成就感
- **设计要点**：提供丰富的编辑和重组功能

### 4.2 使用思考路径图

**心理曲线**：
```
好奇(看到路径图) → 理解(看懂结构) → 利用(重组知识) → 满足(形成知识体系)
```

**情绪变化**：
- 看到路径图：好奇（原来我的思考是这样的）
- 理解结构：理解（明白了思考的逻辑）
- 重组知识：主动（我可以这样组织）
- 形成体系：满足（我理解了）

---

## 5. 问题解决验证

### 5.1 问题1：思考过程难以回顾 → 解决

**解决方案**：Canvas可视化思考路径

**验证指标**：
- 用户会查看Canvas上的思考路径图
- 用户会从思考路径图中回顾对话
- 用户反馈"可以看到自己的思考过程"

### 5.2 问题2：知识片段难以重组 → 解决

**解决方案**：Canvas上可以拖拽、连接、重组节点

**验证指标**：
- 用户会在Canvas上重组思考节点
- 用户会创建新的连接
- 用户会形成自己的知识图谱

### 5.3 问题3：知识关系难以理解 → 解决

**解决方案**：Canvas上直观展示关系，形成知识图谱

**验证指标**：
- 用户会查看节点之间的连接
- 用户会理解知识之间的关系
- 用户会基于思考路径图继续学习

---

## 6. 实施优先级

### Phase 1（MVP）：对话结束后沉淀

**功能**：
- 深度探索对话结束后，显示"添加到Canvas"按钮
- 分析对话，生成思考路径图
- 用户确认后，添加到Canvas

**优势**：
- 实现简单，不打断对话流程
- 用户主动选择，体验可控
- 可以验证用户需求

### Phase 2（增强）：实时自动沉淀

**功能**：
- 在深度探索模式中，实时创建思考节点
- 自动建立连接
- 用户可以选择开启/关闭

**优势**：
- 更流畅的体验
- 实时可视化思考过程
- 增强沉浸感

### Phase 3（优化）：智能重组和优化

**功能**：
- 智能布局思考路径图
- 自动识别关键概念
- 提供"优化思考路径"功能

**优势**：
- 更智能的体验
- 帮助用户更好地组织知识
- 形成完整的知识体系

---

## 7. 设计原则

### 7.1 不打断对话流程

- 可视化在后台进行
- 不强制用户查看Canvas
- 提供关闭选项

### 7.2 用户可控制

- 用户可以选择是否自动创建节点
- 用户可以编辑、删除、重组节点
- 用户可以随时关闭功能

### 7.3 有意义才可视化

- 只有深度探索模式才需要可视化
- 快速回答模式不需要可视化
- 引导思考模式可以选择性可视化

### 7.4 可编辑可重组

- 节点可以修改内容
- 节点可以拖拽、连接
- 可以形成自己的知识图谱

---

## 8. 成功指标

### 8.1 使用指标

- **思考路径图创建率**：深度探索对话中，创建思考路径图的比例
- **节点编辑率**：用户编辑思考节点的比例
- **路径重组率**：用户重组思考路径的比例

### 8.2 体验指标

- **用户满意度**：用户对思考路径可视化的满意度
- **理解提升**：用户反馈"理解更深刻"的比例
- **知识构建**：用户基于思考路径图继续学习的比例

### 8.3 学习效果指标

- **知识记忆**：使用思考路径图后，知识记忆的持久性
- **知识应用**：用户能否将思考路径图应用到新场景
- **知识体系**：用户能否基于思考路径图形成知识体系

---

## 附录：用户场景示例

### 场景一：实时可视化思考过程

**用户**：学生，学习"机器学习中的过拟合"
**问题**："如何理解过拟合？"
**选择模式**：Level 3 (深度探索)
**体验**：
1. AI提问："你理解的'拟合'是什么意思？"
   → Canvas上自动创建提问节点
2. 用户回答："拟合就是模型学习数据..."
   → Canvas上自动创建回答节点，建立连接
3. AI继续提问："如果模型过度学习训练数据，会怎样？"
   → Canvas上继续创建节点
4. 用户得出结论："过拟合就是模型在训练数据上表现好，但在新数据上表现差"
   → Canvas上创建结论节点
5. 用户在Canvas上查看思考路径，理解整个思考过程

### 场景二：对话结束后沉淀

**用户**：研究员，研究"RAG系统设计"
**问题**："如何设计一个高效的RAG系统？"
**选择模式**：Level 3 (深度探索)
**体验**：
1. 完成深度探索对话，理解了RAG系统的设计要点
2. 对话结束，显示"将思考过程添加到Canvas"
3. 用户点击，系统生成思考路径图
4. 用户在Canvas上查看、编辑、重组思考路径
5. 形成完整的RAG系统设计知识图谱

### 场景三：基于思考路径继续学习

**用户**：产品经理，学习"用户体验设计"
**问题**："如何理解用户体验设计？"
**选择模式**：Level 3 (深度探索)
**体验**：
1. 完成对话，创建思考路径图
2. 在Canvas上查看思考路径，发现还有未理解的概念
3. 点击某个节点，在Assistant Panel中继续对话
4. 继续探索，思考路径图自动扩展
5. 最终形成完整的用户体验设计知识体系
