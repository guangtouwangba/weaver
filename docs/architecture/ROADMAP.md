# Generic RAG ç³»ç»Ÿå®æ–½è·¯çº¿å›¾

## ğŸ†• 2025-11-18 æ›´æ–°æ‘˜è¦

æœ¬æ¬¡æ›´æ–°æ ¹æ®å®é™…ä»£ç å®ç°æƒ…å†µï¼Œå…¨é¢ä¿®è®¢äº†å„Phaseçš„å®Œæˆåº¦è¯„ä¼°ï¼š

**æ ¸å¿ƒäº®ç‚¹** âœ…:
- **Phase 1 (90%)**: é…ç½®ç³»ç»Ÿã€LLM/Embeddingsé›†æˆã€æ¥å£æŠ½è±¡ - åŸºç¡€æ‰å®
- **Phase 3 (70%)**: æŸ¥è¯¢æ„å›¾åˆ†ç±»ã€æ™ºèƒ½è·¯ç”± - åŠŸèƒ½å®Œæ•´
- **Phase 5 (80%)**: å¯¹è¯è®°å¿†ç³»ç»Ÿï¼ˆåˆ†å±‚+è¯­ä¹‰æ£€ç´¢ï¼‰- è¡¨ç°ä¼˜ç§€
- **Phase 6 (55%)**: RAGASè¯„ä¼°ç³»ç»Ÿå’Œè¿è¡Œæ—¶è¯„ä¼° - æ–°å¢å®Œæˆ âœ¨

**éœ€è¦è¡¥å……** âš ï¸:
- **Phase 2 (40%)**: ç¼ºå°‘æ··åˆæ£€ç´¢ï¼ˆBM25+Vectorï¼‰å’Œé‡æ’åº
- **Phase 4 (50%)**: Promptç®¡ç†å¾…å®Œå–„ï¼Œç¼ºå°‘è‡ªæˆ‘çº æ­£
- **Phase 6**: ç¼ºå°‘LangSmithè¿½è¸ªå’ŒPrometheusç›‘æ§

**æ€»ä½“è¿›åº¦**: çº¦65%å®Œæˆï¼Œæ ¸å¿ƒRAGã€å¯¹è¯å¼RAGå’Œè¯„ä¼°ç³»ç»Ÿå·²å¯ç”¨ï¼Œç”Ÿäº§çº§ç›‘æ§ç‰¹æ€§éœ€è¡¥å……ã€‚

**æœ€æ–°å®Œæˆ** ğŸ‰:
- âœ… RAGAS è¯„ä¼°æ¡†æ¶é›†æˆï¼ˆfaithfulness, answer_relevancy, context_precisionç­‰ï¼‰
- âœ… è¿è¡Œæ—¶è¯„ä¼°ç³»ç»Ÿï¼ˆsampling/async_all/batchä¸‰ç§æ¨¡å¼ï¼‰
- âœ… è¯„ä¼°æ•°æ®é›†ç®¡ç†å’Œç»“æœæŒä¹…åŒ–
- âœ… LLMå“åº”æ¸…ç†ï¼ˆè§£å†³Claudeè¿”å›markdownæ ¼å¼JSONçš„å…¼å®¹æ€§é—®é¢˜ï¼‰
- âœ… è¯„ä¼°APIæ¥å£ï¼ˆç»Ÿè®¡å’Œç»“æœæŸ¥è¯¢ï¼‰

---

## ğŸ§  AI KnowledgeOS åŠŸèƒ½æ‹†è§£ï¼ˆæ¥è‡ª PRD_01.mdï¼‰

| æ¨¡å— | æ ¸å¿ƒç›®æ ‡ | å…³é”®èƒ½åŠ› | å½“å‰çŠ¶æ€ | ä¸‹ä¸€æ­¥ |
|------|----------|----------|----------|--------|
| **Capture Hub**ï¼ˆçŸ¥è¯†é‡‡é›†ï¼‰ | ä½æ‘©æ“¦æ”¶é›†å¤šæºçŸ¥è¯† | æ–‡æ¡£/å¯¹è¯/æµè§ˆå™¨/é‚®ä»¶æ¥å…¥ã€è‡ªåŠ¨è§£æã€è´¨é‡è¯„ä¼° | ä»…åŸºç¡€æ–‡æ¡£+å¯¹è¯è¾“å…¥ | 1) æ¥å…¥å¤šæº Connector 2) å†…å®¹åˆ†ç±»/æ‰“æ ‡ç­¾ 3) é‡‡é›†ä»»åŠ¡é¢æ¿ |
| **Insight Forge**ï¼ˆçŸ¥è¯†å†…åŒ–ï¼‰ | æŠŠä¿¡æ¯è½¬æˆå¯æ¶ˆè´¹çš„çŸ¥è¯†èµ„äº§ | æ‘˜è¦ã€çŸ¥è¯†å¡ç‰‡ã€è§‚ç‚¹å¯¹æ¯”ã€ä¸ªæ€§åŒ–ç‰ˆæœ¬ | æš‚ç¼ºï¼ˆä»…æœ‰ QA promptï¼‰ | 1) AI çŸ¥è¯†å¡ç‰‡ 2) å¤šè§†è§’æ‘˜è¦ 3) ä¸ªäºº/å›¢é˜Ÿè¯­å¢ƒå®šåˆ¶ |
| **Action Engine**ï¼ˆçŸ¥è¯†æå–ï¼‰ | åœ¨ä»»åŠ¡åœºæ™¯é«˜æ•ˆè°ƒç”¨çŸ¥è¯† | åœºæ™¯åŒ– RAGã€Playbookã€ä»»åŠ¡æ¨¡æ¿ã€å¼•ç”¨é“¾è·¯ | åŸºç¡€ QA/å¯¹è¯å¯ç”¨ï¼ŒRAG è¯„ä¼°å®Œæˆ | 1) åœºæ™¯åŒ–æ£€ç´¢ç­–ç•¥ 2) å·¥ä½œæµæ¨¡æ¿ 3) å›ç­”å¼•ç”¨è¿½è¸ª |
| **Graph Studio**ï¼ˆçŸ¥è¯†é“¾æ¥ï¼‰ | æ„å»ºåŠ¨æ€çŸ¥è¯†ç½‘ç»œä¸æ´å¯Ÿ | è‡ªåŠ¨å›¾è°±ã€äº¤äº’æ¢ç´¢ã€ç›²ç‚¹æç¤ºã€å­¦ä¹ è·¯å¾„ | è§„åˆ’é˜¶æ®µï¼ˆPRD v1.1ï¼‰ | 1) MVP åŠ¨æ€å›¾è°± 2) AI æ¢ç´¢å»ºè®® 3) å¯¼å‡º/åˆ†äº«èƒ½åŠ› |

> åç»­è¿­ä»£éœ€å›´ç»•ä»¥ä¸Šå››å¤§æ¨¡å—æ¨è¿›ï¼Œæ¯ä¸ªæ¨¡å—å‡åŒ…å«â€œè‡ªåŠ¨åŒ– + äººæœºåä½œâ€é—­ç¯ã€‚

---

## ğŸ“‹ ç›®å½•

- [2025-11-16 æ›´æ–°æ‘˜è¦](#-2025-11-16-æ›´æ–°æ‘˜è¦)
- [å½“å‰çŠ¶æ€è¯„ä¼°](#å½“å‰çŠ¶æ€è¯„ä¼°)
- [å®æ–½è·¯çº¿å›¾æ€»è§ˆ](#å®æ–½è·¯çº¿å›¾æ€»è§ˆ)
- [è¯¦ç»†å®æ–½è®¡åˆ’](#è¯¦ç»†å®æ–½è®¡åˆ’)
  - [Phase 1: æ ¸å¿ƒåŸºç¡€è®¾æ–½](#phase-1-æ ¸å¿ƒåŸºç¡€è®¾æ–½-week-1-2)
  - [Phase 2: å¢å¼ºæ£€ç´¢èƒ½åŠ›](#phase-2-å¢å¼ºæ£€ç´¢èƒ½åŠ›-week-3-4)
  - [Phase 3: æŸ¥è¯¢ç†è§£ä¸è·¯ç”±](#phase-3-æŸ¥è¯¢ç†è§£ä¸è·¯ç”±-week-5)
  - [Phase 4: ç”Ÿæˆå¢å¼ºä¸éªŒè¯](#phase-4-ç”Ÿæˆå¢å¼ºä¸éªŒè¯-week-6)
  - [Phase 5: å¯¹è¯ä¸è®°å¿†](#phase-5-å¯¹è¯ä¸è®°å¿†-week-7)
  - [Phase 6: å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ–](#phase-6-å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ–-week-8-9)
  - [Phase 7: é«˜çº§ç‰¹æ€§](#phase-7-å¯é€‰-é«˜çº§ç‰¹æ€§-week-10)
- [æœ€å°å¯è¡Œäº§å“ (MVP) è·¯å¾„](#æœ€å°å¯è¡Œäº§å“-mvp-è·¯å¾„)
- [å®æ–½å»ºè®®](#å®æ–½å»ºè®®)
- [å…³é”®æˆåŠŸæŒ‡æ ‡](#å…³é”®æˆåŠŸæŒ‡æ ‡-kpi)
- [ä¸‹ä¸€æ­¥è¡ŒåŠ¨](#ä¸‹ä¸€æ­¥è¡ŒåŠ¨)

---

## ğŸ“Š å½“å‰çŠ¶æ€è¯„ä¼°

> **æœ€åæ›´æ–°**: 2025-11-16  
> **ç‰ˆæœ¬**: 0.2.0

### âœ… å·²å®ŒæˆåŠŸèƒ½

#### æ ¸å¿ƒåŸºç¡€è®¾æ–½ (Phase 1) - 90% å®Œæˆ
- âœ… **é…ç½®ç³»ç»Ÿ**: å®Œæ•´çš„ Pydantic Settingsï¼Œæ”¯æŒæ¨¡å—åŒ–é…ç½®ï¼ˆLLMConfig, EmbeddingConfigç­‰ï¼‰
- âœ… **çœŸå® LLM é›†æˆ**: æ”¯æŒ OpenRouter å’Œ OpenAIï¼Œå¸¦é‡è¯•å’Œé”™è¯¯å¤„ç†
- âœ… **çœŸå® Embeddings**: OpenAI å’Œ OpenRouter embeddings æ”¯æŒ
- âœ… **æ¥å£æŠ½è±¡**: å®Œæ•´çš„ `RetrieverInterface`, `GeneratorInterface`, `RerankerInterface`, `MemoryInterface`
- âœ… **å·¥å‚æ¨¡å¼**: RetrieverFactory å®ç°

#### æ£€ç´¢èƒ½åŠ› (Phase 2) - 40% å®Œæˆ
- âœ… **VectorRetriever**: åŸºäº FAISS çš„å‘é‡æ£€ç´¢ï¼Œæ”¯æŒ similarity å’Œ MMR æœç´¢
- âœ… **RetrieverFactory**: å¯é…ç½®çš„æ£€ç´¢å™¨å·¥å‚
- âš ï¸ **HybridRetriever** (BM25+Vector): æœªå®ç°
- âš ï¸ **Cross-Encoder Reranker**: æœªå®ç°
- âš ï¸ **MultiQueryRetriever**: æœªå®ç°

#### æŸ¥è¯¢ç†è§£ä¸è·¯ç”± (Phase 3) - 70% å®Œæˆ
- âœ… **æŸ¥è¯¢æ„å›¾åˆ†ç±»**: åŸºäºè§„åˆ™çš„ `QueryIntentClassifier`ï¼ˆMETA/DOCUMENT/HYBRID/GENERALï¼‰
- âœ… **QueryRouter**: æ™ºèƒ½è·¯ç”±å†³ç­–ï¼Œæ ¹æ®æ„å›¾é€‰æ‹©æ£€ç´¢ç­–ç•¥
- âœ… **æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ–**: ç»“åˆå¯¹è¯å†å²é‡å†™æŸ¥è¯¢
- âœ… **è¯­è¨€æ£€æµ‹**: ä½¿ç”¨ langextract
- âš ï¸ **è¯­ä¹‰è·¯ç”±**: semantic-router åº“é›†æˆï¼ˆéƒ¨åˆ†å®Œæˆï¼‰
- âš ï¸ **Multi-Query ç”Ÿæˆ**: æœªå®ç°

#### ç”Ÿæˆå¢å¼º (Phase 4) - 50% å®Œæˆ
- âœ… **QA Chain**: åŸºäº LangChain çš„é—®ç­”é“¾
- âœ… **æµå¼è¾“å‡º**: SSE æµå¼å“åº”æ”¯æŒ
- âœ… **åŸºç¡€ Prompt**: QA prompts å®ç°
- âš ï¸ **Prompt ç®¡ç†ç³»ç»Ÿ**: æœªå®Œå–„
- âš ï¸ **è‡ªæˆ‘çº æ­£æœºåˆ¶**: æœªå®ç°
- âš ï¸ **å¹»è§‰æ£€æµ‹**: æœªå®ç°

#### å¯¹è¯ä¸è®°å¿† (Phase 5) - 80% å®Œæˆ
- âœ… **å¯¹è¯è®°å¿†ç³»ç»Ÿ**: çŸ­æœŸè®°å¿†ï¼ˆBufferï¼‰+ é•¿æœŸè®°å¿†ï¼ˆSemantic Searchï¼‰
- âœ… **åµŒå…¥å¼è®°å¿†æ£€ç´¢**: åŸºäº pgvector çš„ç›¸ä¼¼æ¶ˆæ¯æ£€ç´¢
- âœ… **Conversation ç®¡ç†**: å®Œæ•´çš„ ConversationService å’Œ MessageService
- âœ… **æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ–**: è‡ªåŠ¨é‡å†™å«ä»£è¯çš„æŸ¥è¯¢
- âœ… **åˆ†å±‚è®°å¿†**: ä¼šè¯å†…è®°å¿† + ä¸»é¢˜çº§è®°å¿†
- âš ï¸ **Redis ç¼“å­˜**: æœªå®ç°
- âš ï¸ **Summary Memory**: æœªå®ç°

#### å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ– (Phase 6) - 55% å®Œæˆ
- âœ… **åŸºç¡€æ—¥å¿—**: Python logging
- âœ… **Docker åŒ–**: docker-compose.yml é…ç½®
- âœ… **æ•°æ®åº“è¿ç§»**: Alembic è¿ç§»ç³»ç»Ÿ
- âœ… **PostgreSQL + pgvector**: ç”Ÿäº§çº§å‘é‡å­˜å‚¨
- âœ… **RAGAS è¯„ä¼°æ¡†æ¶**: RAGASEvaluator å·²å®ç°ï¼Œæ”¯æŒå¤šç§æŒ‡æ ‡
- âœ… **è¿è¡Œæ—¶è¯„ä¼°ç³»ç»Ÿ**: RuntimeEvaluator å·²å®ç°ï¼ˆé‡‡æ ·/å¼‚æ­¥/æ‰¹é‡ä¸‰ç§æ¨¡å¼ï¼‰
- âœ… **è¯„ä¼°æ•°æ®ç®¡ç†**: EvaluationDataset å’Œè¯„ä¼°ç»“æœå­˜å‚¨
- âœ… **LLM å“åº”æ¸…ç†**: è‡ªåŠ¨å¤„ç† markdown æ ¼å¼ JSONï¼ˆClaude å…¼å®¹æ€§ï¼‰
- âš ï¸ **LangSmith é›†æˆ**: æœªå®ç°
- âš ï¸ **ç»“æ„åŒ–æ—¥å¿—** (structlog): æœªå®ç°
- âš ï¸ **Prometheus æŒ‡æ ‡**: æœªå®ç°

#### å…¶ä»–æ ¸å¿ƒåŠŸèƒ½
- âœ… **LangGraph å·¥ä½œæµ**: IngestGraph å’Œ QA Graph
- âœ… **æ–‡æ¡£å¤„ç†**: PDF, DOCX è§£æï¼Œlangextract å¤šè¯­è¨€æ”¯æŒ
- âœ… **Topic ç®¡ç†**: å®Œæ•´çš„ä¸»é¢˜å’Œå†…å®¹ç®¡ç†ç³»ç»Ÿ
- âœ… **API å±‚**: FastAPI è·¯ç”±ï¼ˆtopics, contents, conversations, messages, qa, searchï¼‰
- âœ… **æ•°æ®æ¨¡å‹**: SQLAlchemy + Pydantic schemas
- âœ… **å‘é‡å­˜å‚¨**: FAISS (æœ¬åœ°) + pgvector (ç”Ÿäº§)

### ğŸ¯ æ€»ä½“å®Œæˆåº¦: çº¦ 65%

**æ ¸å¿ƒ RAG åŠŸèƒ½**: âœ… å·²å¯ç”¨  
**å¯¹è¯å¼ RAG**: âœ… å·²å¯ç”¨  
**è¯„ä¼°ç³»ç»Ÿ**: âœ… å·²å¯ç”¨  
**ç”Ÿäº§å°±ç»ª**: âš ï¸ éœ€è¦æ”¹è¿›

### âŒ å¾…å®ç°åŠŸèƒ½ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰

#### ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆAlignment with PRDï¼‰
1. **Capture Hub MVP**: å¤šæºé‡‡é›†ï¼ˆæ–‡æ¡£/ç½‘é¡µ/å¯¹è¯/æµè§ˆå™¨æ‰©å±•ï¼‰ã€å†…å®¹åˆ†ç±»ã€è´¨é‡è¯„åˆ†
2. **Insight Forge åŸºç¡€èƒ½åŠ›**: AI çŸ¥è¯†å¡ç‰‡ã€æ‘˜è¦/è§‚ç‚¹å¯¹æ¯”ã€ä¸ªäººåŒ–ç‰ˆæœ¬
3. **Action Engine æ£€ç´¢å‡çº§**: æ··åˆæ£€ç´¢ + Cross-Encoder é‡æ’åº + å¤šæŸ¥è¯¢ç­–ç•¥ï¼Œè¾“å‡ºå¼•ç”¨é“¾è·¯
4. **Observability Backbone**: LangSmith è¿½è¸ª + Prometheus æŒ‡æ ‡ + ç»“æ„åŒ–æ—¥å¿—
5. **Graph Studio MVP**: åŠ¨æ€çŸ¥è¯†å›¾è°±ã€äº¤äº’æ¢ç´¢ã€ç›²ç‚¹æç¤ºã€å¯¼å‡ºåˆ†äº«

#### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§
6. **Capture Hub æ‰©å±•**: é‚®ä»¶/ä¼šè®®çºªè¦ connectorã€è‡ªåŠ¨ä»»åŠ¡é¢æ¿
7. **Insight Forge æ·±åº¦å†…åŒ–**: å­¦ä¹ è·¯å¾„ã€è§‚ç‚¹å†²çªæ£€æµ‹ã€è‡ªæˆ‘çº åæç¤º
8. **Action Engine æ¨¡æ¿åŒ–**: åœºæ™¯åŒ– Playbookã€å·¥ä½œæµè§¦å‘ã€å›ç­”å¼•ç”¨å¯è¿½è¸ª
9. **Graph Studio Plus**: è·¨ä¸»é¢˜å…³è”ã€AI å¯¼èˆªã€æ—¶é—´è½´å›æ”¾
10. **è¯„ä¼°æŠ¥å‘Šç”Ÿæˆ**: åŸºäº runtime evaluation çš„å‘¨/æœˆæŠ¥ & è´¨é‡è¶‹åŠ¿

#### ğŸŸ¢ ä½ä¼˜å…ˆçº§
11. **Agentic RAG / Toolformer**: å¤æ‚ä»»åŠ¡è§„åˆ’ä¸å·¥å…·è°ƒç”¨
12. **çŸ¥è¯†å›¾è°±å¤šæ¨¡æ€å¢å¼º**: å›¾ç‰‡/éŸ³é¢‘èŠ‚ç‚¹
13. **è‡ªåŠ¨åŒ–çŸ¥è¯†è¿è¥**: æ™ºèƒ½æé†’ã€çŸ¥è¯†ç¼ºå£è‡ªåŠ¨ä»»åŠ¡åŒ–
---

## ğŸ¯ å®æ–½è·¯çº¿å›¾æ€»è§ˆ

```mermaid
gantt
    title Generic RAG ç³»ç»Ÿå®æ–½æ—¶é—´çº¿
    dateFormat YYYY-MM-DD
    section Phase 1: æ ¸å¿ƒåŸºç¡€è®¾æ–½
    é…ç½®ç³»ç»Ÿé‡æ„           :p1_1, 2025-01-01, 3d
    é›†æˆçœŸå®LLM            :p1_2, after p1_1, 3d
    æ¥å£æŠ½è±¡              :p1_3, after p1_2, 2d
    
    section Phase 2: å¢å¼ºæ£€ç´¢
    å¤šç§æ£€ç´¢ç­–ç•¥           :p2_1, after p1_3, 4d
    æ–‡æ¡£åå¤„ç†            :p2_2, after p2_1, 2d
    é‡æ’åºå®ç°            :p2_3, after p2_2, 3d
    
    section Phase 3: æŸ¥è¯¢ç†è§£
    æŸ¥è¯¢é¢„å¤„ç†            :p3_1, after p2_3, 2d
    æŸ¥è¯¢è½¬æ¢              :p3_2, after p3_1, 3d
    æ™ºèƒ½è·¯ç”±              :p3_3, after p3_2, 2d
    
    section Phase 4: ç”Ÿæˆå¢å¼º
    Promptå·¥ç¨‹            :p4_1, after p3_3, 2d
    æµå¼è¾“å‡º              :p4_2, after p4_1, 2d
    è‡ªæˆ‘çº æ­£              :p4_3, after p4_2, 3d
    
    section Phase 5: å¯¹è¯è®°å¿†
    å¯¹è¯è®°å¿†å®ç°           :p5_1, after p4_3, 3d
    Conversational RAG    :p5_2, after p5_1, 2d
    ç¼“å­˜ç³»ç»Ÿ              :p5_3, after p5_2, 2d
    
    section Phase 6: ç”Ÿäº§åŒ–
    LangSmithé›†æˆ         :p6_1, after p5_3, 2d
    ç»“æ„åŒ–æ—¥å¿—            :p6_2, after p6_1, 1d
    æŒ‡æ ‡æ”¶é›†              :p6_3, after p6_2, 2d
    è¯„ä¼°ç³»ç»Ÿ              :p6_4, after p6_3, 3d
    ç”Ÿäº§ç¯å¢ƒé…ç½®           :p6_5, after p6_4, 3d
```

### æ¨¡å—åŒ–é‡Œç¨‹ç¢‘ï¼ˆä¸ PRD_01 å¯¹é½ï¼‰

| é‡Œç¨‹ç¢‘ | æ¨¡å— | æ—¶é—´ç›’ | ä¸»è¦äº¤ä»˜ç‰© |
|--------|------|--------|------------|
| M1 | Capture Hub MVP | 2 å‘¨ | å¤šæºé‡‡é›† connectorã€è‡ªåŠ¨è§£æ/æ‰“æ ‡ç­¾ã€è´¨é‡é¢æ¿ |
| M2 | Insight Forge Alpha | 2 å‘¨ | AI çŸ¥è¯†å¡ç‰‡ã€æ‘˜è¦/è§‚ç‚¹å¯¹æ¯”ã€ä¸ªäººåŒ–ç‰ˆæœ¬ |
| M3 | Action Engine Upgrade | 2 å‘¨ | æ··åˆæ£€ç´¢ã€Cross-Encoder é‡æ’ã€å¼•ç”¨é“¾è·¯è¾“å‡º |
| M4 | Graph Studio MVP | 3 å‘¨ | åŠ¨æ€å›¾è°±ã€äº¤äº’æ¢ç´¢ã€ç›²ç‚¹/è·¯å¾„æç¤ºã€å¯¼å‡ºåˆ†äº« |
| M5 | Observability Backbone | 1.5 å‘¨ | LangSmith tracingã€Prometheus æŒ‡æ ‡ã€ç»“æ„åŒ–æ—¥å¿— |

> M1-M3 å¯å¹¶è¡Œéƒ¨åˆ†å·¥ç¨‹ï¼Œä½†å¿…é¡»å…±ç”¨ç»Ÿä¸€çš„æ•°æ®æ¨¡å‹å’Œè¯„ä¼°é—­ç¯ã€‚

### æ—¶é—´çº¿æ¦‚è§ˆ

| Phase | åç§° | å‘¨æœŸ | ä¼˜å…ˆçº§ | çŠ¶æ€ | å®Œæˆåº¦ |
|-------|------|------|--------|------|--------|
| **Phase 1** | æ ¸å¿ƒåŸºç¡€è®¾æ–½ | Week 1-2 | â­â­â­â­â­ | ğŸŸ¢ **å·²å®Œæˆ** | **90%** |
| **Phase 2** | å¢å¼ºæ£€ç´¢èƒ½åŠ› | Week 3-4 | â­â­â­â­â­ | ğŸŸ¡ **è¿›è¡Œä¸­** | **40%** |
| **Phase 3** | æŸ¥è¯¢ç†è§£ä¸è·¯ç”± | Week 5 | â­â­â­â­ | ğŸŸ¢ **åŸºæœ¬å®Œæˆ** | **70%** |
| **Phase 4** | ç”Ÿæˆå¢å¼ºä¸éªŒè¯ | Week 6 | â­â­â­â­ | ğŸŸ¡ **è¿›è¡Œä¸­** | **50%** |
| **Phase 5** | å¯¹è¯ä¸è®°å¿† | Week 7 | â­â­â­â­ | ğŸŸ¢ **åŸºæœ¬å®Œæˆ** | **80%** |
| **Phase 6** | å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ– | Week 8-9 | â­â­â­â­â­ | ğŸŸ¡ **è¿›è¡Œä¸­** | **30%** |
| **Phase 7** | é«˜çº§ç‰¹æ€§ (å¯é€‰) | Week 10+ | â­â­ | ğŸ”´ **æœªå¼€å§‹** | **0%** |

**å½“å‰çŠ¶æ€**: 
- âœ… **æ ¸å¿ƒåŠŸèƒ½å·²å¯ç”¨**: åŸºç¡€ RAG + å¯¹è¯å¼ RAG
- ğŸš§ **æ­£åœ¨å®Œå–„**: æ£€ç´¢å¢å¼ºã€å¯è§‚æµ‹æ€§
- ğŸ“… **é¢„è®¡è¾¾åˆ°ç”Ÿäº§çº§**: éœ€è¡¥å…… Phase 2 å’Œ Phase 6 çš„å‰©ä½™åŠŸèƒ½ï¼ˆçº¦ 2-3 å‘¨ï¼‰

---

## è¯¦ç»†å®æ–½è®¡åˆ’

## Phase 1: æ ¸å¿ƒåŸºç¡€è®¾æ–½ (Week 1-2) âœ… 90% å®Œæˆ

**ğŸ¯ ç›®æ ‡**: å»ºç«‹åšå®çš„åŸºç¡€æ¶æ„ï¼Œæ”¯æŒåç»­æ‰©å±•

**â±ï¸ é¢„è®¡æ—¶é—´**: 2 å‘¨ (8-10 å·¥ä½œæ—¥)  
**ğŸ“Š å®é™…çŠ¶æ€**: âœ… åŸºæœ¬å®Œæˆ

### 1.1 é‡æ„é…ç½®ç³»ç»Ÿ âœ… å·²å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­â­â­ (å¿…é¡»)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **åˆ›å»ºåˆ†å±‚é…ç½®ç»“æ„**
  ```
  å·²å®ç°: shared_config/settings.py
  â”œâ”€â”€ LLMConfig - LLMé…ç½®
  â”œâ”€â”€ EmbeddingConfig - Embeddingé…ç½®
  â”œâ”€â”€ MemoryConfig - å¯¹è¯è®°å¿†é…ç½®
  â”œâ”€â”€ RetrieverConfig - æ£€ç´¢å™¨é…ç½®
  â”œâ”€â”€ DatabaseConfig - æ•°æ®åº“é…ç½®
  â”œâ”€â”€ DocumentParserConfig - æ–‡æ¡£è§£æé…ç½®
  â””â”€â”€ AppSettings - èšåˆé…ç½®
  ```

- [x] **ä½¿ç”¨ Pydantic Settings ç®¡ç†é…ç½®**
  - âœ… åˆ›å»º `BaseSettings` ç»§æ‰¿
  - âœ… æ”¯æŒ `.env` æ–‡ä»¶åŠ è½½
  - âœ… æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
  - âœ… æ·»åŠ é…ç½®éªŒè¯å’Œé»˜è®¤å€¼ï¼ˆField validatorsï¼‰
  - âœ… æ”¯æŒ SecretStr ä¿æŠ¤æ•æ„Ÿä¿¡æ¯

- [x] **åˆ›å»ºé…ç½®å·¥å‚**
  - âœ… AppSettings èšåˆæ‰€æœ‰å­é…ç½®
  - âœ… æ”¯æŒå‘åå…¼å®¹çš„å±æ€§è®¿é—®
  - âš ï¸ å¤šç¯å¢ƒé…ç½®åˆ‡æ¢ï¼ˆå¯é€šè¿‡ APP_ENV å®ç°ï¼Œå¾…å®Œå–„ï¼‰

- [x] **æ·»åŠ é…ç½®æ–‡æ¡£**
  - âœ… é…ç½®ç±»å†…è”æ–‡æ¡£
  - âœ… ç¤ºä¾‹ `.env.example` æ–‡ä»¶
  - âš ï¸ ç‹¬ç«‹é…ç½®æ–‡æ¡£å¾…è¡¥å……

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶åˆ‡æ¢ä¸åŒçš„æ£€ç´¢ç­–ç•¥
- âœ… ç¯å¢ƒå˜é‡å¯ä»¥è¦†ç›–é»˜è®¤é…ç½®
- âœ… é…ç½®é”™è¯¯æœ‰æ¸…æ™°çš„é”™è¯¯æç¤ºï¼ˆPydantic éªŒè¯ï¼‰
- âš ï¸ é…ç½®æ–‡æ¡£éœ€è¦è¡¥å……å®Œæ•´

#### ä¾èµ–é¡¹

```toml
# å·²å®‰è£…ä¾èµ–
pydantic-settings>=2.3.0  âœ…
python-dotenv>=1.0.1      âœ…
```

---

### 1.2 é›†æˆçœŸå®çš„ LLM å’Œ Embeddings âœ… å·²å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­â­â­ (å¿…é¡»)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **æ›¿æ¢ FakeEmbeddings**
  - âœ… é›†æˆ OpenAI Embeddings
  - âœ… é›†æˆ OpenRouter Embeddingsï¼ˆæ”¯æŒå¤šç§æ¨¡å‹ï¼‰
  - âœ… å®ç° `OpenRouterEmbeddings` ç±»
  - âœ… å·¥å‚å‡½æ•° `build_embedding_function()`
  - âš ï¸ æœ¬åœ° Embeddingsï¼ˆsentence-transformersï¼‰- æœªå®ç°
  - âš ï¸ Embeddings ç¼“å­˜ - æœªå®ç°

- [x] **æ›¿æ¢ FakeLLM**
  - âœ… é›†æˆ OpenRouter LLMï¼ˆæ”¯æŒ OpenAI, Anthropic, Google ç­‰ï¼‰
  - âœ… å®ç° `OpenRouterLLM` ç±»
  - âœ… æ”¯æŒ OpenAI API å…¼å®¹æ¥å£
  - âœ… LLM å·¥å‚å‡½æ•° `build_llm()`
  - âš ï¸ æœ¬åœ° LLMï¼ˆOllamaï¼‰- æœªå®ç°

- [x] **API Key ç®¡ç†**
  - âœ… ç¯å¢ƒå˜é‡ç®¡ç† API keysï¼ˆSecretStrï¼‰
  - âœ… æ”¯æŒ OpenRouter å’Œ OpenAI API keys
  - âœ… é…ç½®éªŒè¯
  - âš ï¸ å¤š key è½®æ¢ - æœªå®ç°

- [x] **å®ç°é”™è¯¯å¤„ç†å’Œé‡è¯•**
  - âœ… ä½¿ç”¨ tenacity åº“å®ç°é‡è¯•ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
  - âœ… è¶…æ—¶å¤„ç†ï¼ˆtimeout é…ç½®ï¼‰
  - âœ… é”™è¯¯æ—¥å¿—è®°å½•
  - âš ï¸ ä¸“é—¨çš„é™æµå¤„ç† - æœªå®ç°

- [x] **æˆæœ¬è¿½è¸ª**
  - âœ… Token è®¡æ•°ï¼ˆOpenRouterLLM.token_usageï¼‰
  - âœ… ä½¿ç”¨ç»Ÿè®¡æ–¹æ³•
  - âš ï¸ è¯¦ç»†æˆæœ¬ä¼°ç®— - éœ€å®Œå–„

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥æ­£å¸¸è°ƒç”¨ OpenAI/OpenRouter API ç”Ÿæˆ embeddings
- âœ… QA è¿”å›æœ‰æ„ä¹‰çš„ç­”æ¡ˆï¼ˆå·²ä½¿ç”¨çœŸå® LLMï¼‰
- âœ… API è°ƒç”¨å¤±è´¥æœ‰é‡è¯•æœºåˆ¶ï¼ˆmax_retries=3ï¼‰
- âœ… Token ä½¿ç”¨å¯è¿½è¸ª

#### æ–°å¢ä¾èµ–

```toml
# å·²å®‰è£…
openai>=1.0.0              âœ…
langchain-openai>=0.1.25   âœ…
tenacity>=8.0.0            âœ…
```

#### é…ç½®ç¤ºä¾‹

```python
# .env
# OpenRouter (æ¨èï¼Œæ”¯æŒå¤šç§æ¨¡å‹)
OPENROUTER_API_KEY=sk-or-xxx
LLM_PROVIDER=openrouter
LLM_MODEL=openai/gpt-3.5-turbo
EMBEDDING_PROVIDER=openrouter
EMBEDDING_MODEL=openai/text-embedding-3-small

# æˆ–ä½¿ç”¨ OpenAI
OPENAI_API_KEY=sk-xxx
LLM_PROVIDER=openai
EMBEDDING_PROVIDER=openai
```

---

### 1.3 å»ºç«‹æ ¸å¿ƒæ¥å£æŠ½è±¡ âœ… å·²å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **åˆ›å»ºæ ¸å¿ƒæ¥å£**
  ```
  å·²å®ç°: rag_core/core/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ interfaces.py          # æ‰€æœ‰æ¥å£å®šä¹‰
  â”œâ”€â”€ models.py              # Document ç­‰æ•°æ®æ¨¡å‹
  â”œâ”€â”€ exceptions.py          # è‡ªå®šä¹‰å¼‚å¸¸ç±»
  â””â”€â”€ (constants å¯æŒ‰éœ€æ·»åŠ )
  ```

- [x] **å®šä¹‰æ¥å£**
  - âœ… `RetrieverInterface`: æ£€ç´¢å™¨æ¥å£
  - âœ… `RerankerInterface`: é‡æ’åºå™¨æ¥å£
  - âœ… `GeneratorInterface`: ç”Ÿæˆå™¨æ¥å£
  - âœ… `MemoryInterface`: è®°å¿†æ¥å£
  - âš ï¸ `CacheInterface`: å¾…å®ç°

- [x] **åˆ›å»ºå·¥å‚ç±»**
  - âœ… `RetrieverFactory` - å·²å®ç°
  - âš ï¸ `RerankerFactory` - å¾…å®ç°
  - âš ï¸ `GeneratorFactory` - å¾…å®ç°
  - âš ï¸ `MemoryFactory` - å¾…å®ç°

- [x] **é‡æ„ç°æœ‰ä»£ç **
  - âœ… VectorRetriever å®ç° RetrieverInterface
  - âœ… ä½¿ç”¨å·¥å‚æ¨¡å¼åˆ›å»ºæ£€ç´¢å™¨
  - âš ï¸ æµ‹è¯•è¦†ç›–ç‡éœ€æå‡

#### éªŒæ”¶æ ‡å‡†

- âœ… æ ¸å¿ƒæ¥å£å®šä¹‰æ¸…æ™°å®Œæ•´
- âœ… VectorRetriever ç¬¦åˆæ¥å£è§„èŒƒ
- âš ï¸ å…¶ä»–å·¥å‚ç±»å¾…è¡¥å……
- âš ï¸ æ¥å£æ–‡æ¡£å’Œæµ‹è¯•éœ€å®Œå–„

#### æ ¸å¿ƒæ¥å£ç¤ºä¾‹

```python
from abc import ABC, abstractmethod
from typing import List, Dict, Any

class RetrieverInterface(ABC):
    @abstractmethod
    async def retrieve(self, query: str, top_k: int) -> List[Document]:
        """æ£€ç´¢ç›¸å…³æ–‡æ¡£"""
        pass

class GeneratorInterface(ABC):
    @abstractmethod
    async def generate(
        self, 
        query: str, 
        context: List[Document],
        stream: bool = False
    ) -> str:
        """ç”Ÿæˆç­”æ¡ˆ"""
        pass
```

---

### Phase 1 äº¤ä»˜ç‰© âœ…

- âœ… å®Œå–„çš„é…ç½®ç³»ç»Ÿï¼ˆPydantic Settingsï¼Œæ¨¡å—åŒ–é…ç½®ï¼‰
- âœ… çœŸå®çš„ LLM/Embeddings é›†æˆï¼ˆOpenRouter + OpenAIï¼‰
- âœ… æ¸…æ™°çš„æ¥å£æŠ½è±¡å±‚ï¼ˆRetrieverInterface ç­‰ï¼‰
- âš ï¸ åŸºç¡€å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›–ç‡éœ€æå‡ï¼‰
- âš ï¸ é…ç½®æ–‡æ¡£éœ€è¡¥å……å®Œæ•´

**æ€»ç»“**: Phase 1 æ ¸å¿ƒç›®æ ‡å·²è¾¾æˆï¼Œå¯æ”¯æ’‘åç»­å¼€å‘ã€‚éœ€è¡¥å……å®Œæ•´æµ‹è¯•å’Œæ–‡æ¡£ã€‚

---

## Phase 2: å¢å¼ºæ£€ç´¢èƒ½åŠ› (Week 3-4) ğŸŸ¡ 40% å®Œæˆ

**ğŸ¯ ç›®æ ‡**: æå‡æ£€ç´¢è´¨é‡ï¼Œè¿™æ˜¯ RAG ç³»ç»Ÿçš„æ ¸å¿ƒ

**â±ï¸ é¢„è®¡æ—¶é—´**: 2 å‘¨ (9 å·¥ä½œæ—¥)  
**ğŸ“Š å®é™…çŠ¶æ€**: ğŸŸ¡ éƒ¨åˆ†å®Œæˆï¼Œæ ¸å¿ƒåŠŸèƒ½å¾…è¡¥å……

### 2.1 å®ç°å¤šç§æ£€ç´¢ç­–ç•¥ âš ï¸ éƒ¨åˆ†å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­â­â­ (å¿…é¡»)  
**å·¥ä½œé‡**: 3-4 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **ä¼˜åŒ– VectorRetriever**
  ```
  å·²å®ç°: rag_core/retrievers/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ vector_retriever.py        # å‘é‡æ£€ç´¢ âœ…
  â”œâ”€â”€ factory.py                 # å·¥å‚ç±» âœ…
  â””â”€â”€ (å¾…è¡¥å……)
      â”œâ”€â”€ hybrid_retriever.py        # æ··åˆæ£€ç´¢ â­ æœªå®ç°
      â”œâ”€â”€ multi_query_retriever.py   # å¤šæŸ¥è¯¢æ£€ç´¢ æœªå®ç°
      â””â”€â”€ ensemble_retriever.py      # é›†æˆæ£€ç´¢ æœªå®ç°
  ```
  - âœ… VectorRetriever æ”¯æŒ similarity å’Œ MMR æœç´¢
  - âœ… ç›¸ä¼¼åº¦è¯„åˆ†è½¬æ¢
  - âœ… é…ç½®åŒ– top_k å’Œæœç´¢å‚æ•°

- [ ] **å®ç° HybridRetriever** â­ (é«˜ä¼˜å…ˆçº§ - æœªå®ç°)
  - âŒ é›†æˆ BM25 æ£€ç´¢å™¨
  - âŒ å®ç°å‘é‡å’Œ BM25 ç»“æœèåˆ
  - âŒ æ”¯æŒæƒé‡é…ç½®ï¼ˆé»˜è®¤ 0.7/0.3ï¼‰
  - âŒ æ€§èƒ½ä¼˜åŒ–

- [ ] **å®ç° MultiQueryRetriever** (ä¸­ä¼˜å…ˆçº§ - æœªå®ç°)
  - âŒ ä½¿ç”¨ LLM ç”Ÿæˆå¤šä¸ªæŸ¥è¯¢å˜ä½“
  - âŒ å¹¶è¡Œæ£€ç´¢
  - âŒ ç»“æœå»é‡å’Œåˆå¹¶

- [ ] **å®ç° EnsembleRetriever** (ä½ä¼˜å…ˆçº§ - æœªå®ç°)
  - âŒ ç»„åˆå¤šä¸ªæ£€ç´¢å™¨
  - âŒ åŠ æƒæŠ•ç¥¨æœºåˆ¶

- [x] **RetrieverFactory**
  - âœ… å·²å®ç°åŸºç¡€å·¥å‚ç±»
  - âœ… æ”¯æŒ VectorRetriever åˆ›å»º
  - âš ï¸ éœ€æ·»åŠ å…¶ä»–æ£€ç´¢å™¨ç±»å‹

#### éªŒæ”¶æ ‡å‡†

- âš ï¸ Hybrid æ£€ç´¢å¾…å®ç°
- âœ… å¯ä»¥é€šè¿‡é…ç½®åˆ›å»º VectorRetriever
- âš ï¸ æ€§èƒ½æµ‹è¯•å¾…è¡¥å……
- âŒ å®Œæ•´çš„æ€§èƒ½æµ‹è¯•æŠ¥å‘Šå¾…ç”Ÿæˆ

#### æ–°å¢ä¾èµ–

```toml
rank-bm25>=0.2.2  # å¾…å®‰è£…ï¼Œç”¨äº HybridRetriever
```

#### å»ºè®®å®æ–½é¡ºåº

1. âœ… **VectorRetriever** (å·²å®Œæˆ) - åŸºç¡€å‘é‡æ£€ç´¢
2. â­ **HybridRetriever** (é«˜ä¼˜å…ˆçº§) - æå‡å¬å›ç‡ï¼Œé¢„è®¡ 2 å¤©
3. **MultiQueryRetriever** (ä¸­ä¼˜å…ˆçº§) - å¢å¼ºå¬å›å¤šæ ·æ€§ï¼Œé¢„è®¡ 1 å¤©
4. **EnsembleRetriever** (å¯é€‰) - æ ¹æ®éœ€æ±‚å†³å®š

---

### 2.2 å®ç°æ–‡æ¡£åå¤„ç† âŒ æœªå®ç°

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©  
**çŠ¶æ€**: æœªå¼€å§‹

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºæ–‡æ¡£å¤„ç†æ¨¡å—**
  ```
  rag/processing/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ deduplicator.py        # å»é‡
  â”œâ”€â”€ mmr_filter.py          # MMR è¿‡æ»¤
  â”œâ”€â”€ compressor.py          # ä¸Šä¸‹æ–‡å‹ç¼©
  â””â”€â”€ pipeline.py            # å¤„ç† pipeline
  ```

- [ ] **å®ç°å»é‡ (Deduplication)**
  - åŸºäºå†…å®¹å“ˆå¸Œå»é‡
  - åŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦å»é‡
  - ä¿ç•™æœ€é«˜åˆ†æ–‡æ¡£

- [ ] **å®ç° MMR è¿‡æ»¤**
  - Maximum Marginal Relevance ç®—æ³•
  - å¹³è¡¡ç›¸å…³æ€§å’Œå¤šæ ·æ€§
  - å¯é…ç½® lambda å‚æ•°

- [ ] **å®ç°ä¸Šä¸‹æ–‡å‹ç¼©**
  - ä½¿ç”¨ LLM æå–ç›¸å…³å†…å®¹
  - å‡å°‘ token ä½¿ç”¨
  - ä¿æŒè¯­ä¹‰å®Œæ•´æ€§

- [ ] **é›†æˆåˆ°æ£€ç´¢æµç¨‹**
  - åœ¨æ£€ç´¢å’Œé‡æ’åºä¹‹é—´æ’å…¥
  - å¯é…ç½®å¼€å…³

#### éªŒæ”¶æ ‡å‡†

- âœ… å»é‡åæ–‡æ¡£æ•°é‡å‡å°‘ 20-30%
- âœ… MMR æé«˜æ–‡æ¡£å¤šæ ·æ€§ï¼ˆcosine similarity < 0.8ï¼‰
- âœ… ä¸Šä¸‹æ–‡å‹ç¼©å‡å°‘ token ä½¿ç”¨ 30%+
- âœ… å¤„ç†å»¶è¿Ÿ < 200ms

#### æ–°å¢ä¾èµ–

```toml
langchain-community>=0.2.0  # ç”¨äº LLMChainExtractor
```

---

### 2.3 å®ç°é‡æ’åº âŒ æœªå®ç°

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©  
**çŠ¶æ€**: æœªå¼€å§‹ï¼Œæ¥å£å·²å®šä¹‰

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºé‡æ’åºæ¨¡å—**
  ```
  è®¡åˆ’: rag_core/rerankers/
  â”œâ”€â”€ __init__.py  (å·²å­˜åœ¨ï¼Œç©ºæ–‡ä»¶)
  â”œâ”€â”€ base.py                      # åŸºç±» - å¾…å®ç°
  â”œâ”€â”€ cross_encoder_reranker.py    # Cross-Encoder â­ å¾…å®ç°
  â”œâ”€â”€ llm_reranker.py              # LLM é‡æ’åº - å¾…å®ç°
  â”œâ”€â”€ score_based_reranker.py      # åˆ†æ•°é‡æ’åº - å¾…å®ç°
  â””â”€â”€ factory.py                   # å·¥å‚ç±» - å¾…å®ç°
  ```
  æ³¨: RerankerInterface æ¥å£å·²åœ¨ core/interfaces.py ä¸­å®šä¹‰

- [ ] **å®ç° Cross-Encoder Reranker** â­ (é«˜ä¼˜å…ˆçº§)
  - ä½¿ç”¨ sentence-transformers
  - æ¨¡å‹: `cross-encoder/ms-marco-MiniLM-L-6-v2`
  - æ‰¹é‡æ¨ç†ä¼˜åŒ–
  - ç¼“å­˜æœºåˆ¶

- [ ] **å®ç° LLM Reranker** (å¯é€‰)
  - ä½¿ç”¨ GPT-4 è¯„åˆ†
  - æ›´å‡†ç¡®ä½†æ›´æ˜‚è´µ
  - å¯ä½œä¸ºé»„é‡‘æ ‡å‡†å¯¹æ¯”

- [ ] **é›†æˆåˆ° RAG Pipeline**
  - åœ¨æ–‡æ¡£å¤„ç†ååº”ç”¨
  - å¯é…ç½® top_n
  - æ€§èƒ½ç›‘æ§

- [ ] **A/B æµ‹è¯•**
  - å¯¹æ¯”é‡æ’åºå‰åæ•ˆæœ
  - ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š

#### éªŒæ”¶æ ‡å‡†

- âœ… Top-3 å‡†ç¡®ç‡æå‡ 15%+
- âœ… ç«¯åˆ°ç«¯å»¶è¿Ÿå¢åŠ  < 300ms
- âœ… æœ‰æ¸…æ™°çš„ A/B æµ‹è¯•æŠ¥å‘Š
- âœ… é‡æ’åºå¯é€šè¿‡é…ç½®å¼€å…³

#### æ–°å¢ä¾èµ–

```toml
sentence-transformers>=2.2.0
torch>=2.0.0  # Cross-Encoder ä¾èµ–
```

#### å»ºè®®å®æ–½é¡ºåº

1. **Cross-Encoder** â­ (æ€§ä»·æ¯”æœ€é«˜) - 2 å¤©
2. **LLM Reranker** (å¯é€‰ï¼Œæ˜‚è´µ) - 1 å¤©ï¼Œå¯è·³è¿‡

---

### Phase 2 äº¤ä»˜ç‰© âš ï¸

- âœ… **VectorRetriever** - åŸºç¡€å‘é‡æ£€ç´¢å·²å®Œæˆ
- âœ… **RetrieverFactory** - å·¥å‚æ¨¡å¼å·²å®ç°
- âŒ **æ··åˆæ£€ç´¢ç³»ç»Ÿ**ï¼ˆVector + BM25ï¼‰- å¾…å®ç°
- âŒ **æ–‡æ¡£åå¤„ç† pipeline** - å¾…å®ç°
- âŒ **Cross-Encoder é‡æ’åº** - å¾…å®ç°
- âŒ **æ£€ç´¢è´¨é‡è¯„ä¼°æŠ¥å‘Š** - å¾…å®ç°

**æ€»ç»“**: Phase 2 å®Œæˆåº¦ 40%ï¼ŒåŸºç¡€æ£€ç´¢å¯ç”¨ï¼Œä½†ç¼ºå°‘å…³é”®çš„æ··åˆæ£€ç´¢å’Œé‡æ’åºåŠŸèƒ½ã€‚è¿™æ˜¯ä¸‹ä¸€æ­¥ä¼˜å…ˆè¦è¡¥å……çš„ã€‚

---

## Phase 3: æŸ¥è¯¢ç†è§£ä¸è·¯ç”± (Week 5) âœ… 70% å®Œæˆ

**ğŸ¯ ç›®æ ‡**: è®©ç³»ç»Ÿæ›´æ™ºèƒ½åœ°ç†è§£å’Œå¤„ç†æŸ¥è¯¢

**â±ï¸ é¢„è®¡æ—¶é—´**: 1 å‘¨ (7 å·¥ä½œæ—¥)  
**ğŸ“Š å®é™…çŠ¶æ€**: âœ… åŸºæœ¬å®Œæˆï¼Œæ ¸å¿ƒåŠŸèƒ½å·²å¯ç”¨

### 3.1 å®ç°æŸ¥è¯¢é¢„å¤„ç† âš ï¸ éƒ¨åˆ†å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 1-2 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **åˆ›å»ºé¢„å¤„ç†æ¨¡å—**
  ```
  å·²å®ç°: rag_core/preprocessing/
  â”œâ”€â”€ __init__.py
  â””â”€â”€ langextract_parser.py  # è¯­è¨€æ£€æµ‹å’Œæ–‡æ¡£è§£æ
  ```
  - âœ… è¯­è¨€æ£€æµ‹åŠŸèƒ½é›†æˆåœ¨æ–‡æ¡£è§£æä¸­
  - âš ï¸ æŸ¥è¯¢æ¸…æ´—æ¨¡å—å¾…ç‹¬ç«‹å®ç°

- [ ] **å®ç°æŸ¥è¯¢æ¸…æ´—** (å¾…å®Œå–„)
  - âš ï¸ åŸºç¡€æ¸…æ´—åœ¨æŸ¥è¯¢å¤„ç†ä¸­æœ‰éƒ¨åˆ†å®ç°
  - âŒ ç‹¬ç«‹çš„æŸ¥è¯¢æ¸…æ´—æ¨¡å—æœªå®ç°
  - âŒ æ‹¼å†™çº æ­£æœªå®ç°

- [x] **å®ç°è¯­è¨€æ£€æµ‹**
  - âœ… ä½¿ç”¨ langextract åº“
  - âœ… æ”¯æŒå¤šè¯­è¨€æ£€æµ‹
  - âœ… åœ¨æ–‡æ¡£å¤„ç†ä¸­åº”ç”¨
  - âš ï¸ æŸ¥è¯¢çº§åˆ«çš„è¯­è¨€æ£€æµ‹å¾…å®Œå–„

- [x] **å®ç°æ„å›¾åˆ†ç±»**
  - âœ… åŸºäºè§„åˆ™çš„ QueryIntentClassifier
  - âœ… æ”¯æŒ META/DOCUMENT/HYBRID/GENERAL å››ç§æ„å›¾
  - âœ… è¯¦ç»†çš„æ¨¡å¼åŒ¹é…è§„åˆ™
  - âœ… ç½®ä¿¡åº¦è¯„åˆ†

#### éªŒæ”¶æ ‡å‡†

- âœ… æ„å›¾åˆ†ç±»å·¥ä½œè‰¯å¥½
- âœ… è¯­è¨€æ£€æµ‹å·²é›†æˆ
- âš ï¸ æŸ¥è¯¢æ¸…æ´—éœ€è¦ç‹¬ç«‹æ¨¡å—
- âœ… å¤„ç†å»¶è¿Ÿç¬¦åˆè¦æ±‚

#### æ–°å¢ä¾èµ–

```toml
langextract>=1.0.0  âœ… å·²å®‰è£…
```

---

### 3.2 å®ç°æŸ¥è¯¢è½¬æ¢ âš ï¸ éƒ¨åˆ†å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ–** (å·²å®ç°)
  ```
  å·²å®ç°: rag_core/graphs/memory_nodes.py
  â””â”€â”€ contextualize_query_node()  # å¯¹è¯ä¸Šä¸‹æ–‡åŒ–
  ```
  - âœ… ç»“åˆå¯¹è¯å†å²é‡å†™æŸ¥è¯¢
  - âœ… è§£æä»£è¯æŒ‡ä»£
  - âœ… ç”Ÿæˆç‹¬ç«‹æŸ¥è¯¢
  - âœ… é›†æˆåœ¨ QA Graph ä¸­

- [ ] **å®ç° Multi-Query ç”Ÿæˆ** â­ (é«˜ä¼˜å…ˆçº§ - æœªå®ç°)
  - âŒ ä½¿ç”¨ LLM ç”Ÿæˆ 3-5 ä¸ªæŸ¥è¯¢å˜ä½“
  - âŒ ä¸åŒè§’åº¦ã€ä¸åŒæªè¾
  - âŒ å¹¶è¡Œæ£€ç´¢å’Œåˆå¹¶
  - âŒ ç»“æœå»é‡

- [ ] **å®ç° Step-back Prompting** (æœªå®ç°)
  - âŒ ç”Ÿæˆæ›´æŠ½è±¡çš„æŸ¥è¯¢
  - âŒ è·å–æ›´å¹¿æ³›çš„ä¸Šä¸‹æ–‡

- [ ] **å®ç°æŸ¥è¯¢åˆ†è§£** (æœªå®ç°)
  - âŒ å°†å¤æ‚æŸ¥è¯¢åˆ†è§£ä¸ºå­æŸ¥è¯¢
  - âŒ æŒ‰é¡ºåºæˆ–å¹¶è¡Œæ‰§è¡Œ

#### éªŒæ”¶æ ‡å‡†

- âœ… æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ–å·¥ä½œè‰¯å¥½
- âš ï¸ Multi-Query å¾…å®ç°
- âŒ æ•ˆæœå¯¹æ¯”æŠ¥å‘Šå¾…ç”Ÿæˆ

#### Prompt ç¤ºä¾‹

```python
# Multi-Query Prompt
MULTI_QUERY_PROMPT = """
You are an AI assistant. Generate 3 different versions of the given question 
to retrieve relevant documents from a vector database.

Original question: {question}

Alternative questions:
1.
2.
3.
"""
```

#### å»ºè®®å®æ–½é¡ºåº

1. **Multi-Query** â­ (æœ€å®¹æ˜“ï¼Œæ•ˆæœå¥½) - 1.5 å¤©
2. **Step-back** (æé«˜ç†è§£) - 1 å¤©
3. **Decomposition** (å¤„ç†å¤æ‚æŸ¥è¯¢) - 0.5 å¤©

---

### 3.3 å®ç°æ™ºèƒ½è·¯ç”± âœ… å·²å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **åˆ›å»ºè·¯ç”±æ¨¡å—**
  ```
  å·²å®ç°: rag_core/routing/
  â”œâ”€â”€ __init__.py
  â””â”€â”€ query_intent.py          # æŸ¥è¯¢æ„å›¾åˆ†ç±»å’Œè·¯ç”±
  ```
  - âœ… QueryIntentClassifier - åŸºäºè§„åˆ™çš„æ„å›¾åˆ†ç±»å™¨
  - âœ… QueryRouter - è·¯ç”±å†³ç­–å™¨
  - âš ï¸ è¯­ä¹‰è·¯ç”±ï¼ˆsemantic-routeråº“ï¼‰- éƒ¨åˆ†å°è¯•

- [x] **å®šä¹‰è·¯ç”±ç±»å‹**
  ```python
  å·²å®ç°: QueryIntent (Enum)
  - META = "meta"           # å…ƒé—®é¢˜ï¼ˆå…³äºå¯¹è¯æœ¬èº«ï¼‰
  - DOCUMENT = "document"   # æ–‡æ¡£é—®é¢˜ï¼ˆéœ€è¦æ£€ç´¢ï¼‰
  - HYBRID = "hybrid"       # æ··åˆé—®é¢˜ï¼ˆå¯¹è¯+æ£€ç´¢ï¼‰
  - GENERAL = "general"     # é€šç”¨é—®é¢˜ï¼ˆé—®å€™ç­‰ï¼‰
  ```
  ```python
  class QueryType(str, Enum):
      GREETING = "greeting"           # ç®€å•é—®å€™
      FACTUAL = "factual"            # äº‹å®æŸ¥è¯¢
      REASONING = "reasoning"         # å¤æ‚æ¨ç†
      CONVERSATIONAL = "conversational" # å¯¹è¯åœºæ™¯
      SUMMARIZATION = "summarization" # æ–‡æ¡£æ€»ç»“
  ```

- [x] **å®ç°è§„åˆ™è·¯ç”±**
  - âœ… åŸºäºæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼åŒ¹é…
  - âœ… è¯¦ç»†çš„æ¨¡å¼åº“ï¼ˆ100+ patternsï¼‰
  - âœ… ç½®ä¿¡åº¦è¯„åˆ†æœºåˆ¶

- [ ] **å®ç°è¯­ä¹‰è·¯ç”±** (éƒ¨åˆ†å®Œæˆ)
  - âš ï¸ å°è¯•è¿‡ Semantic Router åº“
  - âœ… åŸºäºè§„åˆ™çš„è·¯ç”±å·¥ä½œè‰¯å¥½
  - âŒ æ·±åº¦å­¦ä¹ æ¨¡å‹è·¯ç”±æœªå®ç°

- [x] **å®šä¹‰è·¯ç”±ç­–ç•¥**
  - âœ… META â†’ çŸ­æœŸè®°å¿†ï¼Œä¸æ£€ç´¢
  - âœ… DOCUMENT â†’ æ–‡æ¡£æ£€ç´¢
  - âœ… HYBRID â†’ æ··åˆç­–ç•¥
  - âœ… GENERAL â†’ ç›´æ¥å“åº”

- [x] **è·¯ç”±é€»è¾‘å·²å®ç°**
  - âœ… QueryRouter.get_retrieval_strategy()
  - âœ… æƒé‡é…ç½®ï¼ˆdocument_priority/memory_priorityï¼‰
  - âš ï¸ APIå±‚é›†æˆå¾…å®Œå–„

#### éªŒæ”¶æ ‡å‡†

- âœ… é€šç”¨é—®é¢˜è¯†åˆ«å‡†ç¡®
- âœ… è·¯ç”±ç­–ç•¥å®šä¹‰æ¸…æ™°
- âœ… åŸºäºè§„åˆ™çš„è·¯ç”±æ€§èƒ½å¥½
- âš ï¸ å‡†ç¡®ç‡ç›‘æ§å¾…å»ºç«‹

#### æ–°å¢ä¾èµ–

```toml
semantic-router>=0.0.17  # å¯é€‰
```

---

### Phase 3 äº¤ä»˜ç‰© âœ…

- âœ… **æŸ¥è¯¢æ„å›¾åˆ†ç±»** - QueryIntentClassifier å·²å®ç°
- âœ… **æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ–** - contextualize_query_node å·²å®ç°
- âœ… **æ™ºèƒ½è·¯ç”±ç³»ç»Ÿ** - QueryRouter å·²å®ç°
- âœ… **è¯­è¨€æ£€æµ‹** - langextract å·²é›†æˆ
- âš ï¸ Multi-Query ç”Ÿæˆå¾…å®ç°
- âš ï¸ è·¯ç”±æ•ˆæœè¯„ä¼°æŠ¥å‘Šå¾…è¡¥å……

**æ€»ç»“**: Phase 3 å®Œæˆåº¦ 70%ï¼Œæ ¸å¿ƒçš„æ„å›¾åˆ†ç±»å’Œè·¯ç”±å·²å¯ç”¨ï¼Œç¼ºå°‘Multi-Queryç­‰é«˜çº§æŸ¥è¯¢è½¬æ¢åŠŸèƒ½ã€‚

---

## Phase 4: ç”Ÿæˆå¢å¼ºä¸éªŒè¯ (Week 6) âš ï¸ 50% å®Œæˆ

**ğŸ¯ ç›®æ ‡**: æå‡ç”Ÿæˆè´¨é‡ï¼Œå‡å°‘å¹»è§‰

**â±ï¸ é¢„è®¡æ—¶é—´**: 1 å‘¨ (7 å·¥ä½œæ—¥)  
**ğŸ“Š å®é™…çŠ¶æ€**: âš ï¸ åŸºç¡€åŠŸèƒ½å¯ç”¨ï¼Œé«˜çº§ç‰¹æ€§å¾…è¡¥å……

### 4.1 ä¼˜åŒ– Prompt å·¥ç¨‹ âš ï¸ éƒ¨åˆ†å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **åŸºç¡€ Prompt å®ç°**
  ```
  å·²å®ç°: rag_core/chains/qa_chain.py
  â””â”€â”€ build_answer_chain()  # ä½¿ç”¨ LangChain prompt templates
  ```
  - âœ… QA prompt æ¨¡æ¿
  - âœ… å¯¹è¯ä¸Šä¸‹æ–‡åŒ– prompt
  - âš ï¸ ç‹¬ç«‹ prompt ç®¡ç†æ¨¡å—å¾…å»ºç«‹

- [ ] **åˆ›å»º Prompt ç®¡ç†æ¨¡å—** (æœªå®Œå–„)
  ```
  rag/prompts/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py                # åŸºç¡€ Prompt ç±»
  â”œâ”€â”€ qa_prompts.py          # QA Prompts
  â”œâ”€â”€ chat_prompts.py        # Chat Prompts
  â”œâ”€â”€ summary_prompts.py     # æ€»ç»“ Prompts
  â””â”€â”€ templates/             # Prompt æ¨¡æ¿ç›®å½•
      â”œâ”€â”€ qa_default.txt
      â”œâ”€â”€ qa_with_sources.txt
      â””â”€â”€ chat_context.txt
  ```

- [ ] **è®¾è®¡ Prompt æ¨¡æ¿**
  - QA Promptï¼ˆå¸¦å¼•ç”¨æ¥æºï¼‰
  - Chat Promptï¼ˆå¯¹è¯å¼ï¼‰
  - Summarization Prompt
  - å¤šè¯­è¨€æ”¯æŒ

- [ ] **å®ç° Prompt ç‰ˆæœ¬ç®¡ç†**
  - Git ç®¡ç† Prompt æ–‡ä»¶
  - Prompt ç‰ˆæœ¬å·
  - A/B æµ‹è¯•æ”¯æŒ

- [ ] **Prompt ä¼˜åŒ–**
  - Few-shot examples
  - Chain-of-thought
  - ç»“æ„åŒ–è¾“å‡ºæŒ‡ä»¤

- [ ] **A/B æµ‹è¯•æ¡†æ¶**
  - å¯¹æ¯”ä¸åŒ Prompt æ•ˆæœ
  - æ”¶é›†ç”¨æˆ·åé¦ˆ
  - æ•°æ®é©±åŠ¨ä¼˜åŒ–

#### éªŒæ”¶æ ‡å‡†

- âœ… ç­”æ¡ˆè´¨é‡ä¸»è§‚è¯„åˆ†æå‡ï¼ˆ4.0 â†’ 4.5 / 5.0ï¼‰
- âœ… ç­”æ¡ˆæ›´åŠ ç»“æ„åŒ–ï¼ˆæœ‰æ¸…æ™°çš„åˆ†æ®µï¼‰
- âœ… å¼•ç”¨æ¥æºå‡†ç¡®ç‡ > 95%
- âœ… æœ‰ Prompt ç‰ˆæœ¬æ§åˆ¶

#### Prompt ç¤ºä¾‹

```python
QA_PROMPT_TEMPLATE = """
You are a helpful AI assistant. Answer the question based ONLY on the following context.

Context:
{context}

Question: {question}

Instructions:
1. Answer should be comprehensive but concise
2. Cite sources using [1], [2], etc.
3. If the answer is not in the context, say "I don't have enough information"
4. Be specific and factual

Answer:
"""
```

---

### 4.2 å®ç°æµå¼è¾“å‡º

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **ä¿®æ”¹ Generator æ”¯æŒæµå¼**
  ```
  rag/generators/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py                # åŸºç±»
  â”œâ”€â”€ streaming_generator.py # æµå¼ç”Ÿæˆå™¨ â­
  â”œâ”€â”€ batch_generator.py     # æ‰¹é‡ç”Ÿæˆå™¨
  â””â”€â”€ factory.py             # å·¥å‚ç±»
  ```

- [ ] **å®ç° StreamingGenerator**
  - æ”¯æŒ SSE (Server-Sent Events)
  - æ”¯æŒ WebSocketï¼ˆå¯é€‰ï¼‰
  - Token-by-token æµå¼è¾“å‡º
  - é”™è¯¯å¤„ç†

- [ ] **æ›´æ–° API Endpoints**
  - `POST /api/v1/query/stream` - æµå¼æ¥å£
  - `POST /api/v1/query` - ä¿æŒæ‰¹é‡æ¥å£
  - å“åº”æ ¼å¼ç»Ÿä¸€

- [ ] **æ›´æ–° LangGraph Workflow**
  - æ”¯æŒæµå¼ç”ŸæˆèŠ‚ç‚¹
  - ä¿æŒçŠ¶æ€è¿½è¸ª

- [ ] **å‰ç«¯é›†æˆç¤ºä¾‹**ï¼ˆå¯é€‰ï¼‰
  - JavaScript EventSource ç¤ºä¾‹
  - å®æ—¶æ˜¾ç¤ºè¾“å‡º

#### éªŒæ”¶æ ‡å‡†

- âœ… æ”¯æŒæµå¼å“åº”
- âœ… é¦–å­—å»¶è¿Ÿ < 1s
- âœ… æµå¼è¾“å‡ºç¨³å®šæ— æ–­è¿
- âœ… ç”¨æˆ·ä½“éªŒæ˜¾è‘—æå‡

#### API ç¤ºä¾‹

```python
@app.post("/api/v1/query/stream")
async def query_stream(request: QueryRequest):
    async def generate():
        async for chunk in pipeline.query_stream(request.query):
            yield f"data: {json.dumps({'chunk': chunk})}\n\n"
        yield f"data: {json.dumps({'done': True})}\n\n"
    
    return StreamingResponse(generate(), media_type="text/event-stream")
```

---

### 4.3 å®ç°è‡ªæˆ‘çº æ­£

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºè¯„ä¼°æ¨¡å—**
  ```
  rag/evaluation/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ faithfulness_checker.py    # å¿ å®åº¦æ£€æŸ¥
  â”œâ”€â”€ hallucination_detector.py  # å¹»è§‰æ£€æµ‹
  â”œâ”€â”€ relevance_scorer.py        # ç›¸å…³æ€§è¯„åˆ†
  â””â”€â”€ self_corrector.py          # è‡ªæˆ‘çº æ­£
  ```

- [ ] **å®ç°å¿ å®åº¦æ£€æŸ¥**
  - æ£€æŸ¥ç­”æ¡ˆæ˜¯å¦åŸºäºä¸Šä¸‹æ–‡
  - ä½¿ç”¨ LLM è¯„ä¼°
  - æˆ–ä½¿ç”¨ NLI æ¨¡å‹

- [ ] **å®ç°å¹»è§‰æ£€æµ‹**
  - æ£€æµ‹ä¸æ”¯æŒçš„é™ˆè¿°
  - æ£€æµ‹çŸ›ç›¾
  - ç½®ä¿¡åº¦è¯„åˆ†

- [ ] **å®ç°é‡è¯•æœºåˆ¶**
  - ä½è´¨é‡ç­”æ¡ˆè§¦å‘é‡è¯•
  - é‡æ–°æ£€ç´¢
  - é‡æ–°ç”Ÿæˆ
  - æœ€å¤šé‡è¯• 2 æ¬¡

- [ ] **é›†æˆåˆ° LangGraph**
  - æ·»åŠ è‡ªæˆ‘çº æ­£èŠ‚ç‚¹
  - æ¡ä»¶è¾¹ï¼šéœ€è¦é‡è¯• vs é€šè¿‡
  - è®°å½•çº æ­£æ¬¡æ•°

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥æ£€æµ‹æ˜æ˜¾çš„å¹»è§‰ï¼ˆå‡†ç¡®ç‡ > 80%ï¼‰
- âœ… ä¸å¿ å®çš„ç­”æ¡ˆè§¦å‘é‡è¯•
- âœ… æ•´ä½“å‡†ç¡®ç‡æå‡ 10%+
- âœ… é‡è¯•ä¸è¶…è¿‡ 2 æ¬¡ï¼ˆé¿å…æ— é™å¾ªç¯ï¼‰

#### è‡ªæˆ‘çº æ­£ Prompt

```python
FAITHFULNESS_CHECK_PROMPT = """
Check if the answer is supported by the context.

Context: {context}
Answer: {answer}

Is the answer faithful to the context? Answer yes or no and explain why.

Evaluation:
"""
```

---

### Phase 4 äº¤ä»˜ç‰©

- âœ… ä¼˜åŒ–çš„ Prompt ç³»ç»Ÿ
- âœ… æµå¼å“åº”åŠŸèƒ½
- âœ… è‡ªæˆ‘çº æ­£æœºåˆ¶
- âœ… ç­”æ¡ˆè´¨é‡æå‡ 15%+
- âœ… å¹»è§‰ç‡é™ä½ 50%+

---

## Phase 5: å¯¹è¯ä¸è®°å¿† (Week 7) âœ… 80% å®Œæˆ

**ğŸ¯ ç›®æ ‡**: æ”¯æŒå¤šè½®å¯¹è¯ï¼Œå¢åŠ ä¸Šä¸‹æ–‡ç†è§£

**â±ï¸ é¢„è®¡æ—¶é—´**: 1 å‘¨ (7 å·¥ä½œæ—¥)  
**ğŸ“Š å®é™…çŠ¶æ€**: âœ… ä¸»è¦åŠŸèƒ½å·²å®Œæˆï¼Œè¡¨ç°ä¼˜ç§€

### 5.1 å®ç°å¯¹è¯è®°å¿† âœ… å·²å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [x] **å¯¹è¯è®°å¿†ç³»ç»Ÿ** (å·²å®ç°)
  ```
  å·²å®ç°:
  â”œâ”€â”€ domain_models/ - Conversation å’Œ Message æ•°æ®æ¨¡å‹
  â”œâ”€â”€ rag_core/services/
  â”‚   â”œâ”€â”€ conversation_service.py  # å¯¹è¯ç®¡ç†
  â”‚   â”œâ”€â”€ message_service.py       # æ¶ˆæ¯ç®¡ç†ï¼ˆå«è¯­ä¹‰æ£€ç´¢ï¼‰
  â”‚   â””â”€â”€ embedding_helper.py      # åµŒå…¥ç”Ÿæˆ
  â”œâ”€â”€ rag_core/graphs/memory_nodes.py  # è®°å¿†èŠ‚ç‚¹
  â”‚   â”œâ”€â”€ load_memory_node()           # çŸ­æœŸè®°å¿†åŠ è½½
  â”‚   â”œâ”€â”€ retrieve_long_term_memory_node()  # é•¿æœŸè®°å¿†æ£€ç´¢
  â”‚   â””â”€â”€ save_memory_node()           # è®°å¿†ä¿å­˜
  â””â”€â”€ PostgreSQL + pgvector           # å‘é‡å­˜å‚¨
  ```

- [x] **å®ç°åˆ†å±‚è®°å¿†ç³»ç»Ÿ**
  - âœ… **çŸ­æœŸè®°å¿†ï¼ˆBufferï¼‰**: æœ€è¿‘Nè½®å¯¹è¯ï¼ˆé…ç½®åŒ–ï¼‰
  - âœ… **é•¿æœŸè®°å¿†ï¼ˆSemanticï¼‰**: åŸºäºpgvectorçš„ç›¸ä¼¼æ¶ˆæ¯æ£€ç´¢
  - âœ… ä¼šè¯å†…è®°å¿† + ä¸»é¢˜çº§è®°å¿†
  - âœ… é…ç½®åŒ–çš„ç›¸ä¼¼åº¦é˜ˆå€¼å’Œæ£€ç´¢æ•°é‡

- [x] **å®ç°å¯¹è¯ç®¡ç†**
  - âœ… Conversation æ¨¡å‹ï¼ˆUUID, topic_id, titleï¼‰
  - âœ… Message æ¨¡å‹ï¼ˆrole, content, sources, embeddingï¼‰
  - âœ… ConversationService CRUD
  - âœ… MessageService å«è¯­ä¹‰æ£€ç´¢
  - âœ… åŸºäº PostgreSQL + pgvector æŒä¹…åŒ–

- [x] **é›†æˆåˆ° QA Graph**
  - âœ… load_memory_node - åŠ è½½çŸ­æœŸè®°å¿†
  - âœ… retrieve_long_term_memory_node - æ£€ç´¢é•¿æœŸè®°å¿†
  - âœ… save_memory_node - ä¿å­˜æ–°æ¶ˆæ¯å’Œembedding
  - âœ… è‡ªåŠ¨ç”Ÿæˆæ¶ˆæ¯embeddingç”¨äºè¯­ä¹‰æ£€ç´¢

- [ ] **Redis ç¼“å­˜** (æœªå®ç°)
  - âŒ åˆ†å¸ƒå¼è®°å¿†å­˜å‚¨
  - âŒ TTL è‡ªåŠ¨æ¸…ç†

#### éªŒæ”¶æ ‡å‡†

- âœ… æ”¯æŒå¤šè½®å¯¹è¯
- âœ… ä¸Šä¸‹æ–‡è¿è´¯æ€§å¥½ï¼ˆå¯æ­£ç¡®ç†è§£ä»£è¯å’Œä¸Šä¸‹æ–‡ï¼‰
- âœ… åŸºäºpgvectorçš„è¯­ä¹‰æ£€ç´¢å·¥ä½œè‰¯å¥½
- âœ… Conversation/Message ç®¡ç†å®Œå–„
- âš ï¸ Redisç¼“å­˜å¾…å®ç°

#### æ–°å¢ä¾èµ–

```toml
redis>=4.5.0  # å¯é€‰
langchain-community>=0.2.0
```

#### å»ºè®®å®æ–½é¡ºåº

1. **Buffer Memory** â­ (ç®€å•ï¼Œé€‚åˆçŸ­å¯¹è¯) - 2 å¤©
2. **Summary Memory** (å¤„ç†é•¿å¯¹è¯) - 1 å¤©

---

### 5.2 å®ç° Conversational RAG

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **å®ç°æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ–**
  - ç»“åˆå†å²å¯¹è¯é‡å†™æŸ¥è¯¢
  - è§£æä»£è¯æŒ‡ä»£
  - å¤„ç†çœç•¥

- [ ] **åˆ›å»º Conversational Graph**
  ```python
  graph.add_node("load_memory", load_memory_node)
  graph.add_node("contextualize_query", contextualize_query_node)
  graph.add_node("retrieve", retrieve_node)
  graph.add_node("generate", generate_node)
  graph.add_node("save_memory", save_memory_node)
  ```

- [ ] **æ›´æ–° API**
  - æ·»åŠ  `session_id` å‚æ•°
  - æ”¯æŒå¯¹è¯å†å²è¿”å›
  - æ¸…é™¤ session API

- [ ] **å¤šè½®å¯¹è¯æµ‹è¯•**
  - åˆ›å»ºæµ‹è¯•å¯¹è¯åœºæ™¯
  - éªŒè¯ä¸Šä¸‹æ–‡ç†è§£
  - æ€§èƒ½æµ‹è¯•

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥ç†è§£ä»£è¯æŒ‡ä»£ ("å®ƒ", "è¿™ä¸ª", "åˆšæ‰çš„")
- âœ… å¯ä»¥å›ç­”è·Ÿè¿›é—®é¢˜
- âœ… å¤šè½®å¯¹è¯æµ‹è¯•ç”¨ä¾‹ 100% é€šè¿‡
- âœ… å¯¹è¯ä¸Šä¸‹æ–‡åŒ–å»¶è¿Ÿ < 500ms

#### æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ– Prompt

```python
CONTEXTUALIZE_PROMPT = """
Given a chat history and the latest user question, 
reformulate the question to be standalone.

Chat History:
{chat_history}

Latest Question: {question}

Standalone Question:
"""
```

---

### 5.3 å®ç°ç¼“å­˜ç³»ç»Ÿ

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºç¼“å­˜æ¨¡å—**
  ```
  rag/cache/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py              # ç¼“å­˜æ¥å£
  â”œâ”€â”€ memory_cache.py      # å†…å­˜ç¼“å­˜ â­
  â”œâ”€â”€ redis_cache.py       # Redis ç¼“å­˜
  â””â”€â”€ semantic_cache.py    # è¯­ä¹‰ç¼“å­˜ï¼ˆé«˜çº§ï¼‰
  ```

- [ ] **å®ç°å†…å­˜ç¼“å­˜** â­
  - LRU (Least Recently Used)
  - ç²¾ç¡®åŒ¹é…ç¼“å­˜
  - TTL æ”¯æŒ
  - å¤§å°é™åˆ¶

- [ ] **å®ç° Redis ç¼“å­˜**ï¼ˆå¯é€‰ï¼‰
  - åˆ†å¸ƒå¼ç¼“å­˜
  - æ”¯æŒå¤šå®ä¾‹å…±äº«
  - æŒä¹…åŒ–

- [ ] **å®ç°è¯­ä¹‰ç¼“å­˜**ï¼ˆé«˜çº§ï¼Œå¯é€‰ï¼‰
  - ç›¸ä¼¼æŸ¥è¯¢åŒ¹é…
  - ä½¿ç”¨ embeddings
  - ç›¸ä¼¼åº¦é˜ˆå€¼é…ç½®

- [ ] **é›†æˆåˆ° Pipeline**
  - æ£€ç´¢ç»“æœç¼“å­˜
  - ç”Ÿæˆç»“æœç¼“å­˜
  - ç¼“å­˜é”®è®¾è®¡

#### éªŒæ”¶æ ‡å‡†

- âœ… å¸¸è§æŸ¥è¯¢ç¼“å­˜å‘½ä¸­ç‡ > 50%
- âœ… ç¼“å­˜å“åº”å»¶è¿Ÿ < 100ms
- âœ… èŠ‚çœ API è°ƒç”¨æˆæœ¬ 30%+
- âœ… ç¼“å­˜ç®¡ç†æ­£å¸¸ï¼ˆè‡ªåŠ¨æ¸…ç†ï¼‰

#### æ–°å¢ä¾èµ–

```toml
cachetools>=5.3.0  # å†…å­˜ç¼“å­˜
redis>=4.5.0  # Redis ç¼“å­˜
```

#### å»ºè®®å®æ–½é¡ºåº

1. **Memory Cache** â­ (æœ€ç®€å•) - 1 å¤©
2. **Redis Cache** (ç”Ÿäº§ç¯å¢ƒæ¨è) - 1 å¤©
3. **Semantic Cache** (é«˜çº§ï¼Œå¯è·³è¿‡) - å¯é€‰

---

### Phase 5 äº¤ä»˜ç‰© âœ…

- âœ… **å¯¹è¯è®°å¿†ç³»ç»Ÿ** - åˆ†å±‚è®°å¿†ï¼ˆçŸ­æœŸ+é•¿æœŸï¼‰å·²å®Œæ•´å®ç°
- âœ… **å¤šè½®å¯¹è¯æ”¯æŒ** - åŸºäº Conversation/Message æ¨¡å‹
- âœ… **è¯­ä¹‰è®°å¿†æ£€ç´¢** - åŸºäº pgvector çš„å‘é‡æ£€ç´¢
- âœ… **æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ–** - è‡ªåŠ¨é‡å†™å«ä»£è¯çš„æŸ¥è¯¢
- âœ… **å¯¹è¯ä½“éªŒ** - ä¸Šä¸‹æ–‡ç†è§£å‡†ç¡®
- âŒ **Redisç¼“å­˜** - æœªå®ç°
- âŒ **Summary Memory** - æœªå®ç°

**æ€»ç»“**: Phase 5 å®Œæˆåº¦ 80%ï¼Œå¯¹è¯å¼RAGåŠŸèƒ½å®Œæ•´ä¸”è¡¨ç°ä¼˜ç§€ï¼Œæ˜¯ç³»ç»Ÿçš„ä¸€å¤§äº®ç‚¹ã€‚ç¼ºå°‘Redisç¼“å­˜ä¼˜åŒ–ã€‚

---

## Phase 6: å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ– (Week 8-9) âœ… 55% å®Œæˆ

**ğŸ¯ ç›®æ ‡**: è®©ç³»ç»Ÿå¯ç›‘æ§ã€å¯è°ƒè¯•ã€å¯ç»´æŠ¤

**â±ï¸ é¢„è®¡æ—¶é—´**: 2 å‘¨ (11 å·¥ä½œæ—¥)  
**ğŸ“Š å®é™…çŠ¶æ€**: âœ… è¯„ä¼°ç³»ç»Ÿå·²å®Œæˆï¼Œç›‘æ§ç³»ç»Ÿå¾…å»ºç«‹

### 6.1 é›†æˆ LangSmith âŒ æœªå®ç°

**ä¼˜å…ˆçº§**: â­â­â­â­â­ (å¿…é¡»)  
**å·¥ä½œé‡**: 1-2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **LangSmith é›†æˆ** (æœªå®ç°)
  - âŒ æ³¨å†Œå’Œé…ç½®
  - æ³¨å†Œ LangSmith è´¦å·
  - è·å– API key
  - é…ç½®ç¯å¢ƒå˜é‡

- [ ] **é›†æˆ LangSmith Tracing**
  - å®‰è£… langsmith SDK
  - é…ç½® tracing
  - æ·»åŠ è‡ªå®šä¹‰ tags

- [ ] **æ·»åŠ  Metadata**
  - ç”¨æˆ· ID
  - Session ID
  - æŸ¥è¯¢ç±»å‹
  - æ¨¡å‹ç‰ˆæœ¬
  - æˆæœ¬ä¿¡æ¯

- [ ] **åˆ›å»º Datasets**
  - è¯„ä¼°æ•°æ®é›†
  - é»„é‡‘æ ‡å‡†ç­”æ¡ˆ
  - å®šæœŸæ›´æ–°

#### éªŒæ”¶æ ‡å‡†

- âœ… æ‰€æœ‰è¯·æ±‚éƒ½æœ‰ trace
- âœ… å¯ä»¥åœ¨ LangSmith UI çœ‹åˆ°å®Œæ•´é“¾è·¯
- âœ… å»¶è¿Ÿã€æˆæœ¬å¯è¿½è¸ª
- âœ… å¯ä»¥å›æ”¾å’Œè°ƒè¯•

#### é…ç½®ç¤ºä¾‹

```python
# .env
LANGCHAIN_TRACING_V2=true
LANGCHAIN_API_KEY=lsv2_xxx
LANGCHAIN_PROJECT=rag-production
```

#### æ–°å¢ä¾èµ–

```toml
langsmith>=0.1.0
```

---

### 6.2 å®ç°ç»“æ„åŒ–æ—¥å¿—

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 1 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **é›†æˆ structlog**
  - å®‰è£… structlog
  - é…ç½®æ—¥å¿—æ ¼å¼
  - æ›¿æ¢æ ‡å‡† logging

- [ ] **å®šä¹‰æ—¥å¿—å­—æ®µ**
  ```python
  {
      "timestamp": "2024-01-01T12:00:00Z",
      "level": "info",
      "event": "query_received",
      "query": "What are AI agents?",
      "session_id": "sess_123",
      "user_id": "user_456",
      "trace_id": "trace_789",
      "latency_ms": 1234
  }
  ```

- [ ] **æ·»åŠ å…³é”®èŠ‚ç‚¹æ—¥å¿—**
  - æŸ¥è¯¢æ¥æ”¶
  - è·¯ç”±å†³ç­–
  - æ£€ç´¢å¼€å§‹/ç»“æŸ
  - ç”Ÿæˆå¼€å§‹/ç»“æŸ
  - é”™è¯¯æ—¥å¿—

- [ ] **æ—¥å¿—çº§åˆ«é…ç½®**
  - å¼€å‘ç¯å¢ƒ: DEBUG
  - ç”Ÿäº§ç¯å¢ƒ: INFO
  - å¯åŠ¨æ€è°ƒæ•´

#### éªŒæ”¶æ ‡å‡†

- âœ… æ—¥å¿—ç»“æ„åŒ–ï¼Œæ˜“äºè§£æ
- âœ… å…³é”®æ­¥éª¤éƒ½æœ‰æ—¥å¿—ï¼ˆè¦†ç›–ç‡ > 90%ï¼‰
- âœ… å¯ä»¥ç”¨æ—¥å¿—æ’æŸ¥é—®é¢˜
- âœ… æ”¯æŒæ—¥å¿—æœç´¢å’Œè¿‡æ»¤

#### æ–°å¢ä¾èµ–

```toml
structlog>=23.1.0
python-json-logger>=2.0.7
```

---

### 6.3 å®ç°æŒ‡æ ‡æ”¶é›†

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **å®šä¹‰å…³é”®æŒ‡æ ‡**
  ```python
  # Latency
  - query_latency_seconds (P50, P95, P99)
  - retrieval_latency_seconds
  - generation_latency_seconds
  
  # Success
  - query_success_total
  - query_error_total
  - error_rate
  
  # Usage
  - tokens_used_total
  - cost_usd_total
  - cache_hit_total
  - cache_miss_total
  
  # Quality
  - answer_quality_score
  - retrieval_recall_score
  ```

- [ ] **ä½¿ç”¨ Prometheus Client**
  - å®‰è£… prometheus-client
  - å®šä¹‰ metrics
  - æ·»åŠ  instrumentation

- [ ] **åˆ›å»º /metrics Endpoint**
  - æš´éœ² Prometheus metrics
  - æ”¯æŒ Prometheus æŠ“å–

- [ ] **Grafana Dashboard**ï¼ˆå¯é€‰ï¼‰
  - åˆ›å»º dashboard
  - å¯è§†åŒ–å…³é”®æŒ‡æ ‡
  - å‘Šè­¦è§„åˆ™

#### éªŒæ”¶æ ‡å‡†

- âœ… å…³é”®æŒ‡æ ‡å¯å¯¼å‡º
- âœ… `/metrics` endpoint å¯è®¿é—®
- âœ… æœ‰åŸºç¡€çš„æ€§èƒ½æŠ¥è¡¨
- âœ… å¯ä»¥å®æ—¶ç›‘æ§ç³»ç»ŸçŠ¶æ€

#### æ–°å¢ä¾èµ–

```toml
prometheus-client>=0.19.0
prometheus-fastapi-instrumentator>=6.1.0
```

---

### 6.4 å®ç°è¯„ä¼°ç³»ç»Ÿ âœ… å·²å®Œæˆ

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©  
**çŠ¶æ€**: âœ… æ ¸å¿ƒåŠŸèƒ½å·²å®ç°

#### ä»»åŠ¡æ¸…å•

- [x] **åˆ›å»ºè¯„ä¼°æ¨¡å—** âœ…
  ```
  å·²å®ç°: packages/rag-core/rag_core/evaluation/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ ragas_evaluator.py      # RAGAS è¯„ä¼°å™¨ âœ…
  â”œâ”€â”€ runtime_evaluator.py    # è¿è¡Œæ—¶è¯„ä¼°å™¨ âœ…
  â”œâ”€â”€ dataset.py              # è¯„ä¼°æ•°æ®é›†ç®¡ç† âœ…
  â””â”€â”€ models.py               # è¯„ä¼°æ•°æ®æ¨¡å‹
  ```

- [x] **å®ç° RAGAS è¯„ä¼°** âœ…
  - âœ… RAGASEvaluator ç±»å®ç°
  - âœ… æ”¯æŒ faithfulnessï¼ˆå¿ å®åº¦ï¼‰
  - âœ… æ”¯æŒ answer_relevancyï¼ˆç­”æ¡ˆç›¸å…³æ€§ï¼‰
  - âœ… æ”¯æŒ context_precisionï¼ˆä¸Šä¸‹æ–‡ç²¾ç¡®åº¦ï¼‰
  - âœ… æ”¯æŒ context_recallï¼ˆä¸Šä¸‹æ–‡å¬å›ç‡ï¼‰
  - âœ… æ”¯æŒ answer_similarityï¼ˆç­”æ¡ˆç›¸ä¼¼åº¦ï¼‰
  - âœ… æ”¯æŒ answer_correctnessï¼ˆç­”æ¡ˆæ­£ç¡®æ€§ï¼‰

- [x] **å®ç°è¿è¡Œæ—¶è¯„ä¼°ç³»ç»Ÿ** âœ…
  - âœ… RuntimeEvaluator ç±»
  - âœ… ä¸‰ç§è¯„ä¼°æ¨¡å¼ï¼š
    - **é‡‡æ ·æ¨¡å¼** (sampling): æŒ‰æ¯”ä¾‹é‡‡æ ·è¯„ä¼°ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒ
    - **å¼‚æ­¥æ¨¡å¼** (async_all): å¼‚æ­¥è¯„ä¼°æ‰€æœ‰æŸ¥è¯¢
    - **æ‰¹é‡æ¨¡å¼** (batch): å®šæœŸæ‰¹é‡è¯„ä¼°
  - âœ… QueryRecord æ•°æ®æ¨¡å‹
  - âœ… è¯„ä¼°ç»“æœå­˜å‚¨ (JSONL æ ¼å¼)
  - âœ… ç»Ÿè®¡ä¿¡æ¯è¿½è¸ª

- [x] **åˆ›å»ºè¯„ä¼°æ•°æ®é›†ç®¡ç†** âœ…
  - âœ… EvaluationDataset ç±»
  - âœ… æ”¯æŒ JSON/JSONL æ ¼å¼
  - âœ… æ•°æ®éªŒè¯å’Œé‡‡æ ·
  - âœ… è¿­ä»£å™¨æ”¯æŒ

- [x] **é›†æˆåˆ° QA æµç¨‹** âœ…
  - âœ… åœ¨ qa_stream.py ä¸­é›†æˆ
  - âœ… è‡ªåŠ¨è®°å½•æŸ¥è¯¢å’Œç­”æ¡ˆ
  - âœ… å¼‚æ­¥è¯„ä¼°ï¼Œä¸é˜»å¡ç”¨æˆ·å“åº”
  - âœ… è¯„ä¼°ç»“æœæŒä¹…åŒ–

- [x] **LLM å…¼å®¹æ€§å¢å¼º** âœ…
  - âœ… JSONCleaningLLMWrapper - æ¸…ç† markdown æ ¼å¼ JSON
  - âœ… åœ¨ OpenRouterLLM æºå¤´æ¸…ç†å“åº”
  - âœ… è§£å†³ Claude è¿”å› ```json...``` å¯¼è‡´ Pydantic è§£æå¤±è´¥çš„é—®é¢˜

- [ ] **API æ¥å£** (éƒ¨åˆ†å®Œæˆ)
  - âœ… `/api/v1/evaluation/stats` - è¯„ä¼°ç»Ÿè®¡
  - âœ… `/api/v1/evaluation/results` - è¯„ä¼°ç»“æœåˆ—è¡¨
  - âš ï¸ LangSmith é›†æˆ - å¾…å®ç°

- [ ] **è¯„ä¼°æŠ¥å‘Šç”Ÿæˆ** (å¾…å®Œå–„)
  - âš ï¸ å®šé‡æŒ‡æ ‡æ±‡æ€» - åŸºç¡€å®ç°
  - âŒ æ¡ˆä¾‹åˆ†æ - å¾…å®ç°
  - âŒ æ”¹è¿›å»ºè®® - å¾…å®ç°

#### éªŒæ”¶æ ‡å‡†

- âœ… RAGAS è¯„ä¼°æ¡†æ¶å·²é›†æˆ
- âœ… è¿è¡Œæ—¶è¯„ä¼°ç³»ç»Ÿå¯å·¥ä½œ
- âœ… æ”¯æŒå¤šç§è¯„ä¼°æŒ‡æ ‡
- âœ… è¯„ä¼°ç»“æœå¯æŒä¹…åŒ–
- âœ… ä¸é˜»å¡ç”¨æˆ·æŸ¥è¯¢å“åº”
- âš ï¸ è¯„ä¼°æ•°æ®é›†éœ€è¦è¡¥å……ï¼ˆå½“å‰é€šè¿‡å®é™…æŸ¥è¯¢è‡ªåŠ¨ç”Ÿæˆï¼‰
- âš ï¸ å®šæœŸè¯„ä¼°æŠ¥å‘Šå¾…å®ç°

#### å·²å®‰è£…ä¾èµ–

```toml
ragas>=0.1.0  âœ… å·²å®‰è£…
datasets>=2.14.0  âœ… å·²å®‰è£…
```

#### é…ç½®ç¤ºä¾‹

```bash
# .env
RUNTIME_EVALUATION__ENABLED=true
RUNTIME_EVALUATION__MODE=sampling  # sampling/async_all/batch
RUNTIME_EVALUATION__SAMPLING_RATE=0.1  # 10%
RUNTIME_EVALUATION__METRICS=faithfulness,answer_relevancy
RUNTIME_EVALUATION__STORAGE_DIR=data/evaluation/runtime
RUNTIME_EVALUATION__BATCH_SIZE=10
RUNTIME_EVALUATION__BATCH_INTERVAL=300  # 5 minutes
```

#### è¯„ä¼°æŒ‡æ ‡ç¤ºä¾‹

```python
# è¿è¡Œæ—¶è¯„ä¼°ç»“æœ
{
    "query_id": "uuid",
    "question": "ç”¨æˆ·é—®é¢˜",
    "answer": "ç”Ÿæˆçš„ç­”æ¡ˆ",
    "contexts": ["æ£€ç´¢åˆ°çš„æ–‡æ¡£..."],
    "scores": {
        "faithfulness": 0.88,      # å¿ å®åº¦
        "answer_relevancy": 0.82   # ç­”æ¡ˆç›¸å…³æ€§
    },
    "metadata": {
        "conversation_id": "conv_id",
        "topic_id": "topic_id",
        "timestamp": "2024-11-18T..."
    }
}
```

#### å…³é”®æ–‡ä»¶

- `packages/rag-core/rag_core/evaluation/ragas_evaluator.py` - RAGAS è¯„ä¼°å™¨
- `packages/rag-core/rag_core/evaluation/runtime_evaluator.py` - è¿è¡Œæ—¶è¯„ä¼°å™¨
- `packages/rag-core/rag_core/evaluation/dataset.py` - æ•°æ®é›†ç®¡ç†
- `packages/rag-core/rag_core/chains/llm.py` - LLM å“åº”æ¸…ç†ï¼ˆç¬¬155-171è¡Œï¼‰
- `apps/api/app/routers/qa_stream.py` - è¯„ä¼°é›†æˆç‚¹
- `apps/api/app/routers/evaluation.py` - è¯„ä¼° API æ¥å£

---

### 6.5 ç”Ÿäº§ç¯å¢ƒé…ç½®

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **Docker åŒ–**
  ```dockerfile
  # Dockerfile
  FROM python:3.11-slim
  
  WORKDIR /app
  COPY . .
  
  RUN pip install uv && uv pip install --system -e .
  
  EXPOSE 8000
  CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
  ```

- [ ] **Docker Compose**
  ```yaml
  # docker-compose.yml
  services:
    api:
      build: .
      ports:
        - "8000:8000"
      environment:
        - OPENAI_API_KEY=${OPENAI_API_KEY}
      depends_on:
        - redis
    
    redis:
      image: redis:7-alpine
      ports:
        - "6379:6379"
  ```

- [ ] **ç¯å¢ƒå˜é‡ç®¡ç†**
  - åˆ›å»º `.env.example`
  - æ–‡æ¡£åŒ–æ‰€æœ‰ç¯å¢ƒå˜é‡
  - ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ secrets

- [ ] **å¥åº·æ£€æŸ¥å¢å¼º**
  - æ£€æŸ¥ LLM API è¿é€šæ€§
  - æ£€æŸ¥å‘é‡æ•°æ®åº“
  - æ£€æŸ¥ Redis
  - è¿”å›è¯¦ç»†çŠ¶æ€

- [ ] **é”™è¯¯å¤„ç†å®Œå–„**
  - å…¨å±€å¼‚å¸¸å¤„ç†
  - å‹å¥½çš„é”™è¯¯ä¿¡æ¯
  - é”™è¯¯è¿½è¸ª
  - è‡ªåŠ¨å‘Šè­¦

- [ ] **é™æµå’Œè®¤è¯**
  - API key è®¤è¯
  - åŸºäºç”¨æˆ·çš„é™æµ
  - IP é™æµ
  - é˜²æ­¢æ»¥ç”¨

- [ ] **éƒ¨ç½²æ–‡æ¡£**
  - éƒ¨ç½²æ­¥éª¤
  - ç¯å¢ƒè¦æ±‚
  - é…ç½®è¯´æ˜
  - æ•…éšœæ’æŸ¥

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥ Docker éƒ¨ç½²
- âœ… æœ‰å®Œæ•´çš„éƒ¨ç½²æ–‡æ¡£
- âœ… é”™è¯¯å¤„ç†è¦†ç›–å¸¸è§åœºæ™¯
- âœ… æœ‰é™æµå’Œè®¤è¯æœºåˆ¶
- âœ… å¥åº·æ£€æŸ¥å®Œå–„

#### æ–°å¢ä¾èµ–

```toml
slowapi>=0.1.9  # é™æµ
python-jose[cryptography]>=3.3.0  # JWT
passlib[bcrypt]>=1.7.4  # å¯†ç å“ˆå¸Œ
```

---

### Phase 6 äº¤ä»˜ç‰© âš ï¸

- âŒ **LangSmith å…¨é“¾è·¯è¿½è¸ª** - å¾…å®ç°
- âŒ **ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ** - å¾…å®ç°
- âŒ **Prometheus æŒ‡æ ‡æ”¶é›†** - å¾…å®ç°
- âœ… **è‡ªåŠ¨åŒ–è¯„ä¼°ç³»ç»Ÿ** - RAGAS + è¿è¡Œæ—¶è¯„ä¼°å·²å®Œæˆ
- âœ… **è¯„ä¼°æ•°æ®ç®¡ç†** - EvaluationDataset å·²å®ç°
- âœ… **è¯„ä¼°ç»“æœå­˜å‚¨** - JSONL æ ¼å¼æŒä¹…åŒ–
- âœ… **è¯„ä¼° API æ¥å£** - ç»Ÿè®¡å’Œç»“æœæŸ¥è¯¢
- âœ… **LLM å…¼å®¹æ€§** - Claude markdown JSON æ¸…ç†
- âœ… **ç”Ÿäº§å°±ç»ªé…ç½®** - åŸºç¡€å®Œæˆ
- âœ… **Docker éƒ¨ç½²æ”¯æŒ** - docker-compose.yml
- âš ï¸ **å®Œæ•´çš„éƒ¨ç½²æ–‡æ¡£** - éœ€è¦è¡¥å……

**æ€»ç»“**: Phase 6 è¯„ä¼°ç³»ç»Ÿå·²å®Œæˆ (55%)ï¼Œç›‘æ§å’Œè¿½è¸ªç³»ç»Ÿå¾…è¡¥å……ã€‚

---

## Phase 7 (å¯é€‰): é«˜çº§ç‰¹æ€§ (Week 10+)

**ğŸ¯ ç›®æ ‡**: å¢åŠ é«˜çº§åŠŸèƒ½ï¼Œæ»¡è¶³ç‰¹å®šåœºæ™¯éœ€æ±‚

**â±ï¸ é¢„è®¡æ—¶é—´**: å¯é€‰ï¼Œæ ¹æ®éœ€æ±‚

### 7.1 Agentic RAG

**ä¼˜å…ˆçº§**: â­â­ (å¯é€‰)  
**å·¥ä½œé‡**: 3-5 å¤©

#### åŠŸèƒ½è¯´æ˜

ä½¿ç”¨ Agent æ¨¡å¼è¿›è¡Œå¤æ‚æ¨ç†ï¼Œæ”¯æŒå·¥å…·è°ƒç”¨ã€‚

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»º Agent æ¨¡å—**
  ```
  rag/agents/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ react_agent.py         # ReAct agent
  â”œâ”€â”€ planning_agent.py      # è§„åˆ’ agent
  â””â”€â”€ tools/
      â”œâ”€â”€ search_tool.py
      â”œâ”€â”€ summarize_tool.py
      â”œâ”€â”€ compare_tool.py
      â””â”€â”€ calculator_tool.py
  ```

- [ ] **å®šä¹‰å·¥å…·**
  - è¯­ä¹‰æœç´¢å·¥å…·
  - æ–‡æ¡£æ€»ç»“å·¥å…·
  - æ–‡æ¡£å¯¹æ¯”å·¥å…·
  - è®¡ç®—å™¨å·¥å…·ï¼ˆå¯é€‰ï¼‰
  - Web æœç´¢å·¥å…·ï¼ˆå¯é€‰ï¼‰

- [ ] **ä½¿ç”¨ LangGraph æ„å»º Agent**
  - ReAct pattern
  - å·¥å…·è°ƒç”¨å¾ªç¯
  - æ€è€ƒé“¾è®°å½•

- [ ] **é›†æˆåˆ°è·¯ç”±ç³»ç»Ÿ**
  - å¤æ‚æŸ¥è¯¢è‡ªåŠ¨è·¯ç”±åˆ° Agent

#### é€‚ç”¨åœºæ™¯

- éœ€è¦å¤šæ­¥éª¤æ¨ç†
- éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·
- å¤æ‚çš„ç ”ç©¶ä»»åŠ¡
- éœ€è¦å¯¹æ¯”å’Œåˆ†æ

#### ç¤ºä¾‹

```python
# ç”¨æˆ·æŸ¥è¯¢ï¼š
"Compare RAG with fine-tuning, analyze their pros and cons, 
and recommend which one I should use for customer support"

# Agent æ‰§è¡Œæµç¨‹ï¼š
1. Search for "RAG"
2. Search for "fine-tuning"
3. Compare the two approaches
4. Analyze use case requirements
5. Generate recommendation
```

---

### 7.2 é«˜çº§æ£€ç´¢æŠ€æœ¯

**ä¼˜å…ˆçº§**: â­â­ (å¯é€‰)  
**å·¥ä½œé‡**: 2-3 å¤©/åŠŸèƒ½

#### åŠŸèƒ½åˆ—è¡¨

1. **çˆ¶å­æ–‡æ¡£æ£€ç´¢**
   - æ£€ç´¢å°å—ï¼ˆç²¾ç¡®ï¼‰
   - è¿”å›å¤§å—ï¼ˆä¸Šä¸‹æ–‡ï¼‰
   - æå‡ä¸Šä¸‹æ–‡å®Œæ•´æ€§

2. **æ—¶é—´æ„ŸçŸ¥æ£€ç´¢**
   - è€ƒè™‘æ–‡æ¡£æ—¶é—´
   - ä¼˜å…ˆè¿”å›æœ€æ–°ä¿¡æ¯
   - æ”¯æŒæ—¶é—´èŒƒå›´è¿‡æ»¤

3. **çŸ¥è¯†å›¾è°±å¢å¼º**
   - æ„å»ºå®ä½“å…³ç³»å›¾
   - å›¾è°±æ£€ç´¢
   - ç»“æ„åŒ–çŸ¥è¯†è¡¥å……

4. **å¤šæ¨¡æ€æ£€ç´¢**
   - å›¾ç‰‡ + æ–‡æœ¬æ£€ç´¢
   - CLIP embeddings
   - å¤šæ¨¡æ€èåˆ

#### é€‚ç”¨åœºæ™¯

- æ–‡æ¡£ç»“æ„å¤æ‚ï¼ˆçˆ¶å­æ–‡æ¡£ï¼‰
- éœ€è¦æœ€æ–°ä¿¡æ¯ï¼ˆæ—¶é—´æ„ŸçŸ¥ï¼‰
- æœ‰ç»“æ„åŒ–çŸ¥è¯†ï¼ˆçŸ¥è¯†å›¾è°±ï¼‰
- åŒ…å«å›¾ç‰‡ç­‰å¤šæ¨¡æ€æ•°æ®

---

### 7.3 å®æ—¶æ•°æ®æºé›†æˆ

**ä¼˜å…ˆçº§**: â­â­ (å¯é€‰)  
**å·¥ä½œé‡**: 3-4 å¤©

#### åŠŸèƒ½è¯´æ˜

é›†æˆå®æ—¶æ•°æ®æºï¼Œç¡®ä¿ä¿¡æ¯æœ€æ–°ã€‚

#### ä»»åŠ¡æ¸…å•

- [ ] **Web æœç´¢é›†æˆ**
  - Tavily API
  - Serper API
  - Bing Search API

- [ ] **API æ•°æ®æº**
  - REST API è°ƒç”¨
  - GraphQL æ”¯æŒ
  - æ•°æ®è½¬æ¢

- [ ] **å®æ—¶æ–°é—»æº**
  - RSS feeds
  - æ–°é—» API
  - è‡ªåŠ¨æ›´æ–°

- [ ] **åŠ¨æ€çŸ¥è¯†æ›´æ–°**
  - å¢é‡æ›´æ–°å‘é‡åº“
  - å»é‡å’Œç‰ˆæœ¬ç®¡ç†
  - è‡ªåŠ¨è§¦å‘é‡æ–°ç´¢å¼•

#### é€‚ç”¨åœºæ™¯

- éœ€è¦æœ€æ–°ä¿¡æ¯ï¼ˆæ–°é—»ã€è‚¡ç¥¨ç­‰ï¼‰
- çŸ¥è¯†åº“éœ€è¦å®æ—¶æ›´æ–°
- ç»“åˆé™æ€çŸ¥è¯†åº“å’ŒåŠ¨æ€æ•°æ®

#### æ–°å¢ä¾èµ–

```toml
tavily-python>=0.3.0  # Web æœç´¢
feedparser>=6.0.10  # RSS
```

---

## æœ€å°å¯è¡Œäº§å“ (MVP) è·¯å¾„

å¦‚æœæƒ³å¿«é€ŸéªŒè¯å’Œä¸Šçº¿ï¼Œå¯ä»¥é‡‡ç”¨ **MVP è·¯å¾„**ï¼š

### MVP = æ ¸å¿ƒåŠŸèƒ½ (4 å‘¨)

```
Week 1-2: Phase 1 å®Œæ•´
  âœ“ é…ç½®ç³»ç»Ÿ
  âœ“ çœŸå® LLM/Embeddings
  âœ“ æ¥å£æŠ½è±¡

Week 3: Phase 2 æ ¸å¿ƒéƒ¨åˆ†
  âœ“ Hybrid æ£€ç´¢ (Vector + BM25)
  âœ“ Cross-Encoder é‡æ’åº
  âœ“ åŸºç¡€æ–‡æ¡£å¤„ç†

Week 4: Phase 6 åŸºç¡€éƒ¨åˆ†
  âœ“ LangSmith é›†æˆ
  âœ“ åŸºç¡€æ—¥å¿—
  âœ“ Docker åŒ–
  âœ“ éƒ¨ç½²æ–‡æ¡£
```

### MVP åŠŸèƒ½åˆ—è¡¨

| åŠŸèƒ½ | çŠ¶æ€ | ä¼˜å…ˆçº§ |
|------|------|--------|
| **æ ¸å¿ƒ** |
| çœŸå® LLM (GPT-4) | â­â­â­â­â­ | å¿…é¡» |
| çœŸå® Embeddings | â­â­â­â­â­ | å¿…é¡» |
| æ··åˆæ£€ç´¢ | â­â­â­â­â­ | å¿…é¡» |
| Cross-Encoder é‡æ’åº | â­â­â­â­ | é‡è¦ |
| åŸºç¡€é…ç½®ç³»ç»Ÿ | â­â­â­â­â­ | å¿…é¡» |
| **å¯è§‚æµ‹æ€§** |
| LangSmith è¿½è¸ª | â­â­â­â­â­ | å¿…é¡» |
| ç»“æ„åŒ–æ—¥å¿— | â­â­â­â­ | é‡è¦ |
| åŸºç¡€æŒ‡æ ‡ | â­â­â­ | ä¸­ç­‰ |
| **éƒ¨ç½²** |
| Docker åŒ– | â­â­â­â­ | é‡è¦ |
| å¥åº·æ£€æŸ¥ | â­â­â­â­ | é‡è¦ |
| éƒ¨ç½²æ–‡æ¡£ | â­â­â­â­ | é‡è¦ |

### åç»­è¿­ä»£

MVP ä¸Šçº¿åï¼Œæ ¹æ®ç”¨æˆ·åé¦ˆé€æ­¥æ·»åŠ ï¼š

- **Iteration 1** (Week 5-6): æŸ¥è¯¢å¢å¼º + æµå¼è¾“å‡º
- **Iteration 2** (Week 7): å¯¹è¯è®°å¿† + ç¼“å­˜
- **Iteration 3** (Week 8-9): å®Œæ•´å¯è§‚æµ‹æ€§ + è¯„ä¼°ç³»ç»Ÿ

---

## å®æ–½å»ºè®®

### 1. æ¯ä¸ª Phase ç»“æŸåçš„éªŒè¯

#### éªŒè¯æ¸…å•

- [ ] **åŠŸèƒ½æµ‹è¯•**
  - å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 70%
  - é›†æˆæµ‹è¯•é€šè¿‡
  - æ‰‹åŠ¨æµ‹è¯•å¸¸è§åœºæ™¯

- [ ] **æ€§èƒ½æµ‹è¯•**
  - å»¶è¿ŸåŸºå‡†æµ‹è¯•
  - å¹¶å‘æµ‹è¯•
  - èµ„æºä½¿ç”¨ç›‘æ§

- [ ] **è´¨é‡è¯„ä¼°**
  - åœ¨è¯„ä¼°æ•°æ®é›†ä¸Šè¿è¡Œ
  - å¯¹æ¯”ä¹‹å‰ç‰ˆæœ¬
  - è®°å½•æ”¹è¿›å¹…åº¦

- [ ] **æ–‡æ¡£æ›´æ–°**
  - API æ–‡æ¡£
  - é…ç½®æ–‡æ¡£
  - éƒ¨ç½²æ–‡æ¡£

---

### 2. æŒç»­æ”¹è¿›æµç¨‹

```
æ”¶é›†æ•°æ® â†’ åˆ†æé—®é¢˜ â†’ æå‡ºæ”¹è¿› â†’ å®æ–½ â†’ è¯„ä¼° â†’ å¾ªç¯
    â†‘                                           â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ•°æ®æ”¶é›†

- ç”¨æˆ·æŸ¥è¯¢æ—¥å¿—
- æ€§èƒ½æŒ‡æ ‡
- é”™è¯¯æ—¥å¿—
- ç”¨æˆ·åé¦ˆ

#### åˆ†ææ–¹æ³•

- æŸ¥æ‰¾é«˜é¢‘å¤±è´¥æŸ¥è¯¢
- è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼
- A/B æµ‹è¯•ç»“æœ

#### æ”¹è¿›æ–¹å‘

- Prompt ä¼˜åŒ–
- æ£€ç´¢å‚æ•°è°ƒä¼˜
- æ¨¡å‹å‡çº§
- ç¼“å­˜ç­–ç•¥ä¼˜åŒ–

---

### 3. æŠ€æœ¯å€ºåŠ¡ç®¡ç†

#### ä¼˜å…ˆçº§åŸåˆ™

1. **åŠŸèƒ½ > æ€§èƒ½ > ä¼˜é›…**ï¼ˆæ—©æœŸé˜¶æ®µï¼‰
2. **å¯ç”¨ > å®Œç¾**ï¼ˆMVP é˜¶æ®µï¼‰
3. **å¿«é€Ÿè¿­ä»£ > ä¸€æ¬¡åˆ°ä½**

#### æŠ€æœ¯å€ºåŠ¡è¿½è¸ª

åœ¨ä»£ç ä¸­æ ‡è®° TODO å’Œ FIXMEï¼š

```python
# TODO(Phase 7): å®ç°æ›´å¤æ‚çš„æŸ¥è¯¢åˆ†è§£
# FIXME: è¿™é‡Œéœ€è¦ä¼˜åŒ–æ€§èƒ½ï¼Œå½“å‰å¤ªæ…¢
# DEBT: ä¸´æ—¶æ–¹æ¡ˆï¼Œéœ€è¦é‡æ„ä¸ºå·¥å‚æ¨¡å¼
```

å®šæœŸå›é¡¾å’Œå¿è¿˜æŠ€æœ¯å€ºï¼š

- æ¯ä¸ª Sprint é¢„ç•™ 20% æ—¶é—´
- ä¼˜å…ˆå¿è¿˜å½±å“å¤§çš„å€ºåŠ¡
- é‡æ„å‰åå¯¹æ¯”æ•ˆæœ

---

### 4. å›¢é˜Ÿåä½œ

#### Git åˆ†æ”¯ç­–ç•¥

```
main (ç”Ÿäº§)
  â†‘
develop (å¼€å‘)
  â†‘
feature/phase-1-config (åŠŸèƒ½åˆ†æ”¯)
feature/phase-2-retrieval
...
```

#### Code Review æ¸…å•

- [ ] ä»£ç ç¬¦åˆæ¥å£è§„èŒƒ
- [ ] æœ‰å•å…ƒæµ‹è¯•
- [ ] æœ‰æ–‡æ¡£æ³¨é‡Š
- [ ] æ€§èƒ½å½±å“å¯æ¥å—
- [ ] é”™è¯¯å¤„ç†å®Œå–„

#### çŸ¥è¯†åˆ†äº«

- æ¯å‘¨æŠ€æœ¯åˆ†äº«ä¼š
- æ–‡æ¡£åŒæ­¥æ›´æ–°
- é‡è¦å†³ç­–è®°å½• (ADR)

---

## å…³é”®æˆåŠŸæŒ‡æ ‡ (KPI)

### Phase çº§åˆ« KPI

| Phase | å…³é”®æŒ‡æ ‡ | åŸºçº¿ | ç›®æ ‡ | è¡¡é‡æ–¹æ³• |
|-------|---------|------|------|---------|
| **Phase 1** | é…ç½®è¦†ç›–ç‡ | 0% | 100% | é…ç½®é¡¹æ•°é‡ / æ€»éœ€æ±‚ |
| | LLM é›†æˆæˆåŠŸç‡ | - | > 99% | æˆåŠŸè°ƒç”¨ / æ€»è°ƒç”¨ |
| | å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | 50% | > 70% | pytest-cov |
| **Phase 2** | æ£€ç´¢ Recall@5 | 70% | > 85% | è¯„ä¼°æ•°æ®é›† |
| | æ£€ç´¢å»¶è¿Ÿ P95 | 1s | < 500ms | Prometheus |
| | é‡æ’åºæå‡ | 0% | +15% | Top-3 å‡†ç¡®ç‡ |
| **Phase 3** | è·¯ç”±å‡†ç¡®ç‡ | - | > 90% | æ‰‹åŠ¨æ ‡æ³¨ |
| | æŸ¥è¯¢ç†è§£å‡†ç¡®ç‡ | - | > 85% | æµ‹è¯•é›† |
| | è·¯ç”±å»¶è¿Ÿ | - | < 100ms | è®¡æ—¶ |
| **Phase 4** | ç­”æ¡ˆè´¨é‡è¯„åˆ† | 3.5/5 | > 4.0/5 | äººå·¥è¯„åˆ† |
| | å¹»è§‰ç‡ | 20% | < 10% | è‡ªåŠ¨æ£€æµ‹ |
| | æµå¼é¦–å­—å»¶è¿Ÿ | - | < 1s | è®¡æ—¶ |
| **Phase 5** | å¯¹è¯è¿è´¯æ€§ | - | > 4.0/5 | äººå·¥è¯„åˆ† |
| | ç¼“å­˜å‘½ä¸­ç‡ | 0% | > 50% | cache_hit / total |
| | æˆæœ¬èŠ‚çœ | 0% | > 30% | token ç»Ÿè®¡ |
| **Phase 6** | æœåŠ¡å¯ç”¨æ€§ | - | > 99.5% | uptime / total |
| | ç›‘æ§è¦†ç›–ç‡ | 0% | 100% | å…³é”®è·¯å¾„ |
| | éƒ¨ç½²æˆåŠŸç‡ | - | 100% | CI/CD |

### ç«¯åˆ°ç«¯ KPI (ç”Ÿäº§ç¯å¢ƒ)

| ç±»åˆ« | æŒ‡æ ‡ | ç›®æ ‡ | ç›‘æ§æ–¹å¼ |
|------|------|------|---------|
| **æ€§èƒ½** | ç«¯åˆ°ç«¯å»¶è¿Ÿ P95 | < 3s | Prometheus |
| | é¦–å­—å»¶è¿Ÿ P95 (æµå¼) | < 1s | Prometheus |
| | QPS (æ¯ç§’æŸ¥è¯¢) | > 100 | Load test |
| **è´¨é‡** | ç­”æ¡ˆå‡†ç¡®ç‡ | > 85% | RAGAS |
| | å¹»è§‰ç‡ | < 10% | è‡ªåŠ¨æ£€æµ‹ |
| | ç”¨æˆ·æ»¡æ„åº¦ | > 4.0/5 | åé¦ˆ |
| **å¯é æ€§** | æœåŠ¡å¯ç”¨æ€§ | > 99.5% | ç›‘æ§ |
| | é”™è¯¯ç‡ | < 1% | æ—¥å¿— |
| | P99 å»¶è¿Ÿ | < 5s | Prometheus |
| **æˆæœ¬** | æ¯æŸ¥è¯¢æˆæœ¬ | < $0.05 | è®¡è´¹ |
| | ç¼“å­˜å‘½ä¸­ç‡ | > 60% | Redis |
| | Token ä½¿ç”¨æ•ˆç‡ | - | ç»Ÿè®¡ |

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### æœ¬å‘¨ (Week 1) - å¯åŠ¨ Phase 1

#### Day 1-2: ç¯å¢ƒå‡†å¤‡

- [ ] **æ³¨å†Œè´¦å·**
  - [ ] OpenAI API key
  - [ ] LangSmith è´¦å·
  - [ ] (å¯é€‰) Anthropic API key

- [ ] **åˆ›å»ºé…ç½®æ–‡ä»¶**
  ```bash
  cp .env.example .env
  # å¡«å†™ API keys
  ```

- [ ] **æµ‹è¯• API è¿é€šæ€§**
  ```python
  from openai import OpenAI
  client = OpenAI()
  response = client.chat.completions.create(
      model="gpt-4-turbo-preview",
      messages=[{"role": "user", "content": "Hello"}]
  )
  print(response.choices[0].message.content)
  ```

#### Day 3-5: æ ¸å¿ƒé›†æˆ

- [ ] **æ›¿æ¢ FakeEmbeddings**
  - [ ] å®ç° OpenAI Embeddings
  - [ ] æµ‹è¯• embedding ç”Ÿæˆ
  - [ ] æ›´æ–°å‘é‡å­˜å‚¨

- [ ] **æ›¿æ¢ FakeLLM**
  - [ ] å®ç° OpenAI LLM
  - [ ] æµ‹è¯•é—®ç­”æµç¨‹
  - [ ] éªŒè¯ç­”æ¡ˆè´¨é‡

- [ ] **æ·»åŠ é”™è¯¯å¤„ç†**
  - [ ] API è°ƒç”¨é‡è¯•
  - [ ] è¶…æ—¶å¤„ç†
  - [ ] é”™è¯¯æ—¥å¿—

#### Day 6-7: é…ç½®ç³»ç»Ÿ

- [ ] **é‡æ„é…ç½®**
  - [ ] åˆ›å»ºé…ç½®æ¨¡å—
  - [ ] ä½¿ç”¨ Pydantic Settings
  - [ ] ç¯å¢ƒå˜é‡æ”¯æŒ

- [ ] **æµ‹è¯•ç«¯åˆ°ç«¯**
  - [ ] è¿è¡Œå®Œæ•´æµç¨‹
  - [ ] éªŒæ”¶ Phase 1

---

### ä¸‹å‘¨ (Week 2) - å®Œæˆ Phase 1

- [ ] **æ¥å£æŠ½è±¡**
  - [ ] å®šä¹‰æ ¸å¿ƒæ¥å£
  - [ ] åˆ›å»ºå·¥å‚ç±»
  - [ ] é‡æ„ç°æœ‰ä»£ç 

- [ ] **å•å…ƒæµ‹è¯•**
  - [ ] æµ‹è¯•è¦†ç›–ç‡ > 70%
  - [ ] CI/CD é›†æˆ

- [ ] **æ–‡æ¡£æ›´æ–°**
  - [ ] é…ç½®æ–‡æ¡£
  - [ ] API æ–‡æ¡£
  - [ ] éƒ¨ç½²æŒ‡å—

---

### Week 3-4: Phase 2 å®æ–½

å‚è€ƒä¸Šé¢ Phase 2 è¯¦ç»†è®¡åˆ’ã€‚

---

## èµ„æºå’Œå‚è€ƒ

### å­¦ä¹ èµ„æº

- [LangChain æ–‡æ¡£](https://python.langchain.com/)
- [LangGraph æ–‡æ¡£](https://langchain-ai.github.io/langgraph/)
- [LangSmith æ–‡æ¡£](https://docs.smith.langchain.com/)
- [RAG æœ€ä½³å®è·µ](https://github.com/langchain-ai/langchain/discussions)

### å·¥å…·å’Œåº“

- **LLM**: OpenAI, Anthropic, Ollama
- **Embeddings**: OpenAI, HuggingFace, sentence-transformers
- **Vector DB**: FAISS, Weaviate, Qdrant, Pinecone
- **Observability**: LangSmith, Prometheus, Grafana
- **Evaluation**: RAGAS, LangSmith Evaluation

### ç¤¾åŒº

- [LangChain Discord](https://discord.gg/langchain)
- [LangChain GitHub](https://github.com/langchain-ai/langchain)
- [r/LangChain](https://reddit.com/r/LangChain)

---

## æ€»ç»“

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€å¯æ‰§è¡Œçš„è·¯çº¿å›¾ï¼Œä»åŸºç¡€è®¾æ–½åˆ°ç”Ÿäº§çº§ RAG ç³»ç»Ÿã€‚

### å…³é”®æˆåŠŸå› ç´ 

1. â­ **æ¸è¿›å¼å®æ–½** - æ¯ä¸ª Phase éƒ½å¯ç‹¬ç«‹äº¤ä»˜
2. â­ **è´¨é‡ä¼˜å…ˆ** - æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†
3. â­ **æ•°æ®é©±åŠ¨** - é€šè¿‡æŒ‡æ ‡è¯„ä¼°å’Œä¼˜åŒ–
4. â­ **æŒç»­æ”¹è¿›** - æ ¹æ®åé¦ˆå¿«é€Ÿè¿­ä»£

### æ—¶é—´çº¿æ€»ç»“

- **MVP (4 å‘¨)**: æ ¸å¿ƒåŠŸèƒ½ + åŸºç¡€å¯è§‚æµ‹æ€§
- **å®Œæ•´ç‰ˆ (8-9 å‘¨)**: ç”Ÿäº§çº§ RAG ç³»ç»Ÿ
- **é«˜çº§ç‰ˆ (10+ å‘¨)**: åŒ…å« Agentic RAG ç­‰é«˜çº§ç‰¹æ€§

### æœ€åçš„å»ºè®®

**ä¸è¦è¯•å›¾ä¸€æ¬¡åšå®Œæ‰€æœ‰äº‹æƒ…ï¼**

ä» MVP å¼€å§‹ï¼Œå¿«é€ŸéªŒè¯ï¼Œæ ¹æ®å®é™…éœ€æ±‚é€æ­¥å¢å¼ºã€‚

---

## ğŸ¯ å½“å‰ä¼˜å…ˆçº§å»ºè®®ï¼ˆåŸºäºå®é™…çŠ¶æ€ï¼‰

æ ¹æ®æœ¬æ¬¡è¯„ä¼°ï¼Œå»ºè®®æŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§æ¨è¿›ï¼š

### ğŸ”´ é«˜ä¼˜å…ˆçº§ï¼ˆ2-3å‘¨ï¼‰â€” æ¨¡å—åŒ–å¯¹é½

1. **Capture Hub MVP**  
   - è½åœ°æ–‡ä»¶/ç½‘é¡µ/å¯¹è¯/æµè§ˆå™¨ Connector  
   - è‡ªåŠ¨è§£æã€åˆ†ç±»ã€è´¨é‡è¯„åˆ†é¢æ¿

2. **Insight Forge åŸºç¡€ç‰ˆ**  
   - AI çŸ¥è¯†å¡ç‰‡ã€æ‘˜è¦/è§‚ç‚¹å¯¹æ¯”  
   - ä¸ªäºº/å›¢é˜Ÿè¯­å¢ƒç‰ˆæœ¬ç®¡ç†

3. **Action Engine æ£€ç´¢å‡çº§**  
   - æ··åˆæ£€ç´¢ï¼ˆBM25+Vectorï¼‰+ Cross-Encoder é‡æ’  
   - å¤šæŸ¥è¯¢ç­–ç•¥ã€å›ç­”å¼•ç”¨é“¾è·¯

4. **Observability Backbone**  
   - LangSmith tracingã€ç»“æ„åŒ–æ—¥å¿—ã€Prometheus æŒ‡æ ‡  
   - ä¸ Runtime Evaluation æ•°æ®æ‰“é€š

5. **Graph Studio MVP**  
   - åŠ¨æ€å›¾è°±æ¸²æŸ“ã€èŠ‚ç‚¹äº¤äº’ã€ç›²ç‚¹æç¤ºã€å¯¼å‡ºåˆ†äº«

**æ³¨**: ~~è¯„ä¼°æ¡†æ¶å»ºè®¾~~ å·²å®Œæˆ âœ… (2025-11-18)

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ï¼ˆ3-4å‘¨ï¼‰

6. **Capture Hub æ‰©å±•**ï¼šé‚®ä»¶/ä¼šè®®çºªè¦æ¥å…¥ã€é‡‡é›†ä»»åŠ¡é˜Ÿåˆ—  
7. **Insight Forge Plus**ï¼šå­¦ä¹ è·¯å¾„ã€çŸ¥è¯†å†²çªæ£€æµ‹ã€è‡ªæˆ‘çº å  
8. **Action Engine æ¨¡æ¿åŒ–**ï¼šåœºæ™¯åŒ– Playbookã€Workflow è§¦å‘ã€ç»“æœæ¨¡æ¿  
9. **Graph Studio Plus**ï¼šè·¨ä¸»é¢˜å…³è”ã€AI å¯¼èˆªã€æ—¶é—´è½´å›æ”¾  
10. **è¯„ä¼°æŠ¥å‘Šè‡ªåŠ¨åŒ–**ï¼šruntime evaluation â†’ å‘¨/æœˆæŠ¥ & æ”¹è¿›å»ºè®®

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ï¼ˆæŒ‰éœ€ï¼‰

11. Agentic RAG / Toolformer èƒ½åŠ›  
12. çŸ¥è¯†å›¾è°±å¤šæ¨¡æ€ï¼ˆå›¾ç‰‡/éŸ³é¢‘ï¼‰  
13. è‡ªåŠ¨åŒ–çŸ¥è¯†è¿è¥ï¼ˆç¼ºå£æé†’ã€ä»»åŠ¡æ´¾å‘ï¼‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: 2.1  
**æœ€åæ›´æ–°**: 2025-11-18  
**ç»´æŠ¤è€…**: Research Agent Team

**å½“å‰çŠ¶æ€**: âœ… æ ¸å¿ƒRAGåŠŸèƒ½ã€å¯¹è¯ç³»ç»Ÿå’Œè¯„ä¼°ç³»ç»Ÿå·²å¯ç”¨ï¼Œå»ºè®®ä¼˜å…ˆè¡¥å……æ£€ç´¢å¢å¼ºå’Œç›‘æ§åŠŸèƒ½ã€‚ ğŸš€

**æœ€æ–°è¿›å±•** ğŸ‰:
- âœ… 2025-11-18: å®Œæˆ RAGAS è¯„ä¼°ç³»ç»Ÿé›†æˆå’Œè¿è¡Œæ—¶è¯„ä¼°åŠŸèƒ½
- âœ… 2025-11-18: è§£å†³ Claude LLM markdown JSON å…¼å®¹æ€§é—®é¢˜
- âœ… 2025-11-18: å®ç°è¯„ä¼°ç»“æœæŒä¹…åŒ–å’Œ API æ¥å£
- âœ… 2025-11-18: æ–°å¢ç»Ÿä¸€ UI è®¾è®¡è§„èŒƒæ–‡ä»¶ `design/design-system.json`ï¼ˆå¯¹é½ docs/ux/design.json ä¸ design-system-showcaseï¼Œç”¨äºæŒ‡å¯¼åç»­æ‰€æœ‰å‰ç«¯ç‰¹æ€§å’Œ Agent ç”Ÿæˆå¼æ”¹åŠ¨ï¼‰

