# Generic RAG ç³»ç»Ÿå®æ–½è·¯çº¿å›¾

## ğŸ“‹ ç›®å½•

- [å½“å‰çŠ¶æ€è¯„ä¼°](#å½“å‰çŠ¶æ€è¯„ä¼°)
- [å®æ–½è·¯çº¿å›¾æ€»è§ˆ](#å®æ–½è·¯çº¿å›¾æ€»è§ˆ)
- [è¯¦ç»†å®æ–½è®¡åˆ’](#è¯¦ç»†å®æ–½è®¡åˆ’)
  - [Phase 1: æ ¸å¿ƒåŸºç¡€è®¾æ–½](#phase-1-æ ¸å¿ƒåŸºç¡€è®¾æ–½-week-1-2)
  - [Phase 2: å¢å¼ºæ£€ç´¢èƒ½åŠ›](#phase-2-å¢å¼ºæ£€ç´¢èƒ½åŠ›-week-3-4)
  - [Phase 3: æŸ¥è¯¢ç†è§£ä¸è·¯ç”±](#phase-3-æŸ¥è¯¢ç†è§£ä¸è·¯ç”±-week-5)
  - [Phase 4: ç”Ÿæˆå¢å¼ºä¸éªŒè¯](#phase-4-ç”Ÿæˆå¢å¼ºä¸éªŒè¯-week-6)
  - [Phase 5: å¯¹è¯ä¸è®°å¿†](#phase-5-å¯¹è¯ä¸è®°å¿†-week-7)
  - [Phase 6: å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ–](#phase-6-å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ–-week-8-9)
  - [Phase 7: é«˜çº§ç‰¹æ€§](#phase-7-å¯é€‰-é«˜çº§ç‰¹æ€§-week-10)
- [æœ€å°å¯è¡Œäº§å“ (MVP) è·¯å¾„](#æœ€å°å¯è¡Œäº§å“-mvp-è·¯å¾„)
- [å®æ–½å»ºè®®](#å®æ–½å»ºè®®)
- [å…³é”®æˆåŠŸæŒ‡æ ‡](#å…³é”®æˆåŠŸæŒ‡æ ‡-kpi)
- [ä¸‹ä¸€æ­¥è¡ŒåŠ¨](#ä¸‹ä¸€æ­¥è¡ŒåŠ¨)

---

## ğŸ“Š å½“å‰çŠ¶æ€è¯„ä¼°

### âœ… å·²å®Œæˆ

- âœ“ FastAPI åŸºç¡€æ¶æ„
- âœ“ LangChain + LangGraph åŸºæœ¬é›†æˆ
- âœ“ ç®€å•çš„æ–‡æ¡£å…¥åº“æµç¨‹
- âœ“ åŸºç¡€çš„ QA åŠŸèƒ½ï¼ˆFAISS + FakeEmbeddingsï¼‰
- âœ“ é¡¹ç›®ç»“æ„å’Œæµ‹è¯•æ¡†æ¶
- âœ“ ä½¿ç”¨ uv è¿›è¡Œä¾èµ–ç®¡ç†
- âœ“ åŸºç¡€çš„å¥åº·æ£€æŸ¥æ¥å£

### âŒ éœ€è¦æ”¹è¿›

- âš ï¸ ä½¿ç”¨çœŸå®çš„ LLM å’Œ Embeddingsï¼ˆå½“å‰æ˜¯ Fakeï¼‰
- âš ï¸ ç¼ºå°‘æ™ºèƒ½è·¯ç”±æœºåˆ¶
- âš ï¸ ç¼ºå°‘é‡æ’åºåŠŸèƒ½
- âš ï¸ ç¼ºå°‘æŸ¥è¯¢å¢å¼ºæŠ€æœ¯
- âš ï¸ ç¼ºå°‘å¯¹è¯è®°å¿†ç®¡ç†
- âš ï¸ ç¼ºå°‘å…¨é“¾è·¯å¯è§‚æµ‹æ€§
- âš ï¸ ç¼ºå°‘ç”Ÿäº§çº§é…ç½®ç®¡ç†
- âš ï¸ ç¼ºå°‘ç¼“å­˜æœºåˆ¶
- âš ï¸ ç¼ºå°‘è‡ªåŠ¨åŒ–è¯„ä¼°ç³»ç»Ÿ

---

## ğŸ¯ å®æ–½è·¯çº¿å›¾æ€»è§ˆ

```mermaid
gantt
    title Generic RAG ç³»ç»Ÿå®æ–½æ—¶é—´çº¿
    dateFormat YYYY-MM-DD
    section Phase 1: æ ¸å¿ƒåŸºç¡€è®¾æ–½
    é…ç½®ç³»ç»Ÿé‡æ„           :p1_1, 2025-01-01, 3d
    é›†æˆçœŸå®LLM            :p1_2, after p1_1, 3d
    æ¥å£æŠ½è±¡              :p1_3, after p1_2, 2d
    
    section Phase 2: å¢å¼ºæ£€ç´¢
    å¤šç§æ£€ç´¢ç­–ç•¥           :p2_1, after p1_3, 4d
    æ–‡æ¡£åå¤„ç†            :p2_2, after p2_1, 2d
    é‡æ’åºå®ç°            :p2_3, after p2_2, 3d
    
    section Phase 3: æŸ¥è¯¢ç†è§£
    æŸ¥è¯¢é¢„å¤„ç†            :p3_1, after p2_3, 2d
    æŸ¥è¯¢è½¬æ¢              :p3_2, after p3_1, 3d
    æ™ºèƒ½è·¯ç”±              :p3_3, after p3_2, 2d
    
    section Phase 4: ç”Ÿæˆå¢å¼º
    Promptå·¥ç¨‹            :p4_1, after p3_3, 2d
    æµå¼è¾“å‡º              :p4_2, after p4_1, 2d
    è‡ªæˆ‘çº æ­£              :p4_3, after p4_2, 3d
    
    section Phase 5: å¯¹è¯è®°å¿†
    å¯¹è¯è®°å¿†å®ç°           :p5_1, after p4_3, 3d
    Conversational RAG    :p5_2, after p5_1, 2d
    ç¼“å­˜ç³»ç»Ÿ              :p5_3, after p5_2, 2d
    
    section Phase 6: ç”Ÿäº§åŒ–
    LangSmithé›†æˆ         :p6_1, after p5_3, 2d
    ç»“æ„åŒ–æ—¥å¿—            :p6_2, after p6_1, 1d
    æŒ‡æ ‡æ”¶é›†              :p6_3, after p6_2, 2d
    è¯„ä¼°ç³»ç»Ÿ              :p6_4, after p6_3, 3d
    ç”Ÿäº§ç¯å¢ƒé…ç½®           :p6_5, after p6_4, 3d
```

### æ—¶é—´çº¿æ¦‚è§ˆ

| Phase | åç§° | å‘¨æœŸ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|-------|------|------|--------|------|
| **Phase 1** | æ ¸å¿ƒåŸºç¡€è®¾æ–½ | Week 1-2 | â­â­â­â­â­ | ğŸ”´ å¾…å¼€å§‹ |
| **Phase 2** | å¢å¼ºæ£€ç´¢èƒ½åŠ› | Week 3-4 | â­â­â­â­â­ | ğŸ”´ å¾…å¼€å§‹ |
| **Phase 3** | æŸ¥è¯¢ç†è§£ä¸è·¯ç”± | Week 5 | â­â­â­â­ | ğŸ”´ å¾…å¼€å§‹ |
| **Phase 4** | ç”Ÿæˆå¢å¼ºä¸éªŒè¯ | Week 6 | â­â­â­â­ | ğŸ”´ å¾…å¼€å§‹ |
| **Phase 5** | å¯¹è¯ä¸è®°å¿† | Week 7 | â­â­â­â­ | ğŸ”´ å¾…å¼€å§‹ |
| **Phase 6** | å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ– | Week 8-9 | â­â­â­â­â­ | ğŸ”´ å¾…å¼€å§‹ |
| **Phase 7** | é«˜çº§ç‰¹æ€§ (å¯é€‰) | Week 10+ | â­â­ | ğŸ”´ å¾…å¼€å§‹ |

**æ€»è®¡**: 8-9 å‘¨è¾¾åˆ°ç”Ÿäº§çº§åˆ«ï¼Œ10+ å‘¨åŒ…å«é«˜çº§ç‰¹æ€§

---

## è¯¦ç»†å®æ–½è®¡åˆ’

## Phase 1: æ ¸å¿ƒåŸºç¡€è®¾æ–½ (Week 1-2)

**ğŸ¯ ç›®æ ‡**: å»ºç«‹åšå®çš„åŸºç¡€æ¶æ„ï¼Œæ”¯æŒåç»­æ‰©å±•

**â±ï¸ é¢„è®¡æ—¶é—´**: 2 å‘¨ (8-10 å·¥ä½œæ—¥)

### 1.1 é‡æ„é…ç½®ç³»ç»Ÿ

**ä¼˜å…ˆçº§**: â­â­â­â­â­ (å¿…é¡»)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºåˆ†å±‚é…ç½®ç»“æ„**
  ```
  rag/config/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base_config.py              # åŸºç¡€é…ç½®ç±»
  â”œâ”€â”€ retriever_config.py         # æ£€ç´¢å™¨é…ç½®
  â”œâ”€â”€ reranker_config.py          # é‡æ’åºé…ç½®
  â”œâ”€â”€ generator_config.py         # ç”Ÿæˆå™¨é…ç½®
  â”œâ”€â”€ cache_config.py             # ç¼“å­˜é…ç½®
  â”œâ”€â”€ observability_config.py     # å¯è§‚æµ‹æ€§é…ç½®
  â””â”€â”€ rag_pipeline_config.py      # Pipeline æ€»é…ç½®
  ```

- [ ] **ä½¿ç”¨ Pydantic Settings ç®¡ç†é…ç½®**
  - åˆ›å»º `BaseSettings` ç»§æ‰¿
  - æ”¯æŒ `.env` æ–‡ä»¶åŠ è½½
  - æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
  - æ·»åŠ é…ç½®éªŒè¯å’Œé»˜è®¤å€¼

- [ ] **åˆ›å»ºé…ç½®å·¥å‚**
  - æ”¯æŒä¸åŒç¯å¢ƒé…ç½®ï¼ˆdev/staging/prodï¼‰
  - é…ç½®çƒ­åŠ è½½ï¼ˆå¯é€‰ï¼‰

- [ ] **æ·»åŠ é…ç½®æ–‡æ¡£**
  - æ‰€æœ‰é…ç½®é¡¹çš„è¯´æ˜
  - ç¤ºä¾‹é…ç½®æ–‡ä»¶

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶åˆ‡æ¢ä¸åŒçš„æ£€ç´¢ç­–ç•¥
- âœ… ç¯å¢ƒå˜é‡å¯ä»¥è¦†ç›–é»˜è®¤é…ç½®
- âœ… é…ç½®é”™è¯¯æœ‰æ¸…æ™°çš„é”™è¯¯æç¤º
- âœ… æœ‰å®Œæ•´çš„é…ç½®æ–‡æ¡£

#### ä¾èµ–é¡¹

```toml
# æ–°å¢ä¾èµ–
pydantic-settings>=2.3.0
python-dotenv>=1.0.1
```

---

### 1.2 é›†æˆçœŸå®çš„ LLM å’Œ Embeddings

**ä¼˜å…ˆçº§**: â­â­â­â­â­ (å¿…é¡»)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **æ›¿æ¢ FakeEmbeddings**
  - é›†æˆ OpenAI Embeddings
  - é›†æˆ HuggingFace Embeddingsï¼ˆå¤‡é€‰ï¼‰
  - æ”¯æŒæœ¬åœ° Embeddingsï¼ˆsentence-transformersï¼‰
  - æ·»åŠ  Embeddings ç¼“å­˜

- [ ] **æ›¿æ¢ FakeLLM**
  - é›†æˆ OpenAI (GPT-4/GPT-3.5)
  - é›†æˆ Anthropic Claudeï¼ˆå¯é€‰ï¼‰
  - æ”¯æŒæœ¬åœ° LLMï¼ˆOllamaï¼Œå¯é€‰ï¼‰
  - å®ç° LLM å·¥å‚æ¨¡å¼

- [ ] **API Key ç®¡ç†**
  - ç¯å¢ƒå˜é‡ç®¡ç† API keys
  - æ”¯æŒå¤šä¸ª API key è½®æ¢
  - API key éªŒè¯

- [ ] **å®ç°é”™è¯¯å¤„ç†å’Œé‡è¯•**
  - API è°ƒç”¨é‡è¯•æœºåˆ¶ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
  - è¶…æ—¶å¤„ç†
  - é™æµå¤„ç†
  - é”™è¯¯æ—¥å¿—è®°å½•

- [ ] **æˆæœ¬è¿½è¸ª**
  - Token è®¡æ•°
  - æˆæœ¬ä¼°ç®—
  - ä½¿ç”¨ç»Ÿè®¡

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥æ­£å¸¸è°ƒç”¨ OpenAI API ç”Ÿæˆ embeddings
- âœ… QA è¿”å›æœ‰æ„ä¹‰çš„ç­”æ¡ˆï¼ˆä¸æ˜¯ placeholderï¼‰
- âœ… API è°ƒç”¨å¤±è´¥æœ‰é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
- âœ… æˆæœ¬è¿½è¸ªè®°å½•æ¯æ¬¡è°ƒç”¨çš„ token ä½¿ç”¨

#### æ–°å¢ä¾èµ–

```toml
openai>=1.0.0
langchain-openai>=0.1.0
sentence-transformers>=2.2.0  # å¯é€‰
anthropic>=0.18.0  # å¯é€‰
tenacity>=8.0.0  # é‡è¯•åº“
```

#### é…ç½®ç¤ºä¾‹

```python
# .env
OPENAI_API_KEY=sk-xxx
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_LLM_MODEL=gpt-4-turbo-preview
OPENAI_MAX_RETRIES=3
OPENAI_TIMEOUT=30
```

---

### 1.3 å»ºç«‹æ ¸å¿ƒæ¥å£æŠ½è±¡

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºæ ¸å¿ƒæ¥å£**
  ```
  rag/core/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ interfaces.py          # æ‰€æœ‰æ¥å£å®šä¹‰
  â”œâ”€â”€ models.py              # æ•°æ®æ¨¡å‹
  â”œâ”€â”€ exceptions.py          # è‡ªå®šä¹‰å¼‚å¸¸
  â””â”€â”€ constants.py           # å¸¸é‡å®šä¹‰
  ```

- [ ] **å®šä¹‰æ¥å£**
  - `RetrieverInterface`: æ£€ç´¢å™¨æ¥å£
  - `RerankerInterface`: é‡æ’åºå™¨æ¥å£
  - `GeneratorInterface`: ç”Ÿæˆå™¨æ¥å£
  - `MemoryInterface`: è®°å¿†æ¥å£
  - `CacheInterface`: ç¼“å­˜æ¥å£

- [ ] **åˆ›å»ºå·¥å‚ç±»**
  - `RetrieverFactory`
  - `RerankerFactory`
  - `GeneratorFactory`
  - `MemoryFactory`

- [ ] **é‡æ„ç°æœ‰ä»£ç **
  - è®©ç°æœ‰å®ç°ç¬¦åˆæ–°æ¥å£
  - ä½¿ç”¨å·¥å‚æ¨¡å¼åˆ›å»ºç»„ä»¶
  - æ›´æ–°æµ‹è¯•

#### éªŒæ”¶æ ‡å‡†

- âœ… æ‰€æœ‰ç»„ä»¶éƒ½å®ç°äº†å¯¹åº”æ¥å£
- âœ… å¯ä»¥è½»æ¾åˆ‡æ¢ä¸åŒå®ç°
- âœ… å·¥å‚ç±»æµ‹è¯•è¦†ç›–ç‡ > 80%
- âœ… æ¥å£æ–‡æ¡£å®Œæ•´

#### æ ¸å¿ƒæ¥å£ç¤ºä¾‹

```python
from abc import ABC, abstractmethod
from typing import List, Dict, Any

class RetrieverInterface(ABC):
    @abstractmethod
    async def retrieve(self, query: str, top_k: int) -> List[Document]:
        """æ£€ç´¢ç›¸å…³æ–‡æ¡£"""
        pass

class GeneratorInterface(ABC):
    @abstractmethod
    async def generate(
        self, 
        query: str, 
        context: List[Document],
        stream: bool = False
    ) -> str:
        """ç”Ÿæˆç­”æ¡ˆ"""
        pass
```

---

### Phase 1 äº¤ä»˜ç‰©

- âœ… å®Œå–„çš„é…ç½®ç³»ç»Ÿï¼ˆæ”¯æŒå¤šç¯å¢ƒï¼‰
- âœ… çœŸå®çš„ LLM/Embeddings é›†æˆ
- âœ… æ¸…æ™°çš„æ¥å£æŠ½è±¡å±‚
- âœ… åŸºç¡€å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›–ç‡ > 70%ï¼‰
- âœ… æ›´æ–°çš„ README å’Œé…ç½®æ–‡æ¡£

---

## Phase 2: å¢å¼ºæ£€ç´¢èƒ½åŠ› (Week 3-4)

**ğŸ¯ ç›®æ ‡**: æå‡æ£€ç´¢è´¨é‡ï¼Œè¿™æ˜¯ RAG ç³»ç»Ÿçš„æ ¸å¿ƒ

**â±ï¸ é¢„è®¡æ—¶é—´**: 2 å‘¨ (9 å·¥ä½œæ—¥)

### 2.1 å®ç°å¤šç§æ£€ç´¢ç­–ç•¥

**ä¼˜å…ˆçº§**: â­â­â­â­â­ (å¿…é¡»)  
**å·¥ä½œé‡**: 3-4 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **ä¼˜åŒ– VectorRetriever**
  ```
  rag/retrievers/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py                    # åŸºç±»
  â”œâ”€â”€ vector_retriever.py        # å‘é‡æ£€ç´¢
  â”œâ”€â”€ hybrid_retriever.py        # æ··åˆæ£€ç´¢ â­
  â”œâ”€â”€ multi_query_retriever.py   # å¤šæŸ¥è¯¢æ£€ç´¢
  â”œâ”€â”€ ensemble_retriever.py      # é›†æˆæ£€ç´¢
  â””â”€â”€ factory.py                 # å·¥å‚ç±»
  ```

- [ ] **å®ç° HybridRetriever** â­ (æœ€é‡è¦)
  - é›†æˆ BM25 æ£€ç´¢å™¨
  - å®ç°å‘é‡å’Œ BM25 ç»“æœèåˆ
  - æ”¯æŒæƒé‡é…ç½®ï¼ˆé»˜è®¤ 0.7/0.3ï¼‰
  - æ€§èƒ½ä¼˜åŒ–

- [ ] **å®ç° MultiQueryRetriever**
  - ä½¿ç”¨ LLM ç”Ÿæˆå¤šä¸ªæŸ¥è¯¢å˜ä½“
  - å¹¶è¡Œæ£€ç´¢
  - ç»“æœå»é‡å’Œåˆå¹¶

- [ ] **å®ç° EnsembleRetriever** (å¯é€‰)
  - ç»„åˆå¤šä¸ªæ£€ç´¢å™¨
  - åŠ æƒæŠ•ç¥¨æœºåˆ¶

- [ ] **æ·»åŠ  RetrieverFactory**
  - æ ¹æ®é…ç½®åˆ›å»ºæ£€ç´¢å™¨
  - æ”¯æŒåŠ¨æ€åˆ‡æ¢

#### éªŒæ”¶æ ‡å‡†

- âœ… Hybrid æ£€ç´¢æ¯”çº¯å‘é‡æ£€ç´¢ recall@5 æå‡ 10%+
- âœ… å¯ä»¥é€šè¿‡é…ç½®åˆ‡æ¢ä¸åŒæ£€ç´¢å™¨
- âœ… æ£€ç´¢å»¶è¿Ÿ P95 < 500ms (top-5)
- âœ… æœ‰å®Œæ•´çš„æ€§èƒ½æµ‹è¯•æŠ¥å‘Š

#### æ–°å¢ä¾èµ–

```toml
rank-bm25>=0.2.2
```

#### å»ºè®®å®æ–½é¡ºåº

1. **VectorRetriever** (å·²æœ‰ï¼Œä¼˜åŒ–) - 1 å¤©
2. **HybridRetriever** â­ (æœ€é‡è¦) - 2 å¤©
3. **MultiQueryRetriever** (å¢å¼ºå¬å›) - 1 å¤©
4. **EnsembleRetriever** (å¯é€‰) - å¯è·³è¿‡

---

### 2.2 å®ç°æ–‡æ¡£åå¤„ç†

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºæ–‡æ¡£å¤„ç†æ¨¡å—**
  ```
  rag/processing/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ deduplicator.py        # å»é‡
  â”œâ”€â”€ mmr_filter.py          # MMR è¿‡æ»¤
  â”œâ”€â”€ compressor.py          # ä¸Šä¸‹æ–‡å‹ç¼©
  â””â”€â”€ pipeline.py            # å¤„ç† pipeline
  ```

- [ ] **å®ç°å»é‡ (Deduplication)**
  - åŸºäºå†…å®¹å“ˆå¸Œå»é‡
  - åŸºäºè¯­ä¹‰ç›¸ä¼¼åº¦å»é‡
  - ä¿ç•™æœ€é«˜åˆ†æ–‡æ¡£

- [ ] **å®ç° MMR è¿‡æ»¤**
  - Maximum Marginal Relevance ç®—æ³•
  - å¹³è¡¡ç›¸å…³æ€§å’Œå¤šæ ·æ€§
  - å¯é…ç½® lambda å‚æ•°

- [ ] **å®ç°ä¸Šä¸‹æ–‡å‹ç¼©**
  - ä½¿ç”¨ LLM æå–ç›¸å…³å†…å®¹
  - å‡å°‘ token ä½¿ç”¨
  - ä¿æŒè¯­ä¹‰å®Œæ•´æ€§

- [ ] **é›†æˆåˆ°æ£€ç´¢æµç¨‹**
  - åœ¨æ£€ç´¢å’Œé‡æ’åºä¹‹é—´æ’å…¥
  - å¯é…ç½®å¼€å…³

#### éªŒæ”¶æ ‡å‡†

- âœ… å»é‡åæ–‡æ¡£æ•°é‡å‡å°‘ 20-30%
- âœ… MMR æé«˜æ–‡æ¡£å¤šæ ·æ€§ï¼ˆcosine similarity < 0.8ï¼‰
- âœ… ä¸Šä¸‹æ–‡å‹ç¼©å‡å°‘ token ä½¿ç”¨ 30%+
- âœ… å¤„ç†å»¶è¿Ÿ < 200ms

#### æ–°å¢ä¾èµ–

```toml
langchain-community>=0.2.0  # ç”¨äº LLMChainExtractor
```

---

### 2.3 å®ç°é‡æ’åº

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºé‡æ’åºæ¨¡å—**
  ```
  rag/rerankers/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py                      # åŸºç±»
  â”œâ”€â”€ cross_encoder_reranker.py    # Cross-Encoder â­
  â”œâ”€â”€ llm_reranker.py              # LLM é‡æ’åº
  â”œâ”€â”€ score_based_reranker.py      # åˆ†æ•°é‡æ’åº
  â””â”€â”€ factory.py                   # å·¥å‚ç±»
  ```

- [ ] **å®ç° Cross-Encoder Reranker** â­
  - ä½¿ç”¨ sentence-transformers
  - æ¨¡å‹: `cross-encoder/ms-marco-MiniLM-L-6-v2`
  - æ‰¹é‡æ¨ç†ä¼˜åŒ–
  - ç¼“å­˜æœºåˆ¶

- [ ] **å®ç° LLM Reranker** (å¯é€‰)
  - ä½¿ç”¨ GPT-4 è¯„åˆ†
  - æ›´å‡†ç¡®ä½†æ›´æ˜‚è´µ
  - å¯ä½œä¸ºé»„é‡‘æ ‡å‡†å¯¹æ¯”

- [ ] **é›†æˆåˆ° RAG Pipeline**
  - åœ¨æ–‡æ¡£å¤„ç†ååº”ç”¨
  - å¯é…ç½® top_n
  - æ€§èƒ½ç›‘æ§

- [ ] **A/B æµ‹è¯•**
  - å¯¹æ¯”é‡æ’åºå‰åæ•ˆæœ
  - ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š

#### éªŒæ”¶æ ‡å‡†

- âœ… Top-3 å‡†ç¡®ç‡æå‡ 15%+
- âœ… ç«¯åˆ°ç«¯å»¶è¿Ÿå¢åŠ  < 300ms
- âœ… æœ‰æ¸…æ™°çš„ A/B æµ‹è¯•æŠ¥å‘Š
- âœ… é‡æ’åºå¯é€šè¿‡é…ç½®å¼€å…³

#### æ–°å¢ä¾èµ–

```toml
sentence-transformers>=2.2.0
torch>=2.0.0  # Cross-Encoder ä¾èµ–
```

#### å»ºè®®å®æ–½é¡ºåº

1. **Cross-Encoder** â­ (æ€§ä»·æ¯”æœ€é«˜) - 2 å¤©
2. **LLM Reranker** (å¯é€‰ï¼Œæ˜‚è´µ) - 1 å¤©ï¼Œå¯è·³è¿‡

---

### Phase 2 äº¤ä»˜ç‰©

- âœ… æ··åˆæ£€ç´¢ç³»ç»Ÿï¼ˆVector + BM25ï¼‰
- âœ… æ–‡æ¡£åå¤„ç† pipeline
- âœ… Cross-Encoder é‡æ’åº
- âœ… æ£€ç´¢è´¨é‡è¯„ä¼°æŠ¥å‘Š
- âœ… æ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœ

---

## Phase 3: æŸ¥è¯¢ç†è§£ä¸è·¯ç”± (Week 5)

**ğŸ¯ ç›®æ ‡**: è®©ç³»ç»Ÿæ›´æ™ºèƒ½åœ°ç†è§£å’Œå¤„ç†æŸ¥è¯¢

**â±ï¸ é¢„è®¡æ—¶é—´**: 1 å‘¨ (7 å·¥ä½œæ—¥)

### 3.1 å®ç°æŸ¥è¯¢é¢„å¤„ç†

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 1-2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºé¢„å¤„ç†æ¨¡å—**
  ```
  rag/preprocessing/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ query_cleaner.py       # æŸ¥è¯¢æ¸…æ´—
  â”œâ”€â”€ language_detector.py   # è¯­è¨€æ£€æµ‹
  â””â”€â”€ intent_classifier.py   # æ„å›¾åˆ†ç±»ï¼ˆå¯é€‰ï¼‰
  ```

- [ ] **å®ç°æŸ¥è¯¢æ¸…æ´—**
  - å»é™¤ç‰¹æ®Šå­—ç¬¦
  - æ ‡å‡†åŒ–ç©ºæ ¼
  - æ‹¼å†™çº æ­£ï¼ˆå¯é€‰ï¼‰
  - å¤§å°å†™æ ‡å‡†åŒ–

- [ ] **å®ç°è¯­è¨€æ£€æµ‹**
  - ä½¿ç”¨ langdetect æˆ– fasttext
  - æ”¯æŒå¤šè¯­è¨€
  - è®°å½•è¯­è¨€ä¿¡æ¯

- [ ] **å®ç°æ„å›¾åˆ†ç±»** (å¯é€‰)
  - é—®ç­” vs é—²èŠ vs æŒ‡ä»¤
  - ä½¿ç”¨å°å‹åˆ†ç±»æ¨¡å‹
  - æˆ–åŸºäºè§„åˆ™

#### éªŒæ”¶æ ‡å‡†

- âœ… å¤„ç†å„ç§æ ¼å¼çš„æŸ¥è¯¢ï¼ˆURLã€ç‰¹æ®Šå­—ç¬¦ç­‰ï¼‰
- âœ… æ­£ç¡®è¯†åˆ«ä¸»è¦è¯­è¨€ï¼ˆä¸­æ–‡ã€è‹±æ–‡ï¼‰
- âœ… é¢„å¤„ç†å»¶è¿Ÿ < 50ms

#### æ–°å¢ä¾èµ–

```toml
langdetect>=1.0.9
# æˆ–
fasttext>=0.9.2
```

---

### 3.2 å®ç°æŸ¥è¯¢è½¬æ¢

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºæŸ¥è¯¢è½¬æ¢æ¨¡å—**
  ```
  rag/query_transformation/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py                # åŸºç±»
  â”œâ”€â”€ multi_query.py         # å¤šæŸ¥è¯¢ç”Ÿæˆ â­
  â”œâ”€â”€ step_back.py           # Step-back prompting
  â”œâ”€â”€ decomposition.py       # æŸ¥è¯¢åˆ†è§£
  â””â”€â”€ contextualizer.py      # å¯¹è¯ä¸Šä¸‹æ–‡åŒ–
  ```

- [ ] **å®ç° Multi-Query ç”Ÿæˆ** â­
  - ä½¿ç”¨ LLM ç”Ÿæˆ 3-5 ä¸ªæŸ¥è¯¢å˜ä½“
  - ä¸åŒè§’åº¦ã€ä¸åŒæªè¾
  - å¹¶è¡Œæ£€ç´¢å’Œåˆå¹¶
  - ç»“æœå»é‡

- [ ] **å®ç° Step-back Prompting**
  - ç”Ÿæˆæ›´æŠ½è±¡çš„æŸ¥è¯¢
  - è·å–æ›´å¹¿æ³›çš„ä¸Šä¸‹æ–‡
  - é€‚ç”¨äºéœ€è¦èƒŒæ™¯çŸ¥è¯†çš„æŸ¥è¯¢

- [ ] **å®ç°æŸ¥è¯¢åˆ†è§£**
  - å°†å¤æ‚æŸ¥è¯¢åˆ†è§£ä¸ºå­æŸ¥è¯¢
  - æŒ‰é¡ºåºæˆ–å¹¶è¡Œæ‰§è¡Œ
  - åˆå¹¶å­ç­”æ¡ˆ

- [ ] **é›†æˆåˆ°æ£€ç´¢æµç¨‹**
  - åœ¨æ£€ç´¢å‰åº”ç”¨
  - å¯é…ç½®ç­–ç•¥é€‰æ‹©

#### éªŒæ”¶æ ‡å‡†

- âœ… Multi-Query æå‡å¬å›ç‡ 15%+
- âœ… å¤æ‚æŸ¥è¯¢å¯ä»¥è¢«æ­£ç¡®åˆ†è§£
- âœ… æŸ¥è¯¢è½¬æ¢å»¶è¿Ÿ < 1s
- âœ… æœ‰æ•ˆæœå¯¹æ¯”æŠ¥å‘Š

#### Prompt ç¤ºä¾‹

```python
# Multi-Query Prompt
MULTI_QUERY_PROMPT = """
You are an AI assistant. Generate 3 different versions of the given question 
to retrieve relevant documents from a vector database.

Original question: {question}

Alternative questions:
1.
2.
3.
"""
```

#### å»ºè®®å®æ–½é¡ºåº

1. **Multi-Query** â­ (æœ€å®¹æ˜“ï¼Œæ•ˆæœå¥½) - 1.5 å¤©
2. **Step-back** (æé«˜ç†è§£) - 1 å¤©
3. **Decomposition** (å¤„ç†å¤æ‚æŸ¥è¯¢) - 0.5 å¤©

---

### 3.3 å®ç°æ™ºèƒ½è·¯ç”±

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºè·¯ç”±æ¨¡å—**
  ```
  rag/routing/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ query_router.py          # ä¸»è·¯ç”±å™¨
  â”œâ”€â”€ semantic_router.py       # è¯­ä¹‰è·¯ç”±
  â””â”€â”€ rule_based_router.py     # è§„åˆ™è·¯ç”±
  ```

- [ ] **å®šä¹‰è·¯ç”±ç±»å‹**
  ```python
  class QueryType(str, Enum):
      GREETING = "greeting"           # ç®€å•é—®å€™
      FACTUAL = "factual"            # äº‹å®æŸ¥è¯¢
      REASONING = "reasoning"         # å¤æ‚æ¨ç†
      CONVERSATIONAL = "conversational" # å¯¹è¯åœºæ™¯
      SUMMARIZATION = "summarization" # æ–‡æ¡£æ€»ç»“
  ```

- [ ] **å®ç°è§„åˆ™è·¯ç”±**
  - åŸºäºå…³é”®è¯
  - åŸºäºæŸ¥è¯¢é•¿åº¦
  - åŸºäºæ­£åˆ™è¡¨è¾¾å¼

- [ ] **å®ç°è¯­ä¹‰è·¯ç”±**
  - ä½¿ç”¨ Semantic Router åº“
  - æˆ–ä½¿ç”¨åˆ†ç±»æ¨¡å‹
  - æˆ–ä½¿ç”¨ LLM few-shot

- [ ] **å®šä¹‰è·¯ç”±ç­–ç•¥**
  - Greeting â†’ ç›´æ¥å“åº”
  - Factual â†’ æ ‡å‡† RAG
  - Reasoning â†’ å¢å¼º RAG / Agentic RAG
  - Conversational â†’ å¯¹è¯å¼ RAG

- [ ] **é›†æˆåˆ° API Layer**
  - åœ¨æŸ¥è¯¢å¤„ç†å‰åº”ç”¨è·¯ç”±
  - è®°å½•è·¯ç”±å†³ç­–
  - ç›‘æ§è·¯ç”±å‡†ç¡®ç‡

#### éªŒæ”¶æ ‡å‡†

- âœ… ç®€å•é—®å€™ä¸è§¦å‘æ£€ç´¢ï¼ˆèŠ‚çœæˆæœ¬ï¼‰
- âœ… ä¸åŒç±»å‹æŸ¥è¯¢èµ°ä¸åŒ pipeline
- âœ… è·¯ç”±å‡†ç¡®ç‡ > 90%
- âœ… è·¯ç”±å»¶è¿Ÿ < 100ms

#### æ–°å¢ä¾èµ–

```toml
semantic-router>=0.0.17  # å¯é€‰
```

---

### Phase 3 äº¤ä»˜ç‰©

- âœ… æŸ¥è¯¢é¢„å¤„ç† pipeline
- âœ… å¤šç§æŸ¥è¯¢è½¬æ¢ç­–ç•¥
- âœ… æ™ºèƒ½è·¯ç”±ç³»ç»Ÿ
- âœ… æŸ¥è¯¢ç†è§£å‡†ç¡®ç‡æå‡ 20%+
- âœ… è·¯ç”±æ•ˆæœè¯„ä¼°æŠ¥å‘Š

---

## Phase 4: ç”Ÿæˆå¢å¼ºä¸éªŒè¯ (Week 6)

**ğŸ¯ ç›®æ ‡**: æå‡ç”Ÿæˆè´¨é‡ï¼Œå‡å°‘å¹»è§‰

**â±ï¸ é¢„è®¡æ—¶é—´**: 1 å‘¨ (7 å·¥ä½œæ—¥)

### 4.1 ä¼˜åŒ– Prompt å·¥ç¨‹

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»º Prompt ç®¡ç†æ¨¡å—**
  ```
  rag/prompts/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py                # åŸºç¡€ Prompt ç±»
  â”œâ”€â”€ qa_prompts.py          # QA Prompts
  â”œâ”€â”€ chat_prompts.py        # Chat Prompts
  â”œâ”€â”€ summary_prompts.py     # æ€»ç»“ Prompts
  â””â”€â”€ templates/             # Prompt æ¨¡æ¿ç›®å½•
      â”œâ”€â”€ qa_default.txt
      â”œâ”€â”€ qa_with_sources.txt
      â””â”€â”€ chat_context.txt
  ```

- [ ] **è®¾è®¡ Prompt æ¨¡æ¿**
  - QA Promptï¼ˆå¸¦å¼•ç”¨æ¥æºï¼‰
  - Chat Promptï¼ˆå¯¹è¯å¼ï¼‰
  - Summarization Prompt
  - å¤šè¯­è¨€æ”¯æŒ

- [ ] **å®ç° Prompt ç‰ˆæœ¬ç®¡ç†**
  - Git ç®¡ç† Prompt æ–‡ä»¶
  - Prompt ç‰ˆæœ¬å·
  - A/B æµ‹è¯•æ”¯æŒ

- [ ] **Prompt ä¼˜åŒ–**
  - Few-shot examples
  - Chain-of-thought
  - ç»“æ„åŒ–è¾“å‡ºæŒ‡ä»¤

- [ ] **A/B æµ‹è¯•æ¡†æ¶**
  - å¯¹æ¯”ä¸åŒ Prompt æ•ˆæœ
  - æ”¶é›†ç”¨æˆ·åé¦ˆ
  - æ•°æ®é©±åŠ¨ä¼˜åŒ–

#### éªŒæ”¶æ ‡å‡†

- âœ… ç­”æ¡ˆè´¨é‡ä¸»è§‚è¯„åˆ†æå‡ï¼ˆ4.0 â†’ 4.5 / 5.0ï¼‰
- âœ… ç­”æ¡ˆæ›´åŠ ç»“æ„åŒ–ï¼ˆæœ‰æ¸…æ™°çš„åˆ†æ®µï¼‰
- âœ… å¼•ç”¨æ¥æºå‡†ç¡®ç‡ > 95%
- âœ… æœ‰ Prompt ç‰ˆæœ¬æ§åˆ¶

#### Prompt ç¤ºä¾‹

```python
QA_PROMPT_TEMPLATE = """
You are a helpful AI assistant. Answer the question based ONLY on the following context.

Context:
{context}

Question: {question}

Instructions:
1. Answer should be comprehensive but concise
2. Cite sources using [1], [2], etc.
3. If the answer is not in the context, say "I don't have enough information"
4. Be specific and factual

Answer:
"""
```

---

### 4.2 å®ç°æµå¼è¾“å‡º

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **ä¿®æ”¹ Generator æ”¯æŒæµå¼**
  ```
  rag/generators/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py                # åŸºç±»
  â”œâ”€â”€ streaming_generator.py # æµå¼ç”Ÿæˆå™¨ â­
  â”œâ”€â”€ batch_generator.py     # æ‰¹é‡ç”Ÿæˆå™¨
  â””â”€â”€ factory.py             # å·¥å‚ç±»
  ```

- [ ] **å®ç° StreamingGenerator**
  - æ”¯æŒ SSE (Server-Sent Events)
  - æ”¯æŒ WebSocketï¼ˆå¯é€‰ï¼‰
  - Token-by-token æµå¼è¾“å‡º
  - é”™è¯¯å¤„ç†

- [ ] **æ›´æ–° API Endpoints**
  - `POST /api/v1/query/stream` - æµå¼æ¥å£
  - `POST /api/v1/query` - ä¿æŒæ‰¹é‡æ¥å£
  - å“åº”æ ¼å¼ç»Ÿä¸€

- [ ] **æ›´æ–° LangGraph Workflow**
  - æ”¯æŒæµå¼ç”ŸæˆèŠ‚ç‚¹
  - ä¿æŒçŠ¶æ€è¿½è¸ª

- [ ] **å‰ç«¯é›†æˆç¤ºä¾‹**ï¼ˆå¯é€‰ï¼‰
  - JavaScript EventSource ç¤ºä¾‹
  - å®æ—¶æ˜¾ç¤ºè¾“å‡º

#### éªŒæ”¶æ ‡å‡†

- âœ… æ”¯æŒæµå¼å“åº”
- âœ… é¦–å­—å»¶è¿Ÿ < 1s
- âœ… æµå¼è¾“å‡ºç¨³å®šæ— æ–­è¿
- âœ… ç”¨æˆ·ä½“éªŒæ˜¾è‘—æå‡

#### API ç¤ºä¾‹

```python
@app.post("/api/v1/query/stream")
async def query_stream(request: QueryRequest):
    async def generate():
        async for chunk in pipeline.query_stream(request.query):
            yield f"data: {json.dumps({'chunk': chunk})}\n\n"
        yield f"data: {json.dumps({'done': True})}\n\n"
    
    return StreamingResponse(generate(), media_type="text/event-stream")
```

---

### 4.3 å®ç°è‡ªæˆ‘çº æ­£

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºè¯„ä¼°æ¨¡å—**
  ```
  rag/evaluation/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ faithfulness_checker.py    # å¿ å®åº¦æ£€æŸ¥
  â”œâ”€â”€ hallucination_detector.py  # å¹»è§‰æ£€æµ‹
  â”œâ”€â”€ relevance_scorer.py        # ç›¸å…³æ€§è¯„åˆ†
  â””â”€â”€ self_corrector.py          # è‡ªæˆ‘çº æ­£
  ```

- [ ] **å®ç°å¿ å®åº¦æ£€æŸ¥**
  - æ£€æŸ¥ç­”æ¡ˆæ˜¯å¦åŸºäºä¸Šä¸‹æ–‡
  - ä½¿ç”¨ LLM è¯„ä¼°
  - æˆ–ä½¿ç”¨ NLI æ¨¡å‹

- [ ] **å®ç°å¹»è§‰æ£€æµ‹**
  - æ£€æµ‹ä¸æ”¯æŒçš„é™ˆè¿°
  - æ£€æµ‹çŸ›ç›¾
  - ç½®ä¿¡åº¦è¯„åˆ†

- [ ] **å®ç°é‡è¯•æœºåˆ¶**
  - ä½è´¨é‡ç­”æ¡ˆè§¦å‘é‡è¯•
  - é‡æ–°æ£€ç´¢
  - é‡æ–°ç”Ÿæˆ
  - æœ€å¤šé‡è¯• 2 æ¬¡

- [ ] **é›†æˆåˆ° LangGraph**
  - æ·»åŠ è‡ªæˆ‘çº æ­£èŠ‚ç‚¹
  - æ¡ä»¶è¾¹ï¼šéœ€è¦é‡è¯• vs é€šè¿‡
  - è®°å½•çº æ­£æ¬¡æ•°

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥æ£€æµ‹æ˜æ˜¾çš„å¹»è§‰ï¼ˆå‡†ç¡®ç‡ > 80%ï¼‰
- âœ… ä¸å¿ å®çš„ç­”æ¡ˆè§¦å‘é‡è¯•
- âœ… æ•´ä½“å‡†ç¡®ç‡æå‡ 10%+
- âœ… é‡è¯•ä¸è¶…è¿‡ 2 æ¬¡ï¼ˆé¿å…æ— é™å¾ªç¯ï¼‰

#### è‡ªæˆ‘çº æ­£ Prompt

```python
FAITHFULNESS_CHECK_PROMPT = """
Check if the answer is supported by the context.

Context: {context}
Answer: {answer}

Is the answer faithful to the context? Answer yes or no and explain why.

Evaluation:
"""
```

---

### Phase 4 äº¤ä»˜ç‰©

- âœ… ä¼˜åŒ–çš„ Prompt ç³»ç»Ÿ
- âœ… æµå¼å“åº”åŠŸèƒ½
- âœ… è‡ªæˆ‘çº æ­£æœºåˆ¶
- âœ… ç­”æ¡ˆè´¨é‡æå‡ 15%+
- âœ… å¹»è§‰ç‡é™ä½ 50%+

---

## Phase 5: å¯¹è¯ä¸è®°å¿† (Week 7)

**ğŸ¯ ç›®æ ‡**: æ”¯æŒå¤šè½®å¯¹è¯ï¼Œå¢åŠ ä¸Šä¸‹æ–‡ç†è§£

**â±ï¸ é¢„è®¡æ—¶é—´**: 1 å‘¨ (7 å·¥ä½œæ—¥)

### 5.1 å®ç°å¯¹è¯è®°å¿†

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºè®°å¿†æ¨¡å—**
  ```
  rag/memory/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py                    # åŸºç±»
  â”œâ”€â”€ buffer_memory.py           # ç¼“å†²è®°å¿† â­
  â”œâ”€â”€ summary_memory.py          # æ‘˜è¦è®°å¿†
  â”œâ”€â”€ knowledge_graph_memory.py  # KG è®°å¿†ï¼ˆå¯é€‰ï¼‰
  â””â”€â”€ factory.py                 # å·¥å‚ç±»
  ```

- [ ] **å®ç° Buffer Memory** â­
  - ä¿å­˜æœ€è¿‘ N è½®å¯¹è¯
  - å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰
  - åŸºäº token æ•°é™åˆ¶
  - æ”¯æŒæŒä¹…åŒ–ï¼ˆRedis/DBï¼‰

- [ ] **å®ç° Summary Memory**
  - è‡ªåŠ¨æ€»ç»“å†å²å¯¹è¯
  - ä¿æŒå…³é”®ä¿¡æ¯
  - é€‚åˆé•¿å¯¹è¯

- [ ] **å®ç° Session ç®¡ç†**
  - åŸºäº session_id éš”ç¦»
  - Session è¶…æ—¶æ¸…ç†
  - æ”¯æŒå¤šç”¨æˆ·

- [ ] **é›†æˆ Redis**ï¼ˆå¯é€‰ï¼‰
  - åˆ†å¸ƒå¼è®°å¿†å­˜å‚¨
  - æ”¯æŒé›†ç¾¤éƒ¨ç½²
  - TTL è‡ªåŠ¨æ¸…ç†

#### éªŒæ”¶æ ‡å‡†

- âœ… æ”¯æŒå¤šè½®å¯¹è¯ï¼ˆè‡³å°‘ 10 è½®ï¼‰
- âœ… ä¸Šä¸‹æ–‡è¿è´¯æ€§å¥½ï¼ˆä¸»è§‚è¯„åˆ† > 4/5ï¼‰
- âœ… å†…å­˜å ç”¨å¯æ§ï¼ˆ< 100MB per sessionï¼‰
- âœ… Session ç®¡ç†æ­£å¸¸

#### æ–°å¢ä¾èµ–

```toml
redis>=4.5.0  # å¯é€‰
langchain-community>=0.2.0
```

#### å»ºè®®å®æ–½é¡ºåº

1. **Buffer Memory** â­ (ç®€å•ï¼Œé€‚åˆçŸ­å¯¹è¯) - 2 å¤©
2. **Summary Memory** (å¤„ç†é•¿å¯¹è¯) - 1 å¤©

---

### 5.2 å®ç° Conversational RAG

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **å®ç°æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ–**
  - ç»“åˆå†å²å¯¹è¯é‡å†™æŸ¥è¯¢
  - è§£æä»£è¯æŒ‡ä»£
  - å¤„ç†çœç•¥

- [ ] **åˆ›å»º Conversational Graph**
  ```python
  graph.add_node("load_memory", load_memory_node)
  graph.add_node("contextualize_query", contextualize_query_node)
  graph.add_node("retrieve", retrieve_node)
  graph.add_node("generate", generate_node)
  graph.add_node("save_memory", save_memory_node)
  ```

- [ ] **æ›´æ–° API**
  - æ·»åŠ  `session_id` å‚æ•°
  - æ”¯æŒå¯¹è¯å†å²è¿”å›
  - æ¸…é™¤ session API

- [ ] **å¤šè½®å¯¹è¯æµ‹è¯•**
  - åˆ›å»ºæµ‹è¯•å¯¹è¯åœºæ™¯
  - éªŒè¯ä¸Šä¸‹æ–‡ç†è§£
  - æ€§èƒ½æµ‹è¯•

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥ç†è§£ä»£è¯æŒ‡ä»£ ("å®ƒ", "è¿™ä¸ª", "åˆšæ‰çš„")
- âœ… å¯ä»¥å›ç­”è·Ÿè¿›é—®é¢˜
- âœ… å¤šè½®å¯¹è¯æµ‹è¯•ç”¨ä¾‹ 100% é€šè¿‡
- âœ… å¯¹è¯ä¸Šä¸‹æ–‡åŒ–å»¶è¿Ÿ < 500ms

#### æŸ¥è¯¢ä¸Šä¸‹æ–‡åŒ– Prompt

```python
CONTEXTUALIZE_PROMPT = """
Given a chat history and the latest user question, 
reformulate the question to be standalone.

Chat History:
{chat_history}

Latest Question: {question}

Standalone Question:
"""
```

---

### 5.3 å®ç°ç¼“å­˜ç³»ç»Ÿ

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºç¼“å­˜æ¨¡å—**
  ```
  rag/cache/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ base.py              # ç¼“å­˜æ¥å£
  â”œâ”€â”€ memory_cache.py      # å†…å­˜ç¼“å­˜ â­
  â”œâ”€â”€ redis_cache.py       # Redis ç¼“å­˜
  â””â”€â”€ semantic_cache.py    # è¯­ä¹‰ç¼“å­˜ï¼ˆé«˜çº§ï¼‰
  ```

- [ ] **å®ç°å†…å­˜ç¼“å­˜** â­
  - LRU (Least Recently Used)
  - ç²¾ç¡®åŒ¹é…ç¼“å­˜
  - TTL æ”¯æŒ
  - å¤§å°é™åˆ¶

- [ ] **å®ç° Redis ç¼“å­˜**ï¼ˆå¯é€‰ï¼‰
  - åˆ†å¸ƒå¼ç¼“å­˜
  - æ”¯æŒå¤šå®ä¾‹å…±äº«
  - æŒä¹…åŒ–

- [ ] **å®ç°è¯­ä¹‰ç¼“å­˜**ï¼ˆé«˜çº§ï¼Œå¯é€‰ï¼‰
  - ç›¸ä¼¼æŸ¥è¯¢åŒ¹é…
  - ä½¿ç”¨ embeddings
  - ç›¸ä¼¼åº¦é˜ˆå€¼é…ç½®

- [ ] **é›†æˆåˆ° Pipeline**
  - æ£€ç´¢ç»“æœç¼“å­˜
  - ç”Ÿæˆç»“æœç¼“å­˜
  - ç¼“å­˜é”®è®¾è®¡

#### éªŒæ”¶æ ‡å‡†

- âœ… å¸¸è§æŸ¥è¯¢ç¼“å­˜å‘½ä¸­ç‡ > 50%
- âœ… ç¼“å­˜å“åº”å»¶è¿Ÿ < 100ms
- âœ… èŠ‚çœ API è°ƒç”¨æˆæœ¬ 30%+
- âœ… ç¼“å­˜ç®¡ç†æ­£å¸¸ï¼ˆè‡ªåŠ¨æ¸…ç†ï¼‰

#### æ–°å¢ä¾èµ–

```toml
cachetools>=5.3.0  # å†…å­˜ç¼“å­˜
redis>=4.5.0  # Redis ç¼“å­˜
```

#### å»ºè®®å®æ–½é¡ºåº

1. **Memory Cache** â­ (æœ€ç®€å•) - 1 å¤©
2. **Redis Cache** (ç”Ÿäº§ç¯å¢ƒæ¨è) - 1 å¤©
3. **Semantic Cache** (é«˜çº§ï¼Œå¯è·³è¿‡) - å¯é€‰

---

### Phase 5 äº¤ä»˜ç‰©

- âœ… å¯¹è¯è®°å¿†ç³»ç»Ÿï¼ˆBuffer + Summaryï¼‰
- âœ… å¤šè½®å¯¹è¯æ”¯æŒ
- âœ… ç¼“å­˜ç³»ç»Ÿï¼ˆå†…å­˜ + Redisï¼‰
- âœ… å¯¹è¯ä½“éªŒæ˜¾è‘—æå‡
- âœ… å“åº”é€Ÿåº¦æå‡ 50%+ï¼ˆå¾—ç›Šäºç¼“å­˜ï¼‰

---

## Phase 6: å¯è§‚æµ‹æ€§ä¸ç”Ÿäº§åŒ– (Week 8-9)

**ğŸ¯ ç›®æ ‡**: è®©ç³»ç»Ÿå¯ç›‘æ§ã€å¯è°ƒè¯•ã€å¯ç»´æŠ¤

**â±ï¸ é¢„è®¡æ—¶é—´**: 2 å‘¨ (11 å·¥ä½œæ—¥)

### 6.1 é›†æˆ LangSmith

**ä¼˜å…ˆçº§**: â­â­â­â­â­ (å¿…é¡»)  
**å·¥ä½œé‡**: 1-2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **æ³¨å†Œå’Œé…ç½®**
  - æ³¨å†Œ LangSmith è´¦å·
  - è·å– API key
  - é…ç½®ç¯å¢ƒå˜é‡

- [ ] **é›†æˆ LangSmith Tracing**
  - å®‰è£… langsmith SDK
  - é…ç½® tracing
  - æ·»åŠ è‡ªå®šä¹‰ tags

- [ ] **æ·»åŠ  Metadata**
  - ç”¨æˆ· ID
  - Session ID
  - æŸ¥è¯¢ç±»å‹
  - æ¨¡å‹ç‰ˆæœ¬
  - æˆæœ¬ä¿¡æ¯

- [ ] **åˆ›å»º Datasets**
  - è¯„ä¼°æ•°æ®é›†
  - é»„é‡‘æ ‡å‡†ç­”æ¡ˆ
  - å®šæœŸæ›´æ–°

#### éªŒæ”¶æ ‡å‡†

- âœ… æ‰€æœ‰è¯·æ±‚éƒ½æœ‰ trace
- âœ… å¯ä»¥åœ¨ LangSmith UI çœ‹åˆ°å®Œæ•´é“¾è·¯
- âœ… å»¶è¿Ÿã€æˆæœ¬å¯è¿½è¸ª
- âœ… å¯ä»¥å›æ”¾å’Œè°ƒè¯•

#### é…ç½®ç¤ºä¾‹

```python
# .env
LANGCHAIN_TRACING_V2=true
LANGCHAIN_API_KEY=lsv2_xxx
LANGCHAIN_PROJECT=rag-production
```

#### æ–°å¢ä¾èµ–

```toml
langsmith>=0.1.0
```

---

### 6.2 å®ç°ç»“æ„åŒ–æ—¥å¿—

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 1 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **é›†æˆ structlog**
  - å®‰è£… structlog
  - é…ç½®æ—¥å¿—æ ¼å¼
  - æ›¿æ¢æ ‡å‡† logging

- [ ] **å®šä¹‰æ—¥å¿—å­—æ®µ**
  ```python
  {
      "timestamp": "2024-01-01T12:00:00Z",
      "level": "info",
      "event": "query_received",
      "query": "What are AI agents?",
      "session_id": "sess_123",
      "user_id": "user_456",
      "trace_id": "trace_789",
      "latency_ms": 1234
  }
  ```

- [ ] **æ·»åŠ å…³é”®èŠ‚ç‚¹æ—¥å¿—**
  - æŸ¥è¯¢æ¥æ”¶
  - è·¯ç”±å†³ç­–
  - æ£€ç´¢å¼€å§‹/ç»“æŸ
  - ç”Ÿæˆå¼€å§‹/ç»“æŸ
  - é”™è¯¯æ—¥å¿—

- [ ] **æ—¥å¿—çº§åˆ«é…ç½®**
  - å¼€å‘ç¯å¢ƒ: DEBUG
  - ç”Ÿäº§ç¯å¢ƒ: INFO
  - å¯åŠ¨æ€è°ƒæ•´

#### éªŒæ”¶æ ‡å‡†

- âœ… æ—¥å¿—ç»“æ„åŒ–ï¼Œæ˜“äºè§£æ
- âœ… å…³é”®æ­¥éª¤éƒ½æœ‰æ—¥å¿—ï¼ˆè¦†ç›–ç‡ > 90%ï¼‰
- âœ… å¯ä»¥ç”¨æ—¥å¿—æ’æŸ¥é—®é¢˜
- âœ… æ”¯æŒæ—¥å¿—æœç´¢å’Œè¿‡æ»¤

#### æ–°å¢ä¾èµ–

```toml
structlog>=23.1.0
python-json-logger>=2.0.7
```

---

### 6.3 å®ç°æŒ‡æ ‡æ”¶é›†

**ä¼˜å…ˆçº§**: â­â­â­ (ä¸­ç­‰)  
**å·¥ä½œé‡**: 2 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **å®šä¹‰å…³é”®æŒ‡æ ‡**
  ```python
  # Latency
  - query_latency_seconds (P50, P95, P99)
  - retrieval_latency_seconds
  - generation_latency_seconds
  
  # Success
  - query_success_total
  - query_error_total
  - error_rate
  
  # Usage
  - tokens_used_total
  - cost_usd_total
  - cache_hit_total
  - cache_miss_total
  
  # Quality
  - answer_quality_score
  - retrieval_recall_score
  ```

- [ ] **ä½¿ç”¨ Prometheus Client**
  - å®‰è£… prometheus-client
  - å®šä¹‰ metrics
  - æ·»åŠ  instrumentation

- [ ] **åˆ›å»º /metrics Endpoint**
  - æš´éœ² Prometheus metrics
  - æ”¯æŒ Prometheus æŠ“å–

- [ ] **Grafana Dashboard**ï¼ˆå¯é€‰ï¼‰
  - åˆ›å»º dashboard
  - å¯è§†åŒ–å…³é”®æŒ‡æ ‡
  - å‘Šè­¦è§„åˆ™

#### éªŒæ”¶æ ‡å‡†

- âœ… å…³é”®æŒ‡æ ‡å¯å¯¼å‡º
- âœ… `/metrics` endpoint å¯è®¿é—®
- âœ… æœ‰åŸºç¡€çš„æ€§èƒ½æŠ¥è¡¨
- âœ… å¯ä»¥å®æ—¶ç›‘æ§ç³»ç»ŸçŠ¶æ€

#### æ–°å¢ä¾èµ–

```toml
prometheus-client>=0.19.0
prometheus-fastapi-instrumentator>=6.1.0
```

---

### 6.4 å®ç°è¯„ä¼°ç³»ç»Ÿ

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»ºè¯„ä¼°æ¨¡å—**
  ```
  rag/evaluation/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ retrieval_metrics.py    # æ£€ç´¢æŒ‡æ ‡
  â”œâ”€â”€ generation_metrics.py   # ç”ŸæˆæŒ‡æ ‡
  â”œâ”€â”€ evaluator.py            # è¯„ä¼°å™¨
  â””â”€â”€ datasets/               # è¯„ä¼°æ•°æ®é›†
      â””â”€â”€ golden_dataset.json
  ```

- [ ] **å®ç°æ£€ç´¢è¯„ä¼°**
  - Recall@K
  - Precision@K
  - MRR (Mean Reciprocal Rank)
  - NDCG (Normalized Discounted Cumulative Gain)

- [ ] **å®ç°ç”Ÿæˆè¯„ä¼°**
  - Faithfulnessï¼ˆå¿ å®åº¦ï¼‰
  - Answer Relevanceï¼ˆç›¸å…³æ€§ï¼‰
  - Context Relevanceï¼ˆä¸Šä¸‹æ–‡ç›¸å…³æ€§ï¼‰
  - ä½¿ç”¨ RAGAS æ¡†æ¶

- [ ] **åˆ›å»ºè¯„ä¼°æ•°æ®é›†**
  - è‡³å°‘ 50 ä¸ªæŸ¥è¯¢
  - æ ‡æ³¨é»„é‡‘ç­”æ¡ˆ
  - ç›¸å…³æ–‡æ¡£æ ‡æ³¨

- [ ] **é›†æˆ LangSmith è¯„ä¼°**
  - åˆ›å»ºè¯„ä¼° runs
  - å¯¹æ¯”ä¸åŒç‰ˆæœ¬
  - è‡ªåŠ¨åŒ–è¯„ä¼°

- [ ] **ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š**
  - å®šé‡æŒ‡æ ‡
  - æ¡ˆä¾‹åˆ†æ
  - æ”¹è¿›å»ºè®®

#### éªŒæ”¶æ ‡å‡†

- âœ… æœ‰æ ‡å‡†çš„è¯„ä¼°æ•°æ®é›†ï¼ˆ50+ æ ·æœ¬ï¼‰
- âœ… å¯ä»¥è‡ªåŠ¨åŒ–è¯„ä¼°
- âœ… æœ‰å®šé‡çš„è´¨é‡æŒ‡æ ‡
- âœ… æ¯å‘¨ç”Ÿæˆè¯„ä¼°æŠ¥å‘Š

#### æ–°å¢ä¾èµ–

```toml
ragas>=0.1.0  # RAG è¯„ä¼°æ¡†æ¶
datasets>=2.14.0
```

#### è¯„ä¼°æŒ‡æ ‡ç¤ºä¾‹

```python
evaluation_results = {
    "retrieval": {
        "recall@5": 0.85,
        "precision@5": 0.72,
        "mrr": 0.78,
        "ndcg@5": 0.81
    },
    "generation": {
        "faithfulness": 0.88,
        "answer_relevance": 0.82,
        "context_relevance": 0.79,
        "bleu": 0.45,
        "rouge_l": 0.52
    }
}
```

---

### 6.5 ç”Ÿäº§ç¯å¢ƒé…ç½®

**ä¼˜å…ˆçº§**: â­â­â­â­ (é‡è¦)  
**å·¥ä½œé‡**: 2-3 å¤©

#### ä»»åŠ¡æ¸…å•

- [ ] **Docker åŒ–**
  ```dockerfile
  # Dockerfile
  FROM python:3.11-slim
  
  WORKDIR /app
  COPY . .
  
  RUN pip install uv && uv pip install --system -e .
  
  EXPOSE 8000
  CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
  ```

- [ ] **Docker Compose**
  ```yaml
  # docker-compose.yml
  services:
    api:
      build: .
      ports:
        - "8000:8000"
      environment:
        - OPENAI_API_KEY=${OPENAI_API_KEY}
      depends_on:
        - redis
    
    redis:
      image: redis:7-alpine
      ports:
        - "6379:6379"
  ```

- [ ] **ç¯å¢ƒå˜é‡ç®¡ç†**
  - åˆ›å»º `.env.example`
  - æ–‡æ¡£åŒ–æ‰€æœ‰ç¯å¢ƒå˜é‡
  - ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ secrets

- [ ] **å¥åº·æ£€æŸ¥å¢å¼º**
  - æ£€æŸ¥ LLM API è¿é€šæ€§
  - æ£€æŸ¥å‘é‡æ•°æ®åº“
  - æ£€æŸ¥ Redis
  - è¿”å›è¯¦ç»†çŠ¶æ€

- [ ] **é”™è¯¯å¤„ç†å®Œå–„**
  - å…¨å±€å¼‚å¸¸å¤„ç†
  - å‹å¥½çš„é”™è¯¯ä¿¡æ¯
  - é”™è¯¯è¿½è¸ª
  - è‡ªåŠ¨å‘Šè­¦

- [ ] **é™æµå’Œè®¤è¯**
  - API key è®¤è¯
  - åŸºäºç”¨æˆ·çš„é™æµ
  - IP é™æµ
  - é˜²æ­¢æ»¥ç”¨

- [ ] **éƒ¨ç½²æ–‡æ¡£**
  - éƒ¨ç½²æ­¥éª¤
  - ç¯å¢ƒè¦æ±‚
  - é…ç½®è¯´æ˜
  - æ•…éšœæ’æŸ¥

#### éªŒæ”¶æ ‡å‡†

- âœ… å¯ä»¥ Docker éƒ¨ç½²
- âœ… æœ‰å®Œæ•´çš„éƒ¨ç½²æ–‡æ¡£
- âœ… é”™è¯¯å¤„ç†è¦†ç›–å¸¸è§åœºæ™¯
- âœ… æœ‰é™æµå’Œè®¤è¯æœºåˆ¶
- âœ… å¥åº·æ£€æŸ¥å®Œå–„

#### æ–°å¢ä¾èµ–

```toml
slowapi>=0.1.9  # é™æµ
python-jose[cryptography]>=3.3.0  # JWT
passlib[bcrypt]>=1.7.4  # å¯†ç å“ˆå¸Œ
```

---

### Phase 6 äº¤ä»˜ç‰©

- âœ… LangSmith å…¨é“¾è·¯è¿½è¸ª
- âœ… ç»“æ„åŒ–æ—¥å¿—ç³»ç»Ÿ
- âœ… Prometheus æŒ‡æ ‡æ”¶é›†
- âœ… è‡ªåŠ¨åŒ–è¯„ä¼°ç³»ç»Ÿ
- âœ… ç”Ÿäº§å°±ç»ªé…ç½®
- âœ… Docker éƒ¨ç½²æ”¯æŒ
- âœ… å®Œæ•´çš„éƒ¨ç½²æ–‡æ¡£

---

## Phase 7 (å¯é€‰): é«˜çº§ç‰¹æ€§ (Week 10+)

**ğŸ¯ ç›®æ ‡**: å¢åŠ é«˜çº§åŠŸèƒ½ï¼Œæ»¡è¶³ç‰¹å®šåœºæ™¯éœ€æ±‚

**â±ï¸ é¢„è®¡æ—¶é—´**: å¯é€‰ï¼Œæ ¹æ®éœ€æ±‚

### 7.1 Agentic RAG

**ä¼˜å…ˆçº§**: â­â­ (å¯é€‰)  
**å·¥ä½œé‡**: 3-5 å¤©

#### åŠŸèƒ½è¯´æ˜

ä½¿ç”¨ Agent æ¨¡å¼è¿›è¡Œå¤æ‚æ¨ç†ï¼Œæ”¯æŒå·¥å…·è°ƒç”¨ã€‚

#### ä»»åŠ¡æ¸…å•

- [ ] **åˆ›å»º Agent æ¨¡å—**
  ```
  rag/agents/
  â”œâ”€â”€ __init__.py
  â”œâ”€â”€ react_agent.py         # ReAct agent
  â”œâ”€â”€ planning_agent.py      # è§„åˆ’ agent
  â””â”€â”€ tools/
      â”œâ”€â”€ search_tool.py
      â”œâ”€â”€ summarize_tool.py
      â”œâ”€â”€ compare_tool.py
      â””â”€â”€ calculator_tool.py
  ```

- [ ] **å®šä¹‰å·¥å…·**
  - è¯­ä¹‰æœç´¢å·¥å…·
  - æ–‡æ¡£æ€»ç»“å·¥å…·
  - æ–‡æ¡£å¯¹æ¯”å·¥å…·
  - è®¡ç®—å™¨å·¥å…·ï¼ˆå¯é€‰ï¼‰
  - Web æœç´¢å·¥å…·ï¼ˆå¯é€‰ï¼‰

- [ ] **ä½¿ç”¨ LangGraph æ„å»º Agent**
  - ReAct pattern
  - å·¥å…·è°ƒç”¨å¾ªç¯
  - æ€è€ƒé“¾è®°å½•

- [ ] **é›†æˆåˆ°è·¯ç”±ç³»ç»Ÿ**
  - å¤æ‚æŸ¥è¯¢è‡ªåŠ¨è·¯ç”±åˆ° Agent

#### é€‚ç”¨åœºæ™¯

- éœ€è¦å¤šæ­¥éª¤æ¨ç†
- éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·
- å¤æ‚çš„ç ”ç©¶ä»»åŠ¡
- éœ€è¦å¯¹æ¯”å’Œåˆ†æ

#### ç¤ºä¾‹

```python
# ç”¨æˆ·æŸ¥è¯¢ï¼š
"Compare RAG with fine-tuning, analyze their pros and cons, 
and recommend which one I should use for customer support"

# Agent æ‰§è¡Œæµç¨‹ï¼š
1. Search for "RAG"
2. Search for "fine-tuning"
3. Compare the two approaches
4. Analyze use case requirements
5. Generate recommendation
```

---

### 7.2 é«˜çº§æ£€ç´¢æŠ€æœ¯

**ä¼˜å…ˆçº§**: â­â­ (å¯é€‰)  
**å·¥ä½œé‡**: 2-3 å¤©/åŠŸèƒ½

#### åŠŸèƒ½åˆ—è¡¨

1. **çˆ¶å­æ–‡æ¡£æ£€ç´¢**
   - æ£€ç´¢å°å—ï¼ˆç²¾ç¡®ï¼‰
   - è¿”å›å¤§å—ï¼ˆä¸Šä¸‹æ–‡ï¼‰
   - æå‡ä¸Šä¸‹æ–‡å®Œæ•´æ€§

2. **æ—¶é—´æ„ŸçŸ¥æ£€ç´¢**
   - è€ƒè™‘æ–‡æ¡£æ—¶é—´
   - ä¼˜å…ˆè¿”å›æœ€æ–°ä¿¡æ¯
   - æ”¯æŒæ—¶é—´èŒƒå›´è¿‡æ»¤

3. **çŸ¥è¯†å›¾è°±å¢å¼º**
   - æ„å»ºå®ä½“å…³ç³»å›¾
   - å›¾è°±æ£€ç´¢
   - ç»“æ„åŒ–çŸ¥è¯†è¡¥å……

4. **å¤šæ¨¡æ€æ£€ç´¢**
   - å›¾ç‰‡ + æ–‡æœ¬æ£€ç´¢
   - CLIP embeddings
   - å¤šæ¨¡æ€èåˆ

#### é€‚ç”¨åœºæ™¯

- æ–‡æ¡£ç»“æ„å¤æ‚ï¼ˆçˆ¶å­æ–‡æ¡£ï¼‰
- éœ€è¦æœ€æ–°ä¿¡æ¯ï¼ˆæ—¶é—´æ„ŸçŸ¥ï¼‰
- æœ‰ç»“æ„åŒ–çŸ¥è¯†ï¼ˆçŸ¥è¯†å›¾è°±ï¼‰
- åŒ…å«å›¾ç‰‡ç­‰å¤šæ¨¡æ€æ•°æ®

---

### 7.3 å®æ—¶æ•°æ®æºé›†æˆ

**ä¼˜å…ˆçº§**: â­â­ (å¯é€‰)  
**å·¥ä½œé‡**: 3-4 å¤©

#### åŠŸèƒ½è¯´æ˜

é›†æˆå®æ—¶æ•°æ®æºï¼Œç¡®ä¿ä¿¡æ¯æœ€æ–°ã€‚

#### ä»»åŠ¡æ¸…å•

- [ ] **Web æœç´¢é›†æˆ**
  - Tavily API
  - Serper API
  - Bing Search API

- [ ] **API æ•°æ®æº**
  - REST API è°ƒç”¨
  - GraphQL æ”¯æŒ
  - æ•°æ®è½¬æ¢

- [ ] **å®æ—¶æ–°é—»æº**
  - RSS feeds
  - æ–°é—» API
  - è‡ªåŠ¨æ›´æ–°

- [ ] **åŠ¨æ€çŸ¥è¯†æ›´æ–°**
  - å¢é‡æ›´æ–°å‘é‡åº“
  - å»é‡å’Œç‰ˆæœ¬ç®¡ç†
  - è‡ªåŠ¨è§¦å‘é‡æ–°ç´¢å¼•

#### é€‚ç”¨åœºæ™¯

- éœ€è¦æœ€æ–°ä¿¡æ¯ï¼ˆæ–°é—»ã€è‚¡ç¥¨ç­‰ï¼‰
- çŸ¥è¯†åº“éœ€è¦å®æ—¶æ›´æ–°
- ç»“åˆé™æ€çŸ¥è¯†åº“å’ŒåŠ¨æ€æ•°æ®

#### æ–°å¢ä¾èµ–

```toml
tavily-python>=0.3.0  # Web æœç´¢
feedparser>=6.0.10  # RSS
```

---

## æœ€å°å¯è¡Œäº§å“ (MVP) è·¯å¾„

å¦‚æœæƒ³å¿«é€ŸéªŒè¯å’Œä¸Šçº¿ï¼Œå¯ä»¥é‡‡ç”¨ **MVP è·¯å¾„**ï¼š

### MVP = æ ¸å¿ƒåŠŸèƒ½ (4 å‘¨)

```
Week 1-2: Phase 1 å®Œæ•´
  âœ“ é…ç½®ç³»ç»Ÿ
  âœ“ çœŸå® LLM/Embeddings
  âœ“ æ¥å£æŠ½è±¡

Week 3: Phase 2 æ ¸å¿ƒéƒ¨åˆ†
  âœ“ Hybrid æ£€ç´¢ (Vector + BM25)
  âœ“ Cross-Encoder é‡æ’åº
  âœ“ åŸºç¡€æ–‡æ¡£å¤„ç†

Week 4: Phase 6 åŸºç¡€éƒ¨åˆ†
  âœ“ LangSmith é›†æˆ
  âœ“ åŸºç¡€æ—¥å¿—
  âœ“ Docker åŒ–
  âœ“ éƒ¨ç½²æ–‡æ¡£
```

### MVP åŠŸèƒ½åˆ—è¡¨

| åŠŸèƒ½ | çŠ¶æ€ | ä¼˜å…ˆçº§ |
|------|------|--------|
| **æ ¸å¿ƒ** |
| çœŸå® LLM (GPT-4) | â­â­â­â­â­ | å¿…é¡» |
| çœŸå® Embeddings | â­â­â­â­â­ | å¿…é¡» |
| æ··åˆæ£€ç´¢ | â­â­â­â­â­ | å¿…é¡» |
| Cross-Encoder é‡æ’åº | â­â­â­â­ | é‡è¦ |
| åŸºç¡€é…ç½®ç³»ç»Ÿ | â­â­â­â­â­ | å¿…é¡» |
| **å¯è§‚æµ‹æ€§** |
| LangSmith è¿½è¸ª | â­â­â­â­â­ | å¿…é¡» |
| ç»“æ„åŒ–æ—¥å¿— | â­â­â­â­ | é‡è¦ |
| åŸºç¡€æŒ‡æ ‡ | â­â­â­ | ä¸­ç­‰ |
| **éƒ¨ç½²** |
| Docker åŒ– | â­â­â­â­ | é‡è¦ |
| å¥åº·æ£€æŸ¥ | â­â­â­â­ | é‡è¦ |
| éƒ¨ç½²æ–‡æ¡£ | â­â­â­â­ | é‡è¦ |

### åç»­è¿­ä»£

MVP ä¸Šçº¿åï¼Œæ ¹æ®ç”¨æˆ·åé¦ˆé€æ­¥æ·»åŠ ï¼š

- **Iteration 1** (Week 5-6): æŸ¥è¯¢å¢å¼º + æµå¼è¾“å‡º
- **Iteration 2** (Week 7): å¯¹è¯è®°å¿† + ç¼“å­˜
- **Iteration 3** (Week 8-9): å®Œæ•´å¯è§‚æµ‹æ€§ + è¯„ä¼°ç³»ç»Ÿ

---

## å®æ–½å»ºè®®

### 1. æ¯ä¸ª Phase ç»“æŸåçš„éªŒè¯

#### éªŒè¯æ¸…å•

- [ ] **åŠŸèƒ½æµ‹è¯•**
  - å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 70%
  - é›†æˆæµ‹è¯•é€šè¿‡
  - æ‰‹åŠ¨æµ‹è¯•å¸¸è§åœºæ™¯

- [ ] **æ€§èƒ½æµ‹è¯•**
  - å»¶è¿ŸåŸºå‡†æµ‹è¯•
  - å¹¶å‘æµ‹è¯•
  - èµ„æºä½¿ç”¨ç›‘æ§

- [ ] **è´¨é‡è¯„ä¼°**
  - åœ¨è¯„ä¼°æ•°æ®é›†ä¸Šè¿è¡Œ
  - å¯¹æ¯”ä¹‹å‰ç‰ˆæœ¬
  - è®°å½•æ”¹è¿›å¹…åº¦

- [ ] **æ–‡æ¡£æ›´æ–°**
  - API æ–‡æ¡£
  - é…ç½®æ–‡æ¡£
  - éƒ¨ç½²æ–‡æ¡£

---

### 2. æŒç»­æ”¹è¿›æµç¨‹

```
æ”¶é›†æ•°æ® â†’ åˆ†æé—®é¢˜ â†’ æå‡ºæ”¹è¿› â†’ å®æ–½ â†’ è¯„ä¼° â†’ å¾ªç¯
    â†‘                                           â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ•°æ®æ”¶é›†

- ç”¨æˆ·æŸ¥è¯¢æ—¥å¿—
- æ€§èƒ½æŒ‡æ ‡
- é”™è¯¯æ—¥å¿—
- ç”¨æˆ·åé¦ˆ

#### åˆ†ææ–¹æ³•

- æŸ¥æ‰¾é«˜é¢‘å¤±è´¥æŸ¥è¯¢
- è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- åˆ†æç”¨æˆ·è¡Œä¸ºæ¨¡å¼
- A/B æµ‹è¯•ç»“æœ

#### æ”¹è¿›æ–¹å‘

- Prompt ä¼˜åŒ–
- æ£€ç´¢å‚æ•°è°ƒä¼˜
- æ¨¡å‹å‡çº§
- ç¼“å­˜ç­–ç•¥ä¼˜åŒ–

---

### 3. æŠ€æœ¯å€ºåŠ¡ç®¡ç†

#### ä¼˜å…ˆçº§åŸåˆ™

1. **åŠŸèƒ½ > æ€§èƒ½ > ä¼˜é›…**ï¼ˆæ—©æœŸé˜¶æ®µï¼‰
2. **å¯ç”¨ > å®Œç¾**ï¼ˆMVP é˜¶æ®µï¼‰
3. **å¿«é€Ÿè¿­ä»£ > ä¸€æ¬¡åˆ°ä½**

#### æŠ€æœ¯å€ºåŠ¡è¿½è¸ª

åœ¨ä»£ç ä¸­æ ‡è®° TODO å’Œ FIXMEï¼š

```python
# TODO(Phase 7): å®ç°æ›´å¤æ‚çš„æŸ¥è¯¢åˆ†è§£
# FIXME: è¿™é‡Œéœ€è¦ä¼˜åŒ–æ€§èƒ½ï¼Œå½“å‰å¤ªæ…¢
# DEBT: ä¸´æ—¶æ–¹æ¡ˆï¼Œéœ€è¦é‡æ„ä¸ºå·¥å‚æ¨¡å¼
```

å®šæœŸå›é¡¾å’Œå¿è¿˜æŠ€æœ¯å€ºï¼š

- æ¯ä¸ª Sprint é¢„ç•™ 20% æ—¶é—´
- ä¼˜å…ˆå¿è¿˜å½±å“å¤§çš„å€ºåŠ¡
- é‡æ„å‰åå¯¹æ¯”æ•ˆæœ

---

### 4. å›¢é˜Ÿåä½œ

#### Git åˆ†æ”¯ç­–ç•¥

```
main (ç”Ÿäº§)
  â†‘
develop (å¼€å‘)
  â†‘
feature/phase-1-config (åŠŸèƒ½åˆ†æ”¯)
feature/phase-2-retrieval
...
```

#### Code Review æ¸…å•

- [ ] ä»£ç ç¬¦åˆæ¥å£è§„èŒƒ
- [ ] æœ‰å•å…ƒæµ‹è¯•
- [ ] æœ‰æ–‡æ¡£æ³¨é‡Š
- [ ] æ€§èƒ½å½±å“å¯æ¥å—
- [ ] é”™è¯¯å¤„ç†å®Œå–„

#### çŸ¥è¯†åˆ†äº«

- æ¯å‘¨æŠ€æœ¯åˆ†äº«ä¼š
- æ–‡æ¡£åŒæ­¥æ›´æ–°
- é‡è¦å†³ç­–è®°å½• (ADR)

---

## å…³é”®æˆåŠŸæŒ‡æ ‡ (KPI)

### Phase çº§åˆ« KPI

| Phase | å…³é”®æŒ‡æ ‡ | åŸºçº¿ | ç›®æ ‡ | è¡¡é‡æ–¹æ³• |
|-------|---------|------|------|---------|
| **Phase 1** | é…ç½®è¦†ç›–ç‡ | 0% | 100% | é…ç½®é¡¹æ•°é‡ / æ€»éœ€æ±‚ |
| | LLM é›†æˆæˆåŠŸç‡ | - | > 99% | æˆåŠŸè°ƒç”¨ / æ€»è°ƒç”¨ |
| | å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | 50% | > 70% | pytest-cov |
| **Phase 2** | æ£€ç´¢ Recall@5 | 70% | > 85% | è¯„ä¼°æ•°æ®é›† |
| | æ£€ç´¢å»¶è¿Ÿ P95 | 1s | < 500ms | Prometheus |
| | é‡æ’åºæå‡ | 0% | +15% | Top-3 å‡†ç¡®ç‡ |
| **Phase 3** | è·¯ç”±å‡†ç¡®ç‡ | - | > 90% | æ‰‹åŠ¨æ ‡æ³¨ |
| | æŸ¥è¯¢ç†è§£å‡†ç¡®ç‡ | - | > 85% | æµ‹è¯•é›† |
| | è·¯ç”±å»¶è¿Ÿ | - | < 100ms | è®¡æ—¶ |
| **Phase 4** | ç­”æ¡ˆè´¨é‡è¯„åˆ† | 3.5/5 | > 4.0/5 | äººå·¥è¯„åˆ† |
| | å¹»è§‰ç‡ | 20% | < 10% | è‡ªåŠ¨æ£€æµ‹ |
| | æµå¼é¦–å­—å»¶è¿Ÿ | - | < 1s | è®¡æ—¶ |
| **Phase 5** | å¯¹è¯è¿è´¯æ€§ | - | > 4.0/5 | äººå·¥è¯„åˆ† |
| | ç¼“å­˜å‘½ä¸­ç‡ | 0% | > 50% | cache_hit / total |
| | æˆæœ¬èŠ‚çœ | 0% | > 30% | token ç»Ÿè®¡ |
| **Phase 6** | æœåŠ¡å¯ç”¨æ€§ | - | > 99.5% | uptime / total |
| | ç›‘æ§è¦†ç›–ç‡ | 0% | 100% | å…³é”®è·¯å¾„ |
| | éƒ¨ç½²æˆåŠŸç‡ | - | 100% | CI/CD |

### ç«¯åˆ°ç«¯ KPI (ç”Ÿäº§ç¯å¢ƒ)

| ç±»åˆ« | æŒ‡æ ‡ | ç›®æ ‡ | ç›‘æ§æ–¹å¼ |
|------|------|------|---------|
| **æ€§èƒ½** | ç«¯åˆ°ç«¯å»¶è¿Ÿ P95 | < 3s | Prometheus |
| | é¦–å­—å»¶è¿Ÿ P95 (æµå¼) | < 1s | Prometheus |
| | QPS (æ¯ç§’æŸ¥è¯¢) | > 100 | Load test |
| **è´¨é‡** | ç­”æ¡ˆå‡†ç¡®ç‡ | > 85% | RAGAS |
| | å¹»è§‰ç‡ | < 10% | è‡ªåŠ¨æ£€æµ‹ |
| | ç”¨æˆ·æ»¡æ„åº¦ | > 4.0/5 | åé¦ˆ |
| **å¯é æ€§** | æœåŠ¡å¯ç”¨æ€§ | > 99.5% | ç›‘æ§ |
| | é”™è¯¯ç‡ | < 1% | æ—¥å¿— |
| | P99 å»¶è¿Ÿ | < 5s | Prometheus |
| **æˆæœ¬** | æ¯æŸ¥è¯¢æˆæœ¬ | < $0.05 | è®¡è´¹ |
| | ç¼“å­˜å‘½ä¸­ç‡ | > 60% | Redis |
| | Token ä½¿ç”¨æ•ˆç‡ | - | ç»Ÿè®¡ |

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### æœ¬å‘¨ (Week 1) - å¯åŠ¨ Phase 1

#### Day 1-2: ç¯å¢ƒå‡†å¤‡

- [ ] **æ³¨å†Œè´¦å·**
  - [ ] OpenAI API key
  - [ ] LangSmith è´¦å·
  - [ ] (å¯é€‰) Anthropic API key

- [ ] **åˆ›å»ºé…ç½®æ–‡ä»¶**
  ```bash
  cp .env.example .env
  # å¡«å†™ API keys
  ```

- [ ] **æµ‹è¯• API è¿é€šæ€§**
  ```python
  from openai import OpenAI
  client = OpenAI()
  response = client.chat.completions.create(
      model="gpt-4-turbo-preview",
      messages=[{"role": "user", "content": "Hello"}]
  )
  print(response.choices[0].message.content)
  ```

#### Day 3-5: æ ¸å¿ƒé›†æˆ

- [ ] **æ›¿æ¢ FakeEmbeddings**
  - [ ] å®ç° OpenAI Embeddings
  - [ ] æµ‹è¯• embedding ç”Ÿæˆ
  - [ ] æ›´æ–°å‘é‡å­˜å‚¨

- [ ] **æ›¿æ¢ FakeLLM**
  - [ ] å®ç° OpenAI LLM
  - [ ] æµ‹è¯•é—®ç­”æµç¨‹
  - [ ] éªŒè¯ç­”æ¡ˆè´¨é‡

- [ ] **æ·»åŠ é”™è¯¯å¤„ç†**
  - [ ] API è°ƒç”¨é‡è¯•
  - [ ] è¶…æ—¶å¤„ç†
  - [ ] é”™è¯¯æ—¥å¿—

#### Day 6-7: é…ç½®ç³»ç»Ÿ

- [ ] **é‡æ„é…ç½®**
  - [ ] åˆ›å»ºé…ç½®æ¨¡å—
  - [ ] ä½¿ç”¨ Pydantic Settings
  - [ ] ç¯å¢ƒå˜é‡æ”¯æŒ

- [ ] **æµ‹è¯•ç«¯åˆ°ç«¯**
  - [ ] è¿è¡Œå®Œæ•´æµç¨‹
  - [ ] éªŒæ”¶ Phase 1

---

### ä¸‹å‘¨ (Week 2) - å®Œæˆ Phase 1

- [ ] **æ¥å£æŠ½è±¡**
  - [ ] å®šä¹‰æ ¸å¿ƒæ¥å£
  - [ ] åˆ›å»ºå·¥å‚ç±»
  - [ ] é‡æ„ç°æœ‰ä»£ç 

- [ ] **å•å…ƒæµ‹è¯•**
  - [ ] æµ‹è¯•è¦†ç›–ç‡ > 70%
  - [ ] CI/CD é›†æˆ

- [ ] **æ–‡æ¡£æ›´æ–°**
  - [ ] é…ç½®æ–‡æ¡£
  - [ ] API æ–‡æ¡£
  - [ ] éƒ¨ç½²æŒ‡å—

---

### Week 3-4: Phase 2 å®æ–½

å‚è€ƒä¸Šé¢ Phase 2 è¯¦ç»†è®¡åˆ’ã€‚

---

## èµ„æºå’Œå‚è€ƒ

### å­¦ä¹ èµ„æº

- [LangChain æ–‡æ¡£](https://python.langchain.com/)
- [LangGraph æ–‡æ¡£](https://langchain-ai.github.io/langgraph/)
- [LangSmith æ–‡æ¡£](https://docs.smith.langchain.com/)
- [RAG æœ€ä½³å®è·µ](https://github.com/langchain-ai/langchain/discussions)

### å·¥å…·å’Œåº“

- **LLM**: OpenAI, Anthropic, Ollama
- **Embeddings**: OpenAI, HuggingFace, sentence-transformers
- **Vector DB**: FAISS, Weaviate, Qdrant, Pinecone
- **Observability**: LangSmith, Prometheus, Grafana
- **Evaluation**: RAGAS, LangSmith Evaluation

### ç¤¾åŒº

- [LangChain Discord](https://discord.gg/langchain)
- [LangChain GitHub](https://github.com/langchain-ai/langchain)
- [r/LangChain](https://reddit.com/r/LangChain)

---

## æ€»ç»“

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ã€å¯æ‰§è¡Œçš„è·¯çº¿å›¾ï¼Œä»åŸºç¡€è®¾æ–½åˆ°ç”Ÿäº§çº§ RAG ç³»ç»Ÿã€‚

### å…³é”®æˆåŠŸå› ç´ 

1. â­ **æ¸è¿›å¼å®æ–½** - æ¯ä¸ª Phase éƒ½å¯ç‹¬ç«‹äº¤ä»˜
2. â­ **è´¨é‡ä¼˜å…ˆ** - æ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„éªŒæ”¶æ ‡å‡†
3. â­ **æ•°æ®é©±åŠ¨** - é€šè¿‡æŒ‡æ ‡è¯„ä¼°å’Œä¼˜åŒ–
4. â­ **æŒç»­æ”¹è¿›** - æ ¹æ®åé¦ˆå¿«é€Ÿè¿­ä»£

### æ—¶é—´çº¿æ€»ç»“

- **MVP (4 å‘¨)**: æ ¸å¿ƒåŠŸèƒ½ + åŸºç¡€å¯è§‚æµ‹æ€§
- **å®Œæ•´ç‰ˆ (8-9 å‘¨)**: ç”Ÿäº§çº§ RAG ç³»ç»Ÿ
- **é«˜çº§ç‰ˆ (10+ å‘¨)**: åŒ…å« Agentic RAG ç­‰é«˜çº§ç‰¹æ€§

### æœ€åçš„å»ºè®®

**ä¸è¦è¯•å›¾ä¸€æ¬¡åšå®Œæ‰€æœ‰äº‹æƒ…ï¼**

ä» MVP å¼€å§‹ï¼Œå¿«é€ŸéªŒè¯ï¼Œæ ¹æ®å®é™…éœ€æ±‚é€æ­¥å¢å¼ºã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-10-21  
**ç»´æŠ¤è€…**: Research Agent Team

**ä¸‹ä¸€æ­¥**: å¼€å§‹ Phase 1ï¼Œåˆ›å»º `.env` æ–‡ä»¶å¹¶é›†æˆçœŸå®çš„ LLMï¼ ğŸš€

